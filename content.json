{"posts":[{"title":"Compose æ˜¯å¦‚ä½•å°†æ•°æ®è½¬æ¢æˆ UI çš„ï¼Ÿ","text":"Compose æ˜¯ä¸€ä¸ªå£°æ˜å¼çš„ UI æ¡†æ¶ï¼Œæä¾›äº†å¾ˆå¤šå¼€ç®±å³ç”¨çš„ç»„ä»¶ï¼Œæ¯”å¦‚ Text()ã€Buttonã€Image() ç­‰ç­‰ï¼ŒCompose ä¼šç»è¿‡å‡ ä¸ªä¸åŒçš„é˜¶æ®µï¼Œæœ€ç»ˆæ¸²æŸ“å‡º UI ç•Œé¢ã€‚ æ­¤è½¬æ¢è¿‡ç¨‹åˆ†ä¸ºã€ä¸‰ä¸ªé˜¶æ®µã€‘ï¼š ç»„åˆï¼š æ˜¾ç¤ºä»€ä¹ˆ å¸ƒå±€ï¼š æ”¾åœ¨å“ªé‡Œ ç»˜åˆ¶ï¼š å¦‚ä½•æ¸²æŸ“ è¿™ä¸‰ä¸ªé˜¶æ®µæ˜¯é€ä¸€æ‰§è¡Œçš„ï¼Œæµç¨‹å¦‚ä¸‹ï¼š # ç»„åˆé˜¶æ®µåœ¨ç»„åˆé˜¶æ®µï¼ŒCompose è¿è¡Œæ—¶ä¼šæ‰§è¡Œä»£ç ä¸­å®šä¹‰çš„å¯ç»„åˆå‡½æ•°ï¼Œæœ€ç»ˆä¼šç”Ÿæˆä¸€æ£µè§†å›¾æ ‘ã€‚è¿™ä¸ªè§†å›¾æ ‘ç”±ä¸€ä¸ªä¸ªå¸ƒå±€èŠ‚ç‚¹ï¼šLayoutNode ç»„æˆã€‚æ¯”å¦‚ Text()ã€Button() éƒ½å¯¹åº”ä¸€ä¸ª LayoutNodeï¼Œè¿™äº› LayoutNode æŒæœ‰ç»„ä»¶çš„æ‰€æœ‰ä¿¡æ¯ã€‚ æ›´å½¢è±¡ä¸€ç‚¹çš„ç»“æ„å¦‚ä¸‹ï¼š è¿™æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„ç¤ºä¾‹ï¼Œä½†æœ‰æ—¶å€™æˆ‘ä»¬å®šä¹‰çš„å¯ç»„åˆé¡¹åŒ…å«é€»è¾‘å’Œæ§åˆ¶æµï¼Œè€Œ Compose ä¼šåœ¨ä¸åŒçŠ¶æ€çš„æƒ…å†µä¸‹ç”Ÿæˆä¸åŒçš„æ ‘ã€‚ # å¸ƒå±€é˜¶æ®µå¸ƒå±€é˜¶æ®µï¼Œå¯¹äºè§†å›¾æ ‘ä¸­çš„æ¯ä¸ª LayoutNode èŠ‚ç‚¹è¿›è¡Œå®½é«˜å°ºå¯¸æµ‹é‡å¹¶å®Œæˆä½ç½®æ‘†æ”¾ï¼Œå¸ƒå±€å…ƒç´ éƒ½ä¼šæ ¹æ® 2D åæ ‡æ¥æµ‹é‡å¹¶æ”¾ç½®è‡ªå·±åŠå…¶æ‰€æœ‰å­å…ƒç´ ã€‚ å…¶å® Compose çš„å¸ƒå±€é˜¶æ®µå’Œä¼ ç»Ÿçš„ View ç³»ç»Ÿå¾ˆåƒï¼ˆæµ‹é‡ã€å¸ƒå±€ã€ç»˜åˆ¶ï¼‰ï¼Œå”¯ç‹¬å¤šäº†ä¸€ä¸ªã€Œ ç»„åˆé˜¶æ®µ ã€ï¼Œè€Œ Compose æŠŠ æµ‹é‡å’Œå¸ƒå±€ ç»Ÿä¸€æ”¾å…¥äº†ã€Œ å¸ƒå±€é˜¶æ®µ ã€ã€‚ åœ¨å¸ƒå±€é˜¶æ®µï¼Œä½¿ç”¨ä»¥ä¸‹ 3 æ­¥ç®—æ³•éå† LayoutNode æ ‘ï¼š æµ‹é‡å­èŠ‚ç‚¹ï¼š æ¯ä¸€ä¸ªèŠ‚ç‚¹ä¼šæµ‹é‡å®ƒçš„å­èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰çš„è¯ã€‚ å†³å®šè‡ªå·±çš„å¤§å°ï¼š åŸºäºè¿™äº›æµ‹é‡ï¼ŒèŠ‚ç‚¹å†³å®šè‡ªå·±çš„å¤§å°ã€‚ æ”¾ç½®å­èŠ‚ç‚¹ï¼š æ¯ä¸ªå­èŠ‚ç‚¹éƒ½ç›¸å¯¹äºèŠ‚ç‚¹è‡ªèº«çš„ä½ç½®è¿›è¡Œæ”¾ç½®ã€‚ å¸ƒå±€é˜¶æ®µç»“æŸåï¼Œæ¯ä¸ª LayoutNode éƒ½å°†åˆ†é…ä¸€ä¸ª å®½åº¦ å’Œ é«˜åº¦ï¼Œä»¥åŠä¸€ä¸ªåº”è¯¥ç»˜åˆ¶çš„ xã€y åæ ‡ã€‚ æ¯”å¦‚ï¼šæˆ‘ä»¬ç°åœ¨åˆ†æä¸‹é¢è¿™ä¸ªç®€å•ç¤ºä¾‹çš„å¸ƒå±€æµç¨‹ã€‚ å¸ƒå±€æµç¨‹ï¼š çœ‹åˆ°è¿™ï¼Œæ˜¯ä¸æ˜¯å‘ç°ä¸ªå¾ˆç‰›é€¼çš„äº‹ï¼Ÿ **æˆ‘ä»¬åªè®¿é—®äº†æ¯ä¸ªèŠ‚ç‚¹ä¸€æ¬¡ã€‚é€šè¿‡è§†å›¾æ ‘çš„ä¸€æ¬¡éå†ï¼Œæˆ‘ä»¬å°±å¯ä»¥æµ‹é‡å’Œæ”¾ç½®æ‰€æœ‰èŠ‚ç‚¹**ã€‚ è¿™å¯¹æ€§èƒ½æ¥è¯´å°±å¾ˆé‡è¦äº†ï¼å½“æ ‘ä¸­èŠ‚ç‚¹çš„æ•°é‡å¢åŠ æ—¶ï¼Œéå†å®ƒæ‰€èŠ±è´¹çš„æ—¶é—´åªä¼šä»¥çº¿æ€§æ–¹å¼å¢åŠ ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œå¦‚æœæˆ‘ä»¬å¤šæ¬¡è®¿é—®æ¯ä¸ªèŠ‚ç‚¹ï¼Œéå†æ—¶é—´åˆ™ä¼šä»¥å‘ˆæŒ‡æ•°çº§å¢åŠ ã€‚ # ç»˜åˆ¶é˜¶æ®µç»˜åˆ¶é˜¶æ®µï¼Œæ ‘ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åœ¨å±å¹•ä¸Šç»˜åˆ¶å…¶åƒç´ ã€‚ ä¸Šé¢æˆ‘ä»¬è¯´è¿‡ï¼Œåœ¨å¸ƒå±€é˜¶æ®µç»“æŸåï¼Œæ‰€æœ‰å¸ƒå±€èŠ‚ç‚¹ä¼šå¾—åˆ°å®ƒä»¬çš„ å®½åº¦ å’Œ é«˜åº¦ï¼Œä»¥åŠ xã€y åæ ‡ã€‚æ‰€ä»¥ç°åœ¨å°±å¯ä»¥è¿›å…¥ç»˜åˆ¶é˜¶æ®µäº†ã€‚ ç»˜åˆ¶é˜¶æ®µä¼šä»ä¸Šåˆ°ä¸‹å†æ¬¡éå†æ ‘ï¼Œæ¯ä¸ªèŠ‚ç‚¹ä¾æ¬¡åœ¨å±å¹•ä¸Šç»˜åˆ¶è‡ªå·±ã€‚ é¦–å…ˆ Row å°†ç»˜åˆ¶å®ƒå¯èƒ½å…·æœ‰çš„ä»»ä½•å†…å®¹ï¼Œä¾‹å¦‚èƒŒæ™¯è‰²ã€‚ç„¶å Image å°†ç»˜åˆ¶è‡ªå·±ï¼Œç„¶åæ˜¯ Columnï¼Œç„¶åæ˜¯ç¬¬ä¸€ä¸ªå’Œç¬¬äºŒä¸ª Textã€‚ # Modifier ä¿®é¥°ç¬¦ä¸Šé¢æˆ‘ä»¬ç»™çš„ç®€å•ä»£ç ç¤ºä¾‹éƒ½åªæ˜¯ç”¨äº†ä¸€äº› Compose æä¾›ç»™æˆ‘ä»¬çš„ç°åœºçš„ç»„ä»¶ï¼Œå®é™…å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªå¤§ç¥çº§åˆ«ä¸€æ ·çš„ä¿®é¥°ç¬¦éšå¤„å¯è§ï¼Œå®ƒå°±æ˜¯ï¼šModifier ä¿®é¥°ç¬¦ã€‚ æ¯”å¦‚ï¼šModifier.padding æ˜¯ç”¨æ¥ç»™ç»„ä»¶è®¾ç½®è¾¹è·çš„ï¼Œå®ƒæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª LayoutModifierï¼Œè€Œ LayoutModifier ä¼šå½±å“ç»„ä»¶çš„æµ‹é‡å’Œå¸ƒå±€æ•ˆæœï¼Œä¼šå½±å“åˆ°ç»„åˆé¡¹çš„æ•´ä½“ UI æ•ˆæœã€‚å…·ä½“å¦‚ä½•å½±å“ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘ä»¬ä¸è®²å®ƒçš„æ·±å±‚æ¬¡åŸç†ï¼Œè€Œåªæ˜¯æ¢è®¨æ€ç»´æ¨¡å‹ã€‚ æ‰€ä»¥ï¼Œå¦‚æœä½ æƒ³äº†è§£ LayoutModifier çš„åŸç†ï¼Œå¯ä»¥é˜…è¯» ã€ èŠèŠ Jetpack Compose åŸç† â€“ LayoutModifier å’Œ Modifier.layout ã€‘ è¿™ç¯‡æ–‡ç« ã€‚ å›åˆ°æ­£é¢˜ï¼Œå¦‚æœæˆ‘ä»¬åŠ äº† Modifier ä¿®é¥°ç¬¦ï¼Œé‚£ä¹ˆåœ¨æœ€ç»ˆç”Ÿæˆçš„è§†å›¾æ ‘ä¸­ï¼Œå¯ä»¥å°† Modifier ä¿®é¥°ç¬¦å¯è§†åŒ–ä¸ºå¸ƒå±€èŠ‚ç‚¹çš„åŒ…è£…èŠ‚ç‚¹ï¼š å½“æˆ‘ä»¬é“¾æ¥å¤šä¸ªä¿®é¥°ç¬¦æ—¶ï¼Œæ¯ä¸ªä¿®é¥°ç¬¦èŠ‚ç‚¹åŒ…è£¹é“¾çš„å…¶ä½™éƒ¨åˆ†å’Œå…¶ä¸­çš„å¸ƒå±€èŠ‚ç‚¹ã€‚ ä¾‹å¦‚ï¼Œå½“æˆ‘ä»¬é“¾æ¥ä¸€ä¸ª clip å’Œä¸€ä¸ª size ä¿®é¥°ç¬¦æ—¶ï¼Œclip ä¿®é¥°ç¬¦èŠ‚ç‚¹åŒ…è£¹ size ä¿®é¥°ç¬¦èŠ‚ç‚¹ï¼Œç„¶ååŒ…è£¹ Image å¸ƒå±€èŠ‚ç‚¹ã€‚ è¿™é‡Œä½ å¯èƒ½æœ‰ç–‘é—®ï¼Œä¸ºä»€ä¹ˆä¸æ˜¯å…ˆ clip ç„¶å sizeï¼Œè€Œæ˜¯å…ˆ size ç„¶ååœ¨ clipï¼Ÿçœ‹å®Œ ã€ èŠèŠ Jetpack Compose åŸç† â€“ LayoutModifier å’Œ Modifier.layout ã€‘ è¿™ç¯‡æ–‡ç« ä½ å°±æ‡‚äº†ã€‚ æ¥ç€è¯´ï¼Œåœ¨å¸ƒå±€é˜¶æ®µï¼Œæˆ‘ä»¬ç”¨æ¥éå†æ ‘çš„ç®—æ³•ä¿æŒä¸å˜ï¼Œä½† æ¯ä¸ªä¿®é¥°ç¬¦èŠ‚ç‚¹ä¹Ÿä¼šè¢«è®¿é—®ã€‚è¿™æ ·ï¼Œä¿®é¥°ç¬¦å¯ä»¥æ›´æ”¹å…¶åŒ…è£¹çš„ ä¿®é¥°ç¬¦ æˆ– å¸ƒå±€èŠ‚ç‚¹ çš„ å¤§å°è¦æ±‚ å’Œ ä½ç½®ã€‚ å¦‚æœæˆ‘ä»¬çœ‹ä¸€ä¸‹ Image å¯ç»„åˆé¡¹çš„å®ç°ï¼ˆåº•å±‚æ›´ç»†çš„å®ç°ï¼‰ï¼Œå®é™…ä¸Šå¯ä»¥çœ‹åˆ°å®ƒæœ¬èº«ç”±åŒ…è£¹å•ä¸ªå¸ƒå±€èŠ‚ç‚¹çš„ä¿®é¥°ç¬¦é“¾ç»„æˆã€‚ç±»ä¼¼åœ°ï¼ŒText å¯ç»„åˆé¡¹ä¹Ÿæ˜¯é€šè¿‡åŒ…å«å¸ƒå±€èŠ‚ç‚¹çš„ä¿®é¥°ç¬¦é“¾å®ç°çš„ã€‚æœ€åï¼ŒRow å’Œ Column çš„å®ç°åªæ˜¯æè¿°å¦‚ä½•å¸ƒç½®å…¶å­èŠ‚ç‚¹çš„å¸ƒå±€èŠ‚ç‚¹ï¼š çœ‹ä¸æ‡‚è¿™å¼ å›¾ï¼Ÿæ²¡äº‹ï¼Œè¿™äº›ç»†èŠ‚åŸç†éƒ½ä¼šæœ‰æ–‡ç« è¾“å‡ºï¼Œæ¯”å¦‚æˆ‘åˆšåˆšæåˆ°äº†ä¸¤æ¬¡çš„åŸç†æ–‡ç« ã€‚","link":"/2024/07/01/Compose%20--%20%E5%8E%9F%E7%90%86%20--%20Compose%20%E6%98%AF%E5%A6%82%E4%BD%95%E5%B0%86%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2%E6%88%90%20UI%20%E7%9A%84%EF%BC%9F/"},{"title":"mutableStateListOf","text":"Jekpack Compose â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ ç³»åˆ—ï¼š &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - MutableState/mutableStateOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - remember å’Œé‡ç»„ä½œç”¨åŸŸ ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - æœ‰çŠ¶æ€ã€æ— çŠ¶æ€ã€çŠ¶æ€æå‡ï¼Ÿã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - mutableStateListOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - ä½ çœŸçš„äº†è§£é‡ç»„å—ï¼Ÿã€‘ è®²ä»»ä½•ä¸€ä¸ªæ–°çš„ä¸»é¢˜æˆ–è€…çŸ¥è¯†ç‚¹ï¼Œä¹ æƒ¯æ€§çš„ä» Demo å¼€å§‹ï¼Œæ¯”å¦‚ï¼š 1234567891011class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { Text(name) } }} è¿™æ®µä»£ç å·²ç»ç†Ÿçš„ä¸èƒ½å†ç†Ÿäº†ï¼Œå¦‚æœæˆ‘ä»¬ç”¨ by mutableStateOf åˆå§‹åŒ–ä¸€ä¸ªå˜é‡ï¼Œé‚£ name å°±ä¼šå˜æˆä¸€ä¸ªè¢« Compose è‡ªåŠ¨è®¢é˜…çš„å˜é‡ã€‚ æˆ‘ä»¬å‰é¢æ‰€æœ‰çš„ä¾‹å­ï¼Œéƒ½æ˜¯ç”¨ by mutableStateOf åŒ…äº†ä¸€ä¸ª Stringï¼Œå¦‚æœæ¢æˆåˆ«çš„ç±»å‹ï¼Œè¡Œä¸è¡Œï¼Ÿè‚¯å®šå¯ä»¥ï¼Œä¸ç”¨æƒ³ã€‚ 1234fun &lt;T&gt; mutableStateOf( value: T, // æ³›å‹å‚æ•° policy: SnapshotMutationPolicy&lt;T&gt; = structuralEqualityPolicy()): MutableState&lt;T&gt; = createSnapshotMutableState(value, policy) æ¯”å¦‚ Int ç±»å‹ï¼š 12345678910111213141516class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var num by mutableStateOf(1) setContent { Text( text = &quot;å½“å‰æ•°å€¼ï¼š$num&quot;, Modifier.clickable { num++ } ) } }} ä»£ç ä¸åšè§£é‡Šäº†ï¼Œç›´æ¥çœ‹æ•ˆæœï¼š æ¯”å¦‚ï¼šList ç±»å‹ 123// num ç±»å‹ï¼šMutableList&lt;Int&gt;// mutableStateOf ç±»å‹ï¼šMutableState&lt;MutableList&lt;Int&gt;&gt;var nums by mutableStateOf(mutableListOf(1, 2, 3)) æˆ‘ä»¬åœ¨ä»£ç é‡Œé¢ç”¨èµ·æ¥ï¼š 123456789101112131415class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var nums by mutableStateOf(mutableListOf(1, 2, 3)) setContent { Column { for (num in nums) { Text(&quot;ç¬¬ $num å—æ–‡å­—&quot;) } } } }} è¿è¡Œï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/0713f5cb717b322775fb08a8d3da410e.png =500x) ç°åœ¨æˆ‘ä»¬ç¨å¾®æ”¹ä¸‹ä»£ç ï¼š 1234567891011121314151617181920class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var nums by mutableStateOf(mutableListOf(1, 2, 3)) setContent { Column { Button(onClick = { nums.add(nums.last() + 1) }) { Text(&quot;List åŠ  1&quot;) } for (num in nums) { Text(&quot;ç¬¬ $num å—æ–‡å­—&quot;) } } } }} ä»£ç å¾ˆç®€å•ï¼šæˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª Buttonï¼Œæ¯æ¬¡ç‚¹å‡»åï¼Œnums ä¼šæ·»åŠ ä¸€ä¸ªå€¼ï¼Œæ¯”æœ€æœ‰ä¸€ä¸ªå€¼å¤§ 1ã€‚ è¿è¡Œï¼š ï¼Ÿï¼Ÿï¼Ÿæ²¡ç”Ÿæ•ˆå•Šï¼ä¸ºä»€ä¹ˆï¼Ÿ æˆ‘ä»¬å…ˆæ¥è€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼ŒmutableStateOf åŸç†æ˜¯ä»€ä¹ˆï¼Ÿå‰é¢çš„é—®é¢˜æˆ‘ä»¬è¯´è¿‡ï¼Œå¯ä»¥å›å¿†ä¸€ä¸‹ï¼š mutableStateOf ä¹‹æ‰€ä»¥å¯ä»¥å¯¹å˜é‡è¿›è¡Œè®¢é˜…å’Œåˆ·æ–°ï¼Œä¸»è¦æ˜¯å› ä¸ºå†…éƒ¨çš„ get() å’Œ set() æ–¹æ³•åŠ äº†é’©å­ï¼Œæˆ–è€…è¯´å®ƒçš„ set() æ–¹æ³•æ˜¯èµ‹å€¼ï¼æ˜¯æ”¹å˜äº†å˜é‡çš„æŒ‡å‘ï¼Œå®ƒæ˜¯ç›´æ¥æŠŠå¯¹è±¡å¯æ›¿æ¢äº†ï¼Œä½†åœ¨æˆ‘ä»¬è¿™ä¸ªä»£ç é‡Œé¢ nums ä»…ä»…æ˜¯æ”¹å˜äº†å®ƒå†…éƒ¨çš„çŠ¶æ€ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/19308a90fec705d39e101e5c1cca0ca4.png =700x) å¯¹è¿™å—å¦‚æœæœ‰ç‚¹æ‡µï¼Œå¯ä»¥çœ‹ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - MutableState/mutableStateOf ã€‘ è¿™ç¯‡æ–‡ç« ã€‚ æ‰€ä»¥ï¼Œå®ƒä¸ä¼šå‡ºå‘ setValue() çš„è°ƒç”¨ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºå‘è‡ªåŠ¨åˆ·æ–°çš„æ“ä½œã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/59408ca695a96074444fc4cdf201e0be.png =700x) ä¸ºäº†éªŒè¯æ˜¯ä¸æ˜¯å› ä¸ºæ²¡æœ‰é‡ç»„ï¼Œæˆ‘ä»¬å¯ä»¥éªŒè¯ä¸‹ï¼š 12345678910111213141516171819202122class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var nums by mutableStateOf(mutableListOf(1, 2, 3)) var refresh by mutableStateOf(&quot;å¼ºåˆ¶åˆ·æ–°&quot;) setContent { Column { Text(refresh, Modifier.clickable { refresh = &quot;åˆ·æ–°å®Œæˆ&quot;}) Button(onClick = { nums.add(nums.last() + 1) }) { Text(&quot;List åŠ  1&quot;) } for (num in nums) { Text(&quot;ç¬¬ $num å—æ–‡å­—&quot;) } } } }} æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ª Text() ç»„ä»¶ï¼Œæ”¹å˜ refresh çš„å€¼ï¼Œé‚£ä¹ˆç†è®ºä¸Šå®ƒå°±ä¼šå¸¦ç€æ•´ä¸ªé‡ç»„ä½œç”¨åŸŸå†…çš„ç»„ä»¶å…¨éƒ¨åˆ·æ–°ï¼ŒåŒ…æ‹¬ Listã€‚ è¿è¡Œï¼š æˆåŠŸåˆ·æ–° Listï¼ ç°åœ¨æˆ‘ä»¬å°±å¾ˆæ¸…æ¥šäº†ï¼ŒmutableStateOf æ²¡æ³•å¯¹ List ç±»å‹çš„å¯¹è±¡æ²¡æ³•å®ç°ç±»ä¼¼ Stringã€Int çš„è‡ªåŠ¨è®¢é˜…åŠåˆ·æ–°ï¼Œé‚£æœ‰æ²¡æœ‰è§£å†³åŠæ³•ï¼Ÿ ä¸Šé¢æˆ‘ä»¬è¯´è¿‡äº†ï¼Œé—®é¢˜çš„æ ¹æœ¬åŸå› æ˜¯ List åªæ˜¯å†…éƒ¨çš„å˜åŒ–ï¼Œè€Œä¸æ˜¯å®ƒè‡ªå·±æœ¬èº«å¯¹è±¡çš„å˜åŒ–ï¼Œé‚£æˆ‘ä»¬ç›´æ¥åœ¨å†…éƒ¨æ“ä½œå®Œåç›´æ¥æŠŠ List é‡æ–°ç»™æ¢äº†ä¸å°±è¡Œäº†ï¼Œè¯•è¯•ï¼š 1234567891011121314151617181920212223class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var nums by mutableStateOf(mutableListOf(1, 2, 3)) setContent { Column { Button(onClick = { // nums é‡æ–°èµ‹å€¼ nums = nums.toMutableList().apply { add(nums.last() + 1) } }) { Text(&quot;List åŠ  1&quot;) } for (num in nums) { Text(&quot;ç¬¬ $num å—æ–‡å­—&quot;) } } } }} è¿è¡Œï¼š ä½†è¿™æ ·å†™å°±ä¼šæ˜¾å¾—å¾ˆå¥‡æ€ªï¼Œæˆ‘æ˜¯æ˜ç™½åŸç†äº†ï¼Œæˆ‘è¿™æ ·ä¹Ÿæ˜¯å¯ä»¥å®ç°æ­£å¸¸çš„åˆ·æ–°ï¼Œä½†ä¸å¤ªå¯¹åŠ²ï¼šæ—¢ç„¶å¯¹äº Stringã€Int è¿™äº›ç±»å‹ï¼ŒCompose æä¾›äº† mutableStateOfï¼Œéš¾é“å¯¹äº List è¿™ç§è¿™ä¹ˆå¸¸ç”¨çš„ç±»å‹ï¼Œå°±æ²¡æœ‰ä¸€ä¸ª mutable*** çš„å‡½æ•°ç»™æˆ‘ä»¬ç”¨ï¼Ÿ æœ‰ï¼Œå®ƒå°±æ˜¯ mutableStateListOfï¼å®ƒå¯ä»¥è§‚æµ‹åˆ°å†…éƒ¨ List çš„æ•°æ®å˜åŒ–ï¼ æˆ‘ä»¬å¯ä»¥åƒä¸‹é¢è¿™æ ·ç”³æ˜ï¼š 12345678910var nums by mutableStateListOf(mutableListOf(1, 2, 3)) // æœ‰çº¢çº¿æ ‡æ³¨ï¼Œå†™æ³•é”™è¯¯// mutableStateListOf æ˜¯å†…éƒ¨å…ƒç´ è¢«è§‚æµ‹ï¼Œè€Œä¸æ˜¯å®ƒæœ¬èº«è¢«è§‚æµ‹ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æŠŠ `by` æ¢æˆ `=`var nums = mutableStateListOf(mutableListOf(1, 2, 3))// `var` ä¹Ÿå¯ä»¥æ¢æˆ `val`val nums = mutableStateListOf(mutableListOf(1, 2, 3))// mutableStateListOf æœ¬èº«å°±ä»£è¡¨ä¸€ä¸ªå¯è§‚æµ‹çš„ Listï¼Œæ‰€ä»¥ mutableListOf ä¹Ÿå¯ä»¥å»é™¤val nums = mutableStateListOf(1, 2, 3) // è¿™å°±æ˜¯æœ€ç»ˆçš„å†™æ³• è¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ä¼˜åŒ–ä¸‹ä»£ç äº†ï¼š 1234567891011121314151617181920class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) val nums = mutableStateListOf(1, 2, 3) setContent { Column { Button(onClick = { nums.add(nums.last() + 1) }) { Text(&quot;List åŠ  1&quot;) } for (num in nums) { Text(&quot;ç¬¬ $num å—æ–‡å­—&quot;) } } } }} è¿è¡Œï¼š æåˆ° Listï¼Œæˆ‘ä»¬å°±ä¼šæƒ³åˆ° Mapï¼ŒåŒæ · Map ä¹Ÿæä¾›äº†ä¸€ä¸ª mutableStateMapOfï¼å®ƒä¹Ÿå¯ä»¥è§‚æµ‹åˆ°å†…éƒ¨ Map çš„æ•°æ®å˜åŒ–ï¼ 12345678910111213141516171819class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) val maps = mutableStateMapOf(1 to &quot;One&quot;, 2 to &quot;Two&quot;) setContent { Column { Button(onClick = { maps[3] = &quot;Three&quot; }) { Text(&quot;Maps åŠ  1&quot;) } for ((key, value) in maps) { Text(&quot;$key å¯¹åº” value: $value&quot;) } } } }} è¿è¡Œï¼š","link":"/2024/07/18/Compose%20--%20%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85%20&%20%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0%20--%20mutableStateListOf/"},{"title":"ç»†è¯´ remember å’Œé‡ç»„ä½œç”¨åŸŸ","text":"Jekpack Compose â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ ç³»åˆ—ï¼š &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - MutableState/mutableStateOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - remember å’Œé‡ç»„ä½œç”¨åŸŸ ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - æœ‰çŠ¶æ€ã€æ— çŠ¶æ€ã€çŠ¶æ€æå‡ï¼Ÿã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - mutableStateListOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - ä½ çœŸçš„äº†è§£é‡ç»„å—ï¼Ÿã€‘ åœ¨è®²æœ¬ç¯‡æ–‡ç« ä¸»é¢˜ä¹‹å‰ï¼Œå»ºè®®å…ˆçœ‹çœ‹ èŠèŠ Jetpack Compose åŸç† â€“ çŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°æœºåˆ¶ ä¸€æ–‡ï¼Œå› ä¸ºä¸¤ç¯‡æ–‡ç« æ˜¯ä¸Šä¸‹ç¯‡çš„å…³ç³»ï¼Œçœ‹å®Œä¸Šç¯‡ï¼Œå¯ä»¥æ›´å¥½çš„ä¸²è”çŸ¥è¯†ç‚¹ã€‚ è¯ä¸å¤šè¯´ï¼Œè¿˜æ˜¯è€æ ·å­ï¼Œä» Demo ä¸€æ­¥æ­¥å¼•å‡ºæˆ‘ä»¬çš„æ ¸å¿ƒçŸ¥è¯†ç‚¹ã€‚ ä¸€ã€è¯é¢˜å¼•å…¥12345678910111213141516class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Compose&quot;) setContent { Text(name) LaunchedEffect(true) { delay(3000) name = &quot;Kotlin&quot; } } }} ä¸€æ®µå¾ˆç®€å•çš„ä»£ç ç¤ºä¾‹ï¼Œå°±æ˜¯å‰ä¸€ç¯‡æ–‡ç« çš„å¼€å¤´ç¤ºä¾‹ï¼Œæˆ‘ä»¬çœ‹ä¸‹æ•ˆæœï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/141782121dd4b200a5d4e86a30eb3edf.gif =400x) å¾ˆç®€å•ï¼Œ3s åä» Compose å˜ä¸º kotlinã€‚ ç°åœ¨æˆ‘ä»¬æ”¹ä¸‹ä»£ç ï¼š 123456789101112131415class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var name by mutableStateOf(&quot;Compose&quot;) Text(name) LaunchedEffect(true) { delay(3000) name = &quot;Kotlin&quot; } } }} æˆ‘ä»¬æŠŠ var name by mutableStateOf(&quot;Compose&quot;) ä» setContent å¤–é¢æŒªåˆ°é‡Œé¢æ¥äº†ã€‚ æ‰§è¡Œçœ‹ä¸‹æ•ˆæœï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/893bfeec0b8b5729f88d4b614ebe9c47.gif =400x) å¥‡æ€ªäº†ï¼Œæ–‡å­—æ²¡æœ‰åˆ·æ–°ï¼ äºŒã€é‡ç»„ä½œç”¨åŸŸé—®é¢˜å‡ºåœ¨å“ªï¼Ÿé¦–å…ˆæˆ‘ä»¬å›é¡¾ä¸‹ Compose æ˜¯æ€ä¹ˆåˆ·æ–°ç•Œé¢çš„ï¼Ÿæ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œå½“ name é‡æ–°èµ‹å€¼åï¼Œè¯»å–å®ƒçš„åœ°æ–¹ä¼šè¢«æ ‡è®°ä¸ºå¤±æ•ˆï¼Œç„¶åé‡ç»„åˆ·æ–°ã€‚ åœ¨ Compose ä¸­å¹¶ä¸æ˜¯å•çº¯çš„åˆ·æ–° Text(name) è¿™ä¸€è¡Œï¼Œè€Œæ˜¯ä¼šæŠŠåŒ…å« Text(name) çš„ä»£ç å—ç»™åŒ…èµ·æ¥ï¼Œåˆ·æ–°çš„æ˜¯æ•´ä¸ªä»£ç å—ï¼Œæˆ–è€…è¯´é‡ç»„æ•´ä¸ªä»£ç å—ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/26bf6ee50ba5b59a5bfa4162b7fd948b.png =600x) æ‰€ä»¥è¿™æ®µè“è‰²èƒŒæ™¯çš„ä»£ç å—ä¼šè¢«é‡æ–°æ‰§è¡Œä¸€éï¼Œè¿™ä¸ªè“è‰²åŒºåŸŸå°±æ˜¯ï¼šé‡ç»„ä½œç”¨åŸŸï¼ˆRecompose scopeï¼‰ï¼ æ‰€ä»¥é—®é¢˜åŸå› ä½ åº”è¯¥å°±èƒ½æ‰¾åˆ°äº†ï¼š ä¸ä»…ä»… Text(name) ä¼šè¢«é‡æ–°æ‰§è¡Œï¼Œvar name by mutableStateOf(&quot;Compose&quot;) ä¹Ÿä¼šæ‰§è¡Œï¼name åˆè¢«é‡æ–°åˆå§‹åŒ–äº†ã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/09fcc4a6a553b39de5976bb1b35775ac.png =600x) ä¸‰ã€rememberé‚£æ€ä¹ˆè§£å†³ï¼Ÿå…¶å®å¼€å‘å·¥å…·å·²ç»æç¤ºä½ äº†ï¼š mutableStateOf æ˜¯æ ‡çº¢çš„ï¼Œå¹¶ä¸”é”™è¯¯æç¤ºï¼šCreating a state object during composition without using remember. æ„æ€å°±æ˜¯ï¼šä½ åœ¨ç»„åˆè¿‡ç¨‹é‡Œé¢åˆ›å»ºäº† StateObject å¯¹è±¡ï¼Œä½†æ˜¯æ²¡æœ‰ç”¨ rememberã€‚ æ‰€ä»¥æ€ä¹ˆåŒ…ï¼Ÿå¦‚ä¸‹ï¼š 123456789101112131415class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var name by remember { mutableStateOf(&quot;Compose&quot;) } Text(name) LaunchedEffect(true) { delay(3000) name = &quot;Kotlin&quot; } } }} åŠ äº† remember åï¼Œåœ¨ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™ï¼Œä¼šæ‰§è¡Œ Lambda è¡¨è¾¾å¼ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œ mutableStateOf(&quot;Compose&quot;)ï¼Œå¹¶ä¸” remember ä¼šä¿å­˜ç»“æœï¼ˆStateObjectï¼‰ï¼Œå†æ¬¡è°ƒç”¨çš„æ—¶å€™ä¼šç›´æ¥è¿”å›ä¿å­˜çš„è€å¯¹è±¡ï¼ˆStateObjectï¼‰ï¼Œè€Œä¸æ˜¯åœ¨æ‰§è¡Œ Lambda è¡¨è¾¾å¼é‡Œé¢çš„ä»£ç ï¼Œç›¸å½“äºå……å½“äº†ç¼“å­˜çš„åŠŸèƒ½ã€‚ æˆ‘ä»¬æ‰§è¡Œçœ‹ä¸‹ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/618f435bbc747ba2039730589b5f3353.gif =400x) æ‰€ä»¥ remember èµ·åˆ°ç¼“å­˜ä½œç”¨ï¼Œå°±æ˜¯ä¸ºäº†é˜²æ­¢å¤šæ¬¡åˆå§‹åŒ–å˜é‡è€Œå¯¼è‡´ç¨‹åºä¸å¯æ§ï¼Œæ‰€ä»¥åœ¨ Compose é‡Œé¢ä½ åªè¦ mutableStateOfï¼Œé‚£ä¹ˆèƒ½åŠ  remember æˆ‘ä»¬å°±åŠ  rememberã€‚ å¦å¤–æˆ‘ä»¬éœ€è¦æ³¨æ„ remember æ˜¯å¯ä»¥å¸¦å‚æ•°çš„ï¼šå¯ä»¥ä¸€ä¸ªæˆ–è€…å¤šä¸ªå‚æ•°ã€‚ 12345678910111213141516171819@Composableinline fun &lt;T&gt; remember( key1: Any?, calculation: @DisallowComposableCalls () -&gt; T): T { return currentComposer.cache(currentComposer.changed(key1), calculation)}@Composableinline fun &lt;T&gt; remember( key1: Any?, key2: Any?, calculation: @DisallowComposableCalls () -&gt; T): T { return currentComposer.cache( currentComposer.changed(key1) or currentComposer.changed(key2), calculation )} æœ‰ä»€ä¹ˆç”¨ï¼Œæˆ‘ä»¬ä¸¾ä¸ªä¾‹å­è¯´æ˜ï¼Œæ¯”å¦‚æˆ‘ä»¬è‡ªå®šä¹‰äº†ä¸€ä¸ª Composable å‡½æ•°ï¼š 12345@Composablefun showCharCount(value: String) { val length = value.length Text(&quot;å­—ç¬¦ä¸²é•¿åº¦ï¼š$length&quot;)} å¾ˆç®€å•ï¼Œä¸€ä¸ªæ˜¾ç¤ºå­—ç¬¦ä¸²é•¿åº¦çš„å‡½æ•°ã€‚ æˆ‘ä»¬å‡è®¾ä¸€åœºåœºæ™¯ï¼š ä¼ å…¥è¿›æ¥çš„å­—ç¬¦ä¸²ç‰¹åˆ«é•¿ï¼Œ å¹¶ä¸” showCharCount åå¤è¢«è°ƒç”¨äº†å¾ˆå¤šæ¬¡ã€‚ é‚£ä¹ˆ value.length æ¯æ¬¡éƒ½è¢«è°ƒç”¨ï¼Œå°±æ˜¾å¾—æœ‰ç‚¹ç¬¨é‡äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç»™å®ƒåŠ ä¸Šä¸€ä¸ª rememberã€‚ 1234567@Composablefun showCharCount(value: String) { val length = remember { value.length } Text(&quot;å­—ç¬¦ä¸²é•¿åº¦ï¼š$length&quot;)} ä½†æ­¤æ—¶å°±ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼š 12345678910@Composablefun showCharCount(value: String) { // ç¬¬ä¸€æ¬¡ä¼ è¿›æ¥ï¼šabcd // ç¬¬äºŒæ¬¡ä¼ è¿›æ¥ï¼šabcdefg // ç¬¬ä¸‰æ¬¡ä¼ è¿›æ¥ï¼šabcdefghijklmn val length = remember { value.length } Text(&quot;å­—ç¬¦ä¸²é•¿åº¦ï¼š$length&quot;)} å­—ç¬¦ä¸²é•¿åº¦æ°¸è¿œéƒ½æ˜¯ï¼š4ï¼Œå› ä¸º value.length ä¸ä¼šè¢«æ‰§è¡Œï¼Œé‚£æ€ä¹ˆåŠï¼š 12345678910@Composablefun showCharCount(value: String) { // ç¬¬ä¸€æ¬¡ä¼ è¿›æ¥ï¼šabcd // ç¬¬äºŒæ¬¡ä¼ è¿›æ¥ï¼šabcdefg // ç¬¬ä¸‰æ¬¡ä¼ è¿›æ¥ï¼šabcdefghijklmn val length = remember(value) { value.length } Text(&quot;å­—ç¬¦ä¸²é•¿åº¦ï¼š$length&quot;)} æˆ‘ä»¬ç»™ remember åŠ äº†ä¸€ä¸ªå‚æ•°ï¼švalueï¼Œåªè¦è¿™ä¸ª key å˜åŒ–äº†ï¼Œé‚£ä¹ˆå°±ä¼šé‡æ–°æ‰§è¡Œ Lambda è¡¨è¾¾å¼ï¼Œè¿™å°±æ˜¯å¸¦å‚æ•°çš„ remember çš„ç”¨æ³•ã€‚","link":"/2024/07/10/Compose%20--%20%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85%20&%20%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0%20--%20remember%20%E5%92%8C%E9%87%8D%E7%BB%84%E4%BD%9C%E7%94%A8%E5%9F%9F/"},{"title":"çŠ¶æ€è½¬ç§»å‹åŠ¨ç”» APIï¼šanimate*AsState()","text":"Jetpack Compose æä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½å¼ºå¤§ä¸”å¯æ‰©å±•çš„ APIï¼Œå¯ç”¨äºåœ¨åº”ç”¨ç•Œé¢ä¸­è½»æ¾å®ç°å„ç§ã€ŒåŠ¨ç”»æ•ˆæœã€ã€‚è¿™ä¸€ç³»åˆ—æ–‡ç« ä¼šé€ä¸ªä»‹ç»æ‰€æœ‰çš„åŠ¨ç”» APIï¼Œé€šè¿‡æœ€ç›´è§‚çš„ Demo ç¤ºä¾‹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ æ€ä¹ˆå†™åŠ¨ç”»ä»¥åŠå¸¦ä½ äº†è§£åŠ¨ç”»èƒŒåçš„åŸç†ã€‚ çŠ¶æ€è½¬ç§»å‹åŠ¨ç”» APIï¼šanimate*AsStateanimate*AsState å‡½æ•°åº”è¯¥ç®—æ˜¯ Jetpack Compose ä¸­æœ€ç®€å•çš„ä¸€ç»„åŠ¨ç”» API äº†ï¼Œä¸»è¦ç”¨äºå°†æŸä¸ª UI çŠ¶æ€çš„å˜åŒ–å¹³æ»‘è¿‡æ¸¡æˆåŠ¨ç”»ã€‚å®ƒå¯ä»¥å¸®åŠ©å¼€å‘è€…åœ¨çŠ¶æ€åˆ‡æ¢æ—¶ï¼Œé€šè¿‡åŠ¨ç”»ä½¿ç•Œé¢æ›´è‡ªç„¶åœ°è¿‡æ¸¡ã€‚ è¯´çš„ç›´ç™½ä¸€ç‚¹ï¼Œå®ƒä¸»è¦ç”¨äºä¸ºå•ä¸ªå€¼æ·»åŠ åŠ¨ç”»æ•ˆæœã€‚ä½ åªéœ€æä¾›ç»“æŸå€¼ï¼ˆæˆ–ç›®æ ‡å€¼ï¼‰ï¼Œè¯¥ API å°±ä¼šä»å½“å‰å€¼å¼€å§‹å‘æŒ‡å®šå€¼æ’­æ”¾åŠ¨ç”»ã€‚ ä¸€ç›´ä»¥æ¥æˆ‘éƒ½è®¤ä¸ºï¼šæ¢ç´¢æ–°æŠ€æœ¯çš„æœ€ä½³æ–¹å¼å°±æ˜¯å°è¯•å®ƒä»¬ï¼ æ¥ä¸‹æ¥æˆ‘ä»¬å…ˆæ„å»ºä¸€ä¸ªç®€å•åœºæ™¯ï¼š 12345678910111213141516171819202122232425class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { Column{ Image( painter = painterResource(R.drawable.bicycle), contentDescription = null, modifier = Modifier .height(90.dp) .absoluteOffset(x = 0.dp) ) Button(onClick = {}, modifier = Modifier .fillMaxWidth() .wrapContentSize(align = Alignment.Center) ) { Text(text = &quot;Ride&quot;) } } } }} è¿™æ˜¯ä¸€ä¸ªæå…¶ç®€å•çš„åœºæ™¯ï¼šä¸€ä¸ªå›¾ç‰‡ï¼Œä¸€ä¸ª Buttonï¼Œåˆå§‹æ•ˆæœå¦‚ä¸‹ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/45d8e4da5a9a09094d71117684888d61.png =700x) ç°åœ¨æˆ‘ä»¬è®©å°åˆºçŒ¬åŠ¨èµ·æ¥ï¼ˆä»å·¦åˆ°å³ï¼‰ï¼Œä»£ç å¯ä»¥è¿™æ ·å†™ï¼š 12345678910111213141516171819202122232425262728class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var offset by remember { mutableStateOf(0.dp) } // å®šä¹‰åç§»å˜é‡ Column{ Image( painter = painterResource(R.drawable.bicycle), contentDescription = null, modifier = Modifier .height(90.dp) .absoluteOffset(x = offset) // è·å–åç§»å€¼ ) Button( onClick = { offset = 360.dp }, // ä¿®æ”¹åç§»å€¼ modifier = Modifier .fillMaxWidth() .wrapContentSize(align = Alignment.Center) ) { Text(text = &quot;Ride&quot;) } } } }} å¦‚æ³¨é‡Šè¯´æ˜ï¼Œæˆ‘åªä¿®æ”¹äº†ä¸‰ä¸ªåœ°æ–¹ï¼Œç°åœ¨æ¥çœ‹ä¸‹æ•ˆæœï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/a0e68a638637f7dd9087ea12f6c1a9b7.gif =700x) å°åˆºçŒ¬ç¡®å®åŠ¨èµ·æ¥äº†ï¼Œä½†æ˜¯è¿™ç§æ•ˆæœç»™äººçš„æ„Ÿè§‰å°±å¾ˆç”Ÿç¡¬ï¼Œå®Œå…¨ç§°ä¸ä¸Šæ˜¯åŠ¨ç”»ï¼Œè€Œæ˜¯â€œç¬é—´ç§»åŠ¨â€ã€‚ ç°åœ¨æˆ‘ä»¬å¯ä»¥å¼€å§‹å°è¯•ç”¨ animate*AsState æ”¹å–„åŠ¨ç”»æ•ˆæœï¼Œå†™æ³•å¾ˆç®€å•ï¼š 1234567891011121314151617181920212223242526272829class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { // var offset by remember { mutableStateOf(0.dp) } // å®šä¹‰åç§»å˜é‡ var offset by remember { animateDpAsState(0.dp) } // æ›¿æ¢ä¸º animateDpAsState Column{ Image( painter = painterResource(R.drawable.bicycle), contentDescription = null, modifier = Modifier .height(90.dp) .absoluteOffset(x = offset) // è·å–åç§»å€¼ ) Button( onClick = { offset = 360.dp }, // ä¿®æ”¹åç§»å€¼ modifier = Modifier .fillMaxWidth() .wrapContentSize(align = Alignment.Center) ) { Text(text = &quot;Ride&quot;) } } } }} å¦‚ä½ æ‰€è§ï¼Œæˆ‘ä»…ä»…ç”¨ animateDpAsState æ›¿æ¢ mutableStateOf åï¼Œå°±å¯ä»¥å¯¹æ•°å€¼çš„å¤§å°å®ç°æ¸å˜çš„è°ƒæ•´ï¼Œä½†å¾ˆé—æ†¾ï¼Œè¿™æ ·ç›´æ¥æ›¿æ¢æ˜¯æœ‰çº¢çº¿æŠ¥é”™çš„ã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/53d0b370d07fcd300603e816ee068ddc.png =700x) æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·ä¿®å¤è¿™ä¸ªæŠ¥é”™ï¼Œæœ€ç»ˆæ¨å¯¼å‡º animateDpAsState çš„æ­£ç¡®å†™æ³•ã€‚ é¦–å…ˆæˆ‘ä»¬å›é¡¾ä¸‹ remember çš„ä½œç”¨ï¼šå®ƒæ˜¯é˜²æ­¢å˜é‡è¢«å¤šæ¬¡é‡å¤åˆå§‹åŒ–çš„ï¼Œè€Œ animateDpAsState å¤©ç”Ÿè‡ªå¸¦è¿™ä¸ªèƒ½åŠ›ï¼ˆå®ƒçš„æºç å†…éƒ¨æ˜¯åŒ…äº† remember çš„ï¼‰ï¼Œæ‰€ä»¥è¿™é‡Œæˆ‘ä»¬å¯ä»¥å»æ‰ rememberã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/910c2898f6d21b3bcc5c45ee5cc4fe28.png =700x) å†æ¥å›é¡¾ä¸‹ by çš„ä½œç”¨ï¼šæŠŠå·¦è¾¹ offset å˜é‡å§”æ‰˜ç»™å³è¾¹çš„ mutableStateOfï¼ŒmutableStateOf æä¾›äº†è¯»å’Œå†™çš„åŠŸèƒ½ï¼Œä½†æ˜¯æœ‰ä¸€ä¸ªç»†èŠ‚éœ€è¦æ³¨æ„äº†ï¼Œæˆ‘ä»¬å¯¹æ¯”ä¸‹ mutableStateOf å’Œ animateDpAsState å‡½æ•°çš„å®šä¹‰ï¼š 1234fun &lt;T&gt; mutableStateOf( value: T, policy: SnapshotMutationPolicy&lt;T&gt; = structuralEqualityPolicy()): MutableState&lt;T&gt; = createSnapshotMutableState(value, policy) 1234567@Composablefun animateDpAsState( targetValue: Dp, animationSpec: AnimationSpec&lt;Dp&gt; = dpDefaultSpring, label: String = &quot;DpAnimation&quot;, finishedListener: ((Dp) -&gt; Unit)? = null): State&lt;Dp&gt; { â‡’ mutableStateOf è¿”å›çš„æ˜¯ä¸€ä¸ª MutableState å¯¹è±¡ â‡’ animateDpAsState è¿”å›çš„æ˜¯ä¸€ä¸ª State å¯¹è±¡ åœ¨ Compose ä¸­ï¼ŒState å¯¹è±¡åªæä¾›è¯»çš„åŠŸèƒ½ï¼Œä½ æ˜¯æ²¡åŠæ³•å†™çš„ï¼ä½†ä¾‹å­ä¸­ var å°±ä»£è¡¨ offset æ˜¯å¯å†™çš„ï¼Œè¿™å°±å†²çªäº†ã€‚Android Studio çš„æŠ¥é”™æç¤ºå…¶å®å·²ç»è¯´æ˜äº†ï¼š æ‰€ä»¥ç°åœ¨æˆ‘ä»¬æŠŠ var æ”¹æˆ valï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/04cdedd0e7bd089ae58c20c75e151397.png =700x) è¿™é‡Œç‰¹åˆ«è¯´æ˜ä¸€ä¸‹ï¼š â‡’ è“è‰²åœ°æ–¹æœ‰æ³¢æµªçº¿æ˜¯å› ä¸ºéšç€å®˜æ–¹ API çš„æ›´æ–°ï¼Œä¸å¸¦ label å‚æ•°çš„ animateDpAsState å‡½æ•°è¢«å¼ƒç”¨äº†ã€‚ 12345678910@Deprecated( &quot;animate*AsState APIs now have a new label parameter added.&quot;, level = DeprecationLevel.HIDDEN)@Composablefun animateDpAsState( targetValue: Dp, animationSpec: AnimationSpec&lt;Dp&gt; = dpDefaultSpring, finishedListener: ((Dp) -&gt; Unit)? = null) å®˜æ–¹å»ºè®®æˆ‘ä»¬ä½¿ç”¨å¸¦ label å‚æ•°çš„ animateDpAsStateï¼Œæ‰€ä»¥å¦‚æœä½ å°±ä¸æƒ³åŠ ï¼Œä¹Ÿä¸ä¼šå½±å“ç¨‹åºè¿è¡Œï¼ˆè‡³äºä¸ºä»€ä¹ˆå®˜æ–¹è¿™ä¹ˆå¼ºçƒˆå»ºè®®åŠ ä¸Šè¿™ä¸ª label æ ‡ç­¾ï¼Œä¼šåœ¨åˆ«çš„åŠ¨ç”»æ–‡ç« é‡Œé¢è¯´æ˜ï¼‰ã€‚ 1val offset by animateDpAsState(0.dp, label = &quot;&quot;) â‡’ çº¢è‰²åœ°æ–¹æŠ¥é”™çš„åŸå› æ˜¯æ˜¾è€Œæ˜“è§çš„ï¼Œå› ä¸º offset ä¸å¯ä»¥æ‰‹åŠ¨å†™ï¼Œé‚£è¯¥æ€ä¹ˆä¿®æ”¹ offset å€¼ï¼Ÿ ä»¥ä¸‹æ˜¯æ­£ç¡®çš„å†™æ³•ï¼š 123456789101112131415161718192021222324252627282930class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var bicycleStart by mutableStateOf(false) setContent { val offset by animateDpAsState(if (bicycleStart) 360.dp else 0.dp, label = &quot;&quot;) Column{ Image( painter = painterResource(R.drawable.bicycle), contentDescription = null, modifier = Modifier .height(90.dp) .absoluteOffset(x = offset) ) Button( onClick = { bicycleStart = !bicycleStart }, modifier = Modifier .fillMaxWidth() .wrapContentSize(align = Alignment.Center) ) { Text(text = &quot;Ride&quot;) } } } }} æ—¢ç„¶æˆ‘æ²¡æ³•æ‰‹åŠ¨ä¿®æ”¹å€¼ï¼Œè®©å°±é€šè¿‡æ”¹å˜å¦å¤–ä¸€ä¸ª bicycleStart çŠ¶æ€ï¼Œå¼•å‘é‡ç»„ï¼Œä»è€Œæ”¹å˜ animateDpAsState å†…éƒ¨çš„å€¼ã€‚ åˆ°è¿™é‡Œç¨‹åºå°±æ²¡æœ‰ä»»ä½•é”™è¯¯äº†ï¼Œè¿™ä¹Ÿæ˜¯ animateDpAsState çš„æ­£ç¡®å†™æ³•ï¼ ç°åœ¨ï¼Œè¿è¡Œä¸‹çœ‹çœ‹æ•ˆæœï¼šï¼ˆå¯¹æ¯” mutableStateOf å’Œ animateDpAsStateï¼‰ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/d08ad4fdef56b06e444395886ba987f0.gif =700x) æ•ˆæœæ˜¯å¾ˆæ˜æ˜¾çš„ï¼Œèµ·ç æˆ‘ä»¬èƒ½å¤Ÿçœ‹å‡ºæ¥è½¦æ˜¯å¼€èµ·æ¥äº†ï¼Œè€Œä¸æ˜¯ç¬é—´ç§»åŠ¨ã€‚ è¯´æ˜é™¤äº† Dpï¼ŒCompose ä¸º Floatã€Colorã€Sizeã€Offsetã€Rectã€Intã€IntOffset å’Œ IntSize éƒ½æä¾›äº†å¼€ç®±å³ç”¨çš„ animate*AsState å‡½æ•°ï¼Œç”¨æ³•å·®ä¸å¤šï¼Œä¸å†è¿‡å¤šä¸¾ä¾‹äº†ã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/6861ad0c94dc772b03ac7200db683940.png =700x) è‡³æ­¤ï¼ŒAnimate*AsState() çš„åŸºæœ¬ç”¨æ³•äº†è§£å®Œäº†ï¼Œå°±è¿™ä¹ˆç®€å•ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜å¾—ç»†çœ‹ä¸‹è¿™ä¸ªå‡½æ•°çš„å®šä¹‰ï¼š 1234567@Composablefun animateDpAsState( targetValue: Dp, animationSpec: AnimationSpec&lt;Dp&gt; = dpDefaultSpring, label: String = &quot;DpAnimation&quot;, finishedListener: ((Dp) -&gt; Unit)? = null) å®ƒè¿˜æœ‰ä¸€ä¸ªæ ¸å¿ƒå‚æ•°ï¼šanimationSpecï¼Œå®ƒæ˜¯ä¸€ä¸ª AnimationSpec ç±»å‹çš„ï¼Œä½ å¯ä»¥é€šè¿‡å¯é€‰çš„ AnimationSpec å‚æ•°æ¥è‡ªå®šä¹‰åŠ¨ç”»è§„èŒƒï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥å®ç°ä¸åŒç±»å‹çš„åŠ¨ç”»æ•ˆæœï¼‰ã€‚ AnimationSpec çš„å†…å®¹ç€å®ä¸å°‘ï¼Œä½œä¸ºå•ç‹¬çš„çŸ¥è¯†ç‚¹æ”¾åœ¨ ã€ AnimationSpect è¯¦è§£ ã€‘ ä¸€æ–‡ç»†è¯´ã€‚","link":"/2024/07/26/Compose%20--%20%E5%8A%A8%E7%94%BB%20--%20%E7%8A%B6%E6%80%81%E8%BD%AC%E7%A7%BB%E5%9E%8B%E5%8A%A8%E7%94%BB%20API%EF%BC%9Aanimate*AsState()/"},{"title":"æµç¨‹å®šåˆ¶å‹åŠ¨ç”» APIï¼šAnimatable()","text":"Jetpack Compose æä¾›äº†ä¸€ç³»åˆ—åŠŸèƒ½å¼ºå¤§ä¸”å¯æ‰©å±•çš„ APIï¼Œå¯ç”¨äºåœ¨åº”ç”¨ç•Œé¢ä¸­è½»æ¾å®ç°å„ç§åŠ¨ç”»æ•ˆæœã€‚è¿™ä¸€ç³»åˆ—æ–‡ç« ä¼šé€ä¸ªä»‹ç»æ‰€æœ‰çš„åŠ¨ç”» APIï¼Œé€šè¿‡æœ€ç›´è§‚çš„ Demo ç¤ºä¾‹ï¼Œæ‰‹æŠŠæ‰‹æ•™ä½ æ€ä¹ˆå†™åŠ¨ç”»ä»¥åŠå¸¦ä½ äº†è§£åŠ¨ç”»èƒŒåçš„åŸç†ã€‚ ç³»åˆ— æ–‡ç«  æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ çŠ¶æ€è½¬ç§»å‹åŠ¨ç”» APIï¼šanimate*AsState() æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ æµç¨‹å®šåˆ¶å‹åŠ¨ç”» APIï¼šAnimatable() æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ è®²çš„ä¸èƒ½å†ç»†çš„ AnimationSpec åŠ¨ç”»è§„èŒƒ æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ è¿‡æ¸¡åŠ¨ç”» APIï¼šTransition æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ æ˜¾ç¤ºä¸æ¶ˆå¤± APIï¼šAnimatedVisibility æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ ç®€å•é¡µé¢åˆ‡æ¢åŠ¨ç”» APIï¼šCrossfade æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ æ›´å¼ºå¤§çš„å¤šç»„ä»¶åˆ‡æ¢åŠ¨ç”» APIï¼šAnimatedContent æ‰‹æŠŠæ‰‹æ•™ä½ å†™ Compose åŠ¨ç”» ğŸ“‘ ç»„ä»¶å¤§å°å˜åŒ– APIï¼šanimateContentSize åŠ¨ç”»å›¾è¡¨ åœ¨æ¯ä¸€ç¯‡æ–‡ç« å¼€å¤´ï¼Œæˆ‘éƒ½ä¼šæ”¾ä¸€å¼  Compose åŠ¨ç”» API çš„å›¾è¡¨ï¼Œä»¥ä¾¿ä½ æœ‰æœ€ç›´è§‚çš„æ„Ÿå—ã€‚ æµç¨‹å®šåˆ¶å‹åŠ¨ç”» APIï¼šAnimatable() Animatable æ˜¯ä¸€ä¸ªå€¼å®¹å™¨ï¼Œä¼šåœ¨å†…éƒ¨å‚¨å­˜ä¸€ä¸ªå€¼ï¼Œå®ƒå¯ä»¥åœ¨é€šè¿‡ animateTo æ›´æ”¹å€¼æ—¶ä¸ºå€¼æ·»åŠ åŠ¨ç”»æ•ˆæœã€‚è¯¥ API æ”¯æŒ animate*AsState çš„å®ç°ã€‚å®ƒå¯ç¡®ä¿ä¸€è‡´çš„è¿ç»­æ€§å’Œäº’æ–¥æ€§ï¼Œè¿™æ„å‘³ç€å€¼å˜åŒ–å§‹ç»ˆæ˜¯è¿ç»­çš„ï¼Œå¹¶ä¸”ä¼šå–æ¶ˆä»»ä½•æ­£åœ¨æ’­æ”¾çš„åŠ¨ç”»ã€‚ Animatable çš„è®¸å¤šåŠŸèƒ½ï¼ˆåŒ…æ‹¬ animateToï¼‰ä»¥ â€œæŒ‚èµ·å‡½æ•°â€œ çš„å½¢å¼æä¾›ã€‚è¿™æ„å‘³ç€ï¼Œå®ƒä»¬éœ€è¦å°è£…åœ¨é€‚å½“çš„ â€œåç¨‹ä½œç”¨åŸŸâ€œ å†…ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ LaunchedEffect å¯ç»„åˆé¡¹é’ˆå¯¹æŒ‡å®šé”®å€¼çš„æ—¶é•¿åˆ›å»ºä¸€ä¸ªä½œç”¨åŸŸã€‚ æ­£å¦‚æˆ‘ä¹‹å‰ä¸€ç›´æ‰€è¯´ï¼šæ¢ç´¢æ–°æŠ€æœ¯çš„æœ€ä½³æ–¹å¼å°±æ˜¯å°è¯•å®ƒä»¬ï¼Œçœ‹ä¸æ‡‚æ²¡å…³ç³»ï¼Œæˆ‘å¸¦ä½ ä¸€èµ·æ¥ Codingï¼š 123456789class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val anim = Animatable() } }} æ³¨æ„ï¼šAnimatable å¯¼åŒ…çš„æ—¶å€™ä¸è¦é€‰é”™ï¼š æ­¤æ—¶ï¼Œå…‰ç§ƒç§ƒçš„å†™ä¸ª Animatable æ˜¯ä¼šæŠ¥é”™çš„ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/412c5b548363bd00c7f3a6b3ae3fc7a2.png =700x) æç¤ºæˆ‘ä»¬æƒ³è¦ç”¨ Animatableï¼Œé‚£å°±å¾—ç”¨ remember åŒ…èµ·æ¥ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/2442cca31c5b2152dbbf34bc48203886.png =700x) æç¤ºæˆ‘ä»¬éœ€è¦å¡«å†™ â€œåˆå§‹å€¼â€ï¼Œè¿™ä¸ªåˆå§‹å€¼å¡«ä»€ä¹ˆï¼Ÿæˆ‘ä»¬æ¥çœ‹ä¸‹ Animatable çš„å®šä¹‰ï¼š 1234fun Animatable( initialValue: Float, visibilityThreshold: Float = Spring.DefaultDisplacementThreshold) å®ƒéœ€è¦ä¸€ä¸ª Float ç±»å‹çš„åˆå§‹å€¼ï¼š 123456789class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val anim = remember { Animatable(0f) } } }} å½“ç„¶é™¤äº† Float ç±»å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¡«å†™ Dp ç±»å‹ï¼Œä½†éœ€è¦è½¬æ¢ç±»å‹ï¼Œå¦‚ä¸‹è¿™æ ·å†™ä¹Ÿèƒ½æ»¡è¶³ Animatable çš„è¦æ±‚ï¼š 123456789class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val anim = remember { Animatable(0.dp, Dp.VectorConverter) } } }} animateTo()ç°åœ¨ Animatable åˆ›å»ºå¥½äº†ï¼Œå®ƒå†…éƒ¨å­˜å‚¨äº†ä¸€ä¸ª Dp ç±»å‹çš„å€¼ã€‚æ¥ä¸‹æ¥å°±å¯ä»¥é…ç½®åŠ¨ç”»äº†ï¼Œè°ƒç”¨ animateTo() å‡½æ•°å³å¯ã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/d36ca2dc2f15b34be744fe4d9bbab918.png =700x) æç¤ºæˆ‘ä»¬ï¼šanimateTo() æ˜¯ä¸ª suspend å‡½æ•°ï¼Œå¿…é¡»è¦åœ¨åç¨‹é‡Œé¢ä½¿ç”¨ï¼š 123456789101112class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val anim = remember { Animatable(0.dp, Dp.VectorConverter) } LaunchedEffect(Unit) { anim.animateTo() } } }} ç°åœ¨åªéœ€è¦åœ¨ animateTo() é‡Œé¢æ·»åŠ ç›®æ ‡å€¼å³å¯ã€‚ 123456789101112class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val anim = remember { Animatable(0.dp, Dp.VectorConverter) } LaunchedEffect(Unit) { anim.animateTo(360.dp) } } }} åˆ°è¿™é‡Œ Animatable æ‰€éœ€è¦åšçš„å·¥ä½œå…¨éƒ¨å®Œæˆäº†ï¼Œç°åœ¨æˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨ ã€ animate*AsState ç”¨æ³• ã€‘ ä¸€æ–‡ä¸­çš„å°åˆºçŒ¬éª‘è½¦ç¤ºä¾‹æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var bicycleStart by mutableStateOf(false) setContent { val offset = remember(bicycleStart) { if (bicycleStart) 360.dp else 0.dp } val anim = remember { Animatable(offset, Dp.VectorConverter) } LaunchedEffect(bicycleStart) { anim.animateTo(offset) } Column{ Image( painter = painterResource(R.drawable.bicycle), contentDescription = null, modifier = Modifier .absoluteOffset(x = anim.value) ) Button( onClick = { bicycleStart = !bicycleStart }, modifier = Modifier .fillMaxWidth() .wrapContentSize(align = Alignment.Center) ) { Text(text = &quot;Ride&quot;) } } } }} è®©æˆ‘æ¥è§£è¯»ä¸‹è¿™æ®µä»£ç ï¼š å°åˆºçŒ¬éª‘è½¦çš„åç§»è·ç¦»å–å†³äº anim çš„å€¼ï¼Œå®ƒçš„å€¼ä¼šéšç€åŠ¨ç”»é€æ¸å˜åŒ–ã€‚ ç‚¹å‡» Button ä¼šæ”¹å˜ bicycleStart å€¼ï¼ŒbicycleStart å€¼å˜åŒ–ä¼šé‡æ–°æ‰§è¡Œ LaunchedEffect åç¨‹ï¼ŒanimateTo ä¼šæ‰§è¡Œï¼ŒåŠ¨ç”»å†æ¬¡å¯åŠ¨ã€‚ bicycleStart ä» false -&gt; trueï¼Œå°åˆºçŒ¬å¾€å‰éª‘ï¼Œtrue -&gt; falseï¼Œå°åˆºçŒ¬å¾€åéª‘ã€‚ æ•ˆæœå¦‚ä¸‹ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/74f73abf27849ba3362a805c44c4a2ba.gif =700x) ç»“åˆä¹‹å‰ animate*AsState åŠ¨ç”»ï¼Œæˆ‘ä»¬å¯ä»¥åšä¸ªå¯¹æ¯”ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/3ef7bde6787d5403b45150f9d90c5a63.gif =700x) Animatable çš„ animateTo() å¯ä»¥å®ç°å’Œ animateDpAsState ä¸€æ ·çš„æ•ˆæœï¼Œè€Œ animateDpAsState å†…éƒ¨å®é™…ä¸Šä¹Ÿæ˜¯é€šè¿‡ Animatable å®ç°åŠ¨ç”»çš„ã€‚ ç°åœ¨æˆ‘ä»¬å†æ¥çœ‹ä¸‹ animateTo() å‡½æ•°çš„å‚æ•°ï¼š 123456suspend fun animateTo( targetValue: T, animationSpec: AnimationSpec&lt;T&gt; = defaultSpringSpec, initialVelocity: T = velocity, block: (Animatable&lt;T, V&gt;.() -&gt; Unit)? = null) å®ƒå’Œ animateDpAsState ä¸€æ ·ä¹Ÿæœ‰ä¸€ä¸ªæ ¸å¿ƒå‚æ•°ï¼šanimationSpecï¼Œä¹‹å‰æˆ‘ä»¬å°±è¯´è¿‡ï¼Œå®ƒæ˜¯ä¸€ä¸ª AnimationSpec ç±»å‹ï¼Œä½ å¯ä»¥é€šè¿‡å¯é€‰çš„ AnimationSpec å‚æ•°æ¥è‡ªå®šä¹‰åŠ¨ç”»è§„èŒƒï¼ˆä¹Ÿå°±æ˜¯å¯ä»¥å®ç°ä¸åŒç±»å‹çš„åŠ¨ç”»æ•ˆæœï¼‰ã€‚ è¿™ç¯‡æ–‡ç« ä»ç„¶ä¸åšè®²è§£ï¼Œè€Œæ˜¯ä¼šæŠŠå®ƒä½œä¸ºå•ç‹¬çš„çŸ¥è¯†ç‚¹æ”¾åœ¨ ã€ AnimationSpect è¯¦è§£ ã€‘ ä¸€æ–‡ç»†è¯´ã€‚ ğŸ““ snapTo() é™¤äº† animateTo ä»¥å¤–ï¼ŒAnimatable è¿˜å¯ä»¥é€šè¿‡ snapTo() åœ¨åŠ¨ç”»å¼€å§‹å‰è®¾å®šåˆå§‹å€¼ã€‚ ä¾‹å¦‚ä¸‹é¢çš„ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031323334class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var bicycleStart by mutableStateOf(false) setContent { val offset = remember(bicycleStart) { if (bicycleStart) 360.dp else 0.dp } val anim = remember { Animatable(offset, Dp.VectorConverter) } LaunchedEffect(bicycleStart) { anim.snapTo(if (bicycleStart) 300.dp else 100.dp) // æŒ‡å®šåŠ¨ç”»åˆå§‹å€¼ anim.animateTo(offset) } Column{ Image( painter = painterResource(R.drawable.bicycle), contentDescription = null, modifier = Modifier .absoluteOffset(x = anim.value) ) Button( onClick = { bicycleStart = !bicycleStart }, modifier = Modifier .fillMaxWidth() .wrapContentSize(align = Alignment.Center) ) { Text(text = &quot;Ride&quot;) } } } }} è¿™ä¸ªå‡½æ•°çš„ä½œç”¨ä¸éš¾ç†è§£ï¼šåœ¨åŠ¨ç”»å¼€å§‹å‰æŒ‡å®šåˆå§‹å€¼ï¼Œä¹Ÿå°±æ˜¯è®©åŠ¨ç”»å¯ä»¥ä»ä¸€ä¸ªæŒ‡å®šçš„å€¼å¼€å§‹è¿åŠ¨ï¼Œçœ‹ä¸‹é¢çš„å¯¹æ¯”å›¾ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/a504853b388a3090372f75e57ed42c9a.gif =700x) è™½ç„¶åŠ¨ç”»å¾ˆå¿«ï¼ˆé»˜è®¤åªæœ‰ 300msï¼‰ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯èƒ½çœ‹å‡ºæ¥ snapTo() åï¼Œå°åˆºçŒ¬ä¼šè·³åˆ°æŒ‡å®šçš„å€¼å¼€å§‹è¿åŠ¨ã€‚","link":"/2024/08/01/Compose%20--%20%E5%8A%A8%E7%94%BB%20--%20%E6%B5%81%E7%A8%8B%E5%AE%9A%E5%88%B6%E5%9E%8B%E5%8A%A8%E7%94%BB%20API%EF%BC%9AAnimatable()/"},{"title":"ä½ çœŸçš„äº†è§£é‡ç»„å—ï¼Ÿ","text":"Jekpack Compose â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ ç³»åˆ—ï¼š &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - MutableState/mutableStateOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - remember å’Œé‡ç»„ä½œç”¨åŸŸ ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - æœ‰çŠ¶æ€ã€æ— çŠ¶æ€ã€çŠ¶æ€æå‡ï¼Ÿã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - mutableStateListOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - ä½ çœŸçš„äº†è§£é‡ç»„å—ï¼Ÿã€‘ å…ˆè€ƒè™‘ä¸€ä¸ªé—®é¢˜ï¼Œä»€ä¹ˆæ—¶å€™ä¼šé‡ç»„ï¼Ÿ 123val name by remember { mutableStateOf(&quot;Hi Compose&quot;)}val nums = mutableStateListOf(1, 2, 3)val maps = mutableStateMapOf(1 to &quot;One&quot;, 2 to &quot;Two&quot;) é€šè¿‡ä¹‹å‰çš„å‡ ç¯‡æ–‡ç« ï¼Œä½ åº”è¯¥å¯¹è¿™ä¸‰è¡Œä»£ç ä¸é™Œç”Ÿï¼Œå½“ç”¨ mutableState*Of ç”³æ˜ä¸€ä¸ªå˜é‡çš„æ—¶å€™ï¼Œåœ¨å¯ç»„åˆé¡¹ä¸­ï¼Œå¦‚æœå˜é‡å˜åŒ–äº†ï¼Œå°±ä¼šè§¦å‘é‡ç»„ã€‚ æ¯”å¦‚ä¸‹é¢ä»£ç ï¼š 12345678910111213class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { Column { Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) } } }} è¿è¡Œï¼š Text(name) è¢«é‡ç»„äº†ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯ä»…ä»… Text(name) è¢«é‡ç»„ï¼Œè€Œæ˜¯æ•´ä¸ª Lambda è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬ä¹‹å‰è¯´è¿‡ï¼Œè¿™å°±æ˜¯é‡ç»„ä½œç”¨åŸŸã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/7236814c37702499a201631fe2696fc5.png =500x) é‚£ä¹ˆæ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/e76b5b12964dbcb729a2f6ab29c6f6c4.png =500x) æˆ‘ä»¬å…ˆçœ‹ä¸€ä¸ªå¥½ç©çš„ä¸œè¥¿ï¼ŒæŸ¥çœ‹ Column å‡½æ•°ï¼š 1234567891011121314@Composableinline fun Column( modifier: Modifier = Modifier, verticalArrangement: Arrangement.Vertical = Arrangement.Top, horizontalAlignment: Alignment.Horizontal = Alignment.Start, content: @Composable ColumnScope.() -&gt; Unit) { val measurePolicy = columnMeasurePolicy(verticalArrangement, horizontalAlignment) Layout( content = { ColumnScopeInstance.content() }, measurePolicy = measurePolicy, modifier = modifier )} Column æ˜¯ä¸ª inline å‡½æ•°ï¼ˆå†…è”å‡½æ•°ï¼‰ï¼Œè¿™å°±æ„å‘³ç€åœ¨å®é™…ç¼–è¯‘ä¹‹å‰ï¼Œè¿™ä¸ªå‡½æ•°çš„è°ƒç”¨ä¼šè¢«æ›¿æ¢æˆå†…éƒ¨å®é™…çš„ä»£ç ï¼Œæ¯”å¦‚ä¼šæ˜¯ä¸‹é¢è¿™ä¸ªæ ·å­ï¼š 12345678910111213141516class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { // Column { // æ›¿æ¢ä¸º Layout( Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) ) // } } }} å†æ¥çœ‹ä¸‹ Layout()ï¼š 1234567891011@Composable inline fun Layout( content: @Composable @UiComposable () -&gt; Unit, modifier: Modifier = Modifier, measurePolicy: MeasurePolicy) { ... ... ReusableComposeNode&lt;ComposeUiNode, Applier&lt;Any&gt;&gt;( ... ... content = content )} ä¹Ÿæ˜¯ä¸ª inline å‡½æ•°ï¼Œé‚£ä¹ˆä»£ç åˆå›å˜æˆè¿™æ ·ï¼š 123456789101112131415161718class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { // Column { // Layout( // æ›¿æ¢ä¸º ReusableComposeNode( Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) ) // ) // } } }} å†æ¥çœ‹ä¸‹ ReusableComposeNodeï¼š 1234567891011@Composable @ExplicitGroupsComposableinline fun &lt;T, reified E : Applier&lt;*&gt;&gt; ReusableComposeNode( noinline factory: () -&gt; T, update: @DisallowComposableCalls Updater&lt;T&gt;.() -&gt; Unit, noinline skippableUpdate: @Composable SkippableUpdater&lt;T&gt;.() -&gt; Unit, content: @Composable () -&gt; Unit) { ... ... content() ... ...} åˆæ˜¯ inline å‡½æ•°ï¼Œè€Œä¸”ä½ çœ‹å®ƒå†…éƒ¨å¹²å•¥äº†ï¼Ÿç›´æ¥è°ƒç”¨äº† content()ï¼ æ‰€ä»¥æœ€ç»ˆä»£ç åœ¨ç¼–è¯‘å‰å…¶å®ä¼šæŠŠ Column {} ç»™æ‹¿æ‰ï¼Œå°±è·Ÿä¸‹é¢ä¸€æ ·ï¼š 123456789101112131415161718class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { // Column { // Layout( // æ›¿æ¢ä¸º // ReusableComposeNode( Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) // ) // ) // } } }} é‚£ä¹ˆè¿™å°±æ„å‘³ç€ï¼š 1234567891011121314151617class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { // ç»„ä»¶ 1ï¼Œè¿™ä¸ªåœ°æ–¹ä¼šå› ä¸º name çš„æ”¹å˜è€Œä¸€èµ·é‡æ–°è°ƒç”¨ Column { // ç»„ä»¶ 2ï¼Œè¿™ä¸ªåœ°æ–¹ä¼šå› ä¸º name çš„æ”¹å˜è€Œä¸€èµ·é‡æ–°è°ƒç”¨ Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) // ç»„ä»¶ 3ï¼Œè¿™ä¸ªåœ°æ–¹ä¼šå› ä¸º name çš„æ”¹å˜è€Œä¸€èµ·é‡æ–°è°ƒç”¨ } // ç»„ä»¶4ï¼Œè¿™ä¸ªåœ°æ–¹ä¼šå› ä¸º name çš„æ”¹å˜è€Œä¸€èµ·é‡æ–°è°ƒç”¨ } }} ä¸ºäº†éªŒè¯ï¼Œæˆ‘ä»¬æµ‹è¯•ä¸‹ï¼š 1234567891011121314151617class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { println(&quot;Recompose èŒƒå›´æµ‹è¯• 1&quot;) Column { println(&quot;Recompose èŒƒå›´æµ‹è¯• 2&quot;) Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) println(&quot;Recompose èŒƒå›´æµ‹è¯• 3&quot;) } println(&quot;Recompose èŒƒå›´æµ‹è¯• 4&quot;) } }} è¿è¡Œï¼š è¿™ä¸ª Log æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œç°åœ¨æˆ‘ä»¬ç‚¹å‡»ï¼š Log å·²ç»éªŒè¯äº†æˆ‘ä»¬åˆšæ‰çš„ç»“è®ºï¼Œé‚£è¿™å°±æ¶‰åŠåˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼šæ€§èƒ½é£é™©ï¼ æ¯”å¦‚ä¸‹é¢çš„ä»£ç æœ‰å¯èƒ½å‡ºç°åœ¨ä½ çš„ä»£ç ä¸­ï¼š 123456789101112131415161718192021222324class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { println(&quot;Recompose èŒƒå›´æµ‹è¯• 1&quot;) Column { println(&quot;Recompose èŒƒå›´æµ‹è¯• 2&quot;) Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) println(&quot;Recompose èŒƒå›´æµ‹è¯• 3&quot;) } NBFunction() println(&quot;Recompose èŒƒå›´æµ‹è¯• 4&quot;) } }}@Composablefun NBFunction() { println(&quot;Recompose èŒƒå›´æµ‹è¯•ï¼šæˆ‘å¹²äº†å¾ˆå¤šæ¶ˆè€—æ€§èƒ½çš„äº‹ï½ï½ï½&quot;) // è¿™é‡Œé¢å¹²äº†å¾ˆå¤š NB çš„äº‹ï¼Œé€»è¾‘é‡ç‰¹åˆ«å¤§} ä½ å†™äº†ä¸€ä¸ªå¾ˆç‰›é€¼çš„ Composable å‡½æ•°ï¼Œé‡Œé¢å¹²äº†å¾ˆå¤šå¤æ‚çš„äº‹ï¼Œç‰¹åˆ«æ¶ˆè€—æ€§èƒ½ï¼Œé‚£ä¹ˆæ¯æ¬¡éšç€ name çš„æ›´æ”¹ï¼ŒNBFunction() éƒ½ä¼šè¢«æ‰§è¡Œä¸€éï¼Œå°±å°±ä¼šå­˜åœ¨å·¨å¤§çš„æ€§èƒ½æ¶ˆè€—ã€‚ ä½ è¦ä¸ä¿¡ï¼Œæˆ‘ä»¬è¿è¡Œä¸€ä¸‹ï¼Œçœ‹ä¸‹ Logï¼š ğŸ¤”ï¼Ÿï¼Ÿï¼Ÿç‚¹å‡» name åï¼ŒNBFunction() ç«Ÿç„¶æ²¡æœ‰å†æ¬¡æ‰§è¡Œï¼Ÿä½†å…¶ä»– Log ä»ç„¶æ‰§è¡Œäº†å•Šï¼ éš¾é“ NBFunction() æ²¡æœ‰è¢«è°ƒç”¨ï¼Ÿ å…¶å® NBFunction() è¢«è°ƒç”¨äº†ï¼Œåªä¸è¿‡è¿›å…¥ NBFunction() å†…éƒ¨åï¼Œå†…éƒ¨çš„ä»£ç æ²¡æœ‰è¢«æ‰§è¡Œã€‚ ğŸ¤”ï¼Ÿï¼Ÿï¼Ÿéƒ½è¿›æ¥äº†ï¼Œä½ è·Ÿæˆ‘è¯´å†…éƒ¨ä»£ç ä¸æ‰§è¡Œï¼Ÿâ€“ å¯¹ï¼ å…¶å®è¿™æ˜¯å› ä¸ºï¼šåœ¨ Compose çš„ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œç¼–è¯‘å™¨æ’ä»¶ä¼šåšå¹²é¢„ï¼Œè¿™ä¸ªå¹²é¢„è¿‡ç¨‹ä¼šä¿®æ”¹æˆ‘ä»¬çš„ Compose å‡½æ•°ï¼Œæ¯”å¦‚è¯´å®ƒä¼šç»™å‡½æ•°å†…éƒ¨çš„ä»£ç åŠ ä¸Šä¸€äº›æ¡ä»¶åˆ¤æ–­ï¼Œåˆ¤æ–­è¿™ä¸ªå‡½æ•°çš„å‚æ•°è·Ÿä¸Šä¸€æ¬¡å‡½æ•°è¢«è°ƒç”¨çš„æ—¶å€™ä¼ å…¥çš„å‚æ•°æœ‰æ²¡æœ‰æ”¹å˜ï¼Œå¦‚æœæ²¡æœ‰æ”¹å˜ï¼Œå°±ç›´æ¥è·³è¿‡è¿™ä¸ªå‡½æ•°çš„å†…éƒ¨ä»£ç çš„æ‰§è¡Œï¼Œè¿™æ˜¯ Compose çš„ä¼˜åŒ–ã€‚ è€Œä½ çœ‹ NBFunction() è¿™ä¸ªå‡½æ•°æœ‰å‚æ•°å—ï¼Ÿâ€“ æ²¡æœ‰ï¼Œæ‰€ä»¥å®ƒå†…éƒ¨ä»£ç æ°¸è¿œä¸ä¼šæ‰§è¡Œï¼Œæ‰€ä»¥ Log è‚¯å®šä¸ä¼šæ‰“å°å‡ºæ¥ã€‚ æ¥è¯•ä¸€ä¸‹ï¼Œæ”¹ä¸‹ä»£ç ï¼š 12345678910111213141516171819202122232425class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) setContent { println(&quot;Recompose èŒƒå›´æµ‹è¯• 1&quot;) Column { println(&quot;Recompose èŒƒå›´æµ‹è¯• 2&quot;) Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; }) println(&quot;Recompose èŒƒå›´æµ‹è¯• 3&quot;) NBFunction(name) } println(&quot;Recompose èŒƒå›´æµ‹è¯• 4&quot;) } }}@Composablefun NBFunction(name: String) { println(&quot;Recompose èŒƒå›´æµ‹è¯•ï¼šæˆ‘å¹²äº†å¾ˆå¤šæ¶ˆè€—æ€§èƒ½çš„äº‹ï½ï½ï½&quot;) // è¿™é‡Œé¢å¹²äº†å¾ˆå¤š NB çš„äº‹ï¼Œé€»è¾‘é‡ç‰¹åˆ«å¤§ Text(&quot;$name&quot;)} æˆ‘ä»¬ç»™ NBFunction åŠ ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆéšç€ name çš„æ”¹å˜ï¼Œçœ‹çœ‹å®ƒä¼šä¸ä¼šè¢«æ‰§è¡Œï¼š ç»“æœæ˜¾è€Œæ˜“è§äº†ï¼Compose é‡ç»„è¿‡ç¨‹ä¸­ä¼šåˆ¤æ–­ NBFunction() çš„å‚æ•° String æ˜¯å¦å˜åŒ–ï¼Œé‚£ä¹ˆå¦‚æœæˆ‘çš„å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡å‘¢ï¼Ÿ æ¯”å¦‚æˆ‘ä¼ å…¥çš„æ˜¯ï¼š 1data class User(val name: String) Compose åœ¨é‡ç»„è¿‡ç¨‹ä¸­ï¼Œä¾ç„¶ä¼šå¯¹å¯¹è±¡ç±»å‹çš„å‚æ•°åšåˆ¤æ–­ï¼Œä¸è¿‡å®ƒçš„åˆ¤æ–­è§„åˆ™æ˜¯ Kotlin ä¸­çš„ â€œ==â€ï¼Œç­‰åŒäº Java çš„ â€œequalsâ€ï¼Œæ˜¯ç»“æ„æ€§ç›¸ç­‰åˆ¤æ–­ã€‚ ç°åœ¨æˆ‘ä»¬ä¿®æ”¹ä¸‹ä»£ç ï¼š 12345678910111213141516171819202122232425262728293031class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) var name by mutableStateOf(&quot;Hi, Compose&quot;) var user = User(&quot;marco&quot;) // User å¯¹è±¡ setContent { println(&quot;Recompose èŒƒå›´æµ‹è¯• 1&quot;) Column { println(&quot;Recompose èŒƒå›´æµ‹è¯• 2&quot;) Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; user = User(&quot;marco&quot;) // ç‚¹å‡»åï¼Œæ–°çš„ User å¯¹è±¡ }) println(&quot;Recompose èŒƒå›´æµ‹è¯• 3&quot;) NBFunction(user) } println(&quot;Recompose èŒƒå›´æµ‹è¯• 4&quot;) } }}@Composablefun NBFunction(user: User) { println(&quot;Recompose èŒƒå›´æµ‹è¯•ï¼šæˆ‘å¹²äº†å¾ˆå¤šæ¶ˆè€—æ€§èƒ½çš„äº‹ï½ï½ï½&quot;) // è¿™é‡Œé¢å¹²äº†å¾ˆå¤š NB çš„äº‹ï¼Œé€»è¾‘é‡ç‰¹åˆ«å¤§ Text(&quot;${user.name}&quot;)}data class User(val name: String) ä»£ç å¾ˆç®€å•ï¼Œæˆ‘ä»¬é€šè¿‡ Log éªŒè¯ä¸‹ï¼š æˆ‘ä»¬å†æ”¹ä¸‹ä»£ç ï¼ŒæŠŠ User æ¢æˆä¸€ä¸ªæ–°çš„å†…å®¹ï¼š 123456var user = User(&quot;marco&quot;)Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; user = User(&quot;marco_2&quot;)}) å†çœ‹ä¸‹ Logï¼š ç¡®å®å¦‚æˆ‘ä»¬å‰é¢é¢„æƒ³ä¸€æ ·ï¼ŒCompose é‡ç»„è¿‡ç¨‹ä¸­åŒæ ·ä¼šå¯¹ NBFunction() çš„å¯¹è±¡å‚æ•°ä¹Ÿåšåˆ¤æ–­ï¼Œæ˜¯ç»“æ„æ€§ç›¸ç­‰åˆ¤æ–­ã€‚ æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ä¸ªæœ‰æ„æ€çš„ä¸œè¥¿ï¼Œæˆ‘ä»¬å†æ¥æ”¹ä¸€ä¸‹ä»£ç ï¼š 12345678910111213var user = User(&quot;marco&quot;)Text(name, Modifier.clickable { name = &quot;Hi, Kotlin&quot; user = User(&quot;marco&quot;). // user æ”¹å›æ¥ï¼Œéƒ½æ˜¯ marco å†…å®¹})==&gt; æ­¤æ—¶è‚¯å®šæ˜¯ä¼šåˆ¤æ–­ç›¸ç­‰ï¼Œä¸ä¼šæ‰§è¡Œ NBFunction() å†…éƒ¨çš„ä»£ç ---==&gt; æ¥ä¸‹æ¥æˆ‘ä»¬åªæ”¹ä¸€ä¸‹å…³é”®å­—ï¼šdata class User(val name: String)// val --&gt; vardata class User(var name: String) ä»…ä»…æŠŠ val æ”¹æˆ varï¼Œè¿è¡Œçœ‹ Logï¼š ğŸ¤”ï¼Ÿï¼Ÿï¼Ÿval å°±ä¼šè·³è¿‡ NBFunction() å†…éƒ¨ä»£ç ï¼Œvar å°±ä¸ä¼šè·³è¿‡ NBFunction() å†…éƒ¨ä»£ç ï¼ŸWhyï¼Ÿ è¿™æ˜¯å› ä¸º Compose çš„æœ¬èº«æœºåˆ¶è®¾å®šï¼š 12data class User(val name: String) // Compose ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªå¯é çš„ç±»data class User(var name: String) // Compose ä¼šè®¤ä¸ºè¿™æ˜¯ä¸€ä¸ªä¸å¯é çš„ç±» å¯¹äºä¸å¯é çš„ç±»ï¼Œæˆ‘å°±ä¸ç®¡ä½ äº†ï¼Œç›´æ¥è¿›ï¼è¿™æ˜¯å› ä¸ºå‡ºäºç•Œé¢æ­£ç¡®æ€§çš„è€ƒè™‘ã€‚ æ¯”å¦‚æˆ‘ä»¬ä¿®æ”¹ä¸‹ä»£ç ï¼š æ‰€ä»¥ï¼Œä¸æ€§èƒ½ç›¸æ¯”ï¼Œå‡†ç¡®æ€§æ‰æ˜¯æœ€ç»ˆè¦çš„ï¼Œæ‰€ä»¥å°±ä¼šæ— æ¡ä»¶çš„è¿›å…¥ NBFunction() å‡½æ•°å†æ‰§è¡Œä¸€éã€‚ é‚£å¦‚æœå‡è®¾æˆ‘ä»¬å¯ä»¥ä¿è¯ä¸ä¼šå‡ºç°ä»¥ä¸Šæƒ…å†µï¼Œä¿è¯ User å¯¹è±¡æ°¸è¿œç›¸ç­‰ï¼Œå¸Œæœ› Composable æ’ä»¶ä¹Ÿå¯ä»¥è·³è¿‡å†…éƒ¨æ‰§è¡Œï¼Œæå‡æ€§èƒ½ï¼Œå¦‚ä½•åšå‘¢ï¼Ÿ ç”¨ @Stable æ³¨è§£ï¼Œå®ƒæ˜¯ä¸€ä¸ªç¨³å®šæ€§æ³¨è§£ï¼Œå‘Šè¯‰ Compose ç¼–è¯‘å™¨æ’ä»¶ï¼Œè¿™ä¸ªç±»æ˜¯å¯é çš„ã€‚è¿™æ · Compose é‡ç»„è¿‡ç¨‹ä¸­å°±ä¼šè·³è¿‡ NBFunction() å†…éƒ¨ä»£ç ã€‚ 12@Stabledata class User(var name: String) è¿è¡Œçœ‹ä¸‹ Logï¼š é™¤äº† @Stable å¯ä»¥è®¤å®šå¯é ä»¥å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ–¹å¼å¯ä»¥å‘Šè¯‰ Compose æ˜¯å¯é çš„ï¼š 123class User(name: String) { var name by mutableStateOf(name) // è¿™æ˜¯ä¸€ç§æ›´é€šç”¨çš„å†™æ³•}","link":"/2024/07/22/Compose%20--%20%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85%20&%20%E8%87%AA%E5%8A%A8%E5%88%B7%E6%96%B0%20--%20%E4%BD%A0%E7%9C%9F%E7%9A%84%E4%BA%86%E8%A7%A3%E9%87%8D%E7%BB%84%E5%90%97%EF%BC%9F/"},{"title":"SQLite -- ä»å…¥é—¨åˆ°ç²¾é€š","text":"@TOC SQLite æ˜¯éµå¾ªä¸€å¥—ç‹¬ç‰¹çš„ç§°ä¸ºè¯­æ³•çš„è§„åˆ™å’Œå‡†åˆ™ã€‚æœ‰ä¸ªé‡è¦çš„ç‚¹å€¼å¾—æ³¨æ„ï¼ŒSQLite æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›å‘½ä»¤æ˜¯å¤§å°å†™æ•æ„Ÿçš„ï¼Œæ¯”å¦‚ GLOB å’Œ glob åœ¨ SQLite çš„è¯­å¥ä¸­æœ‰ä¸åŒçš„å«ä¹‰ã€‚ ä¸€ã€æ•°æ®åº“æ“ä½œ1.1 æ–°å»ºæ•°æ®åº“å¯ä»¥ç›´æ¥æ‰§è¡Œ sqlite3 filename æ‰“å¼€æˆ–åˆ›å»ºä¸€ä¸ª SQLite æ•°æ®åº“ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼ŒSQLite ä¼šè‡ªåŠ¨åˆ›å»ºå®ƒã€‚ 1234maxin@maxindeMacBook-Pro db % sqlite3 test.dbSQLite version 3.46.1 2024-08-13 09:16:08Enter &quot;.help&quot; for usage hints.sqlite&gt; 1.2 æŸ¥çœ‹æ•°æ®åº“12sqlite&gt; .databasesmain: /Users/maxin/Desktop/db/test.db r/w ä½¿ç”¨ .quit æˆ–è€… .exit é€€å‡º sqlite3 å·¥å…·ã€‚ å†æŸ¥çœ‹å½“å‰ç›®å½•ï¼Œä¼šå‘ç°æ–°å¢äº†ä¸€ä¸ª test.db æ–‡ä»¶ã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/direct/3e4b894601524de49e534f2e78c6844b.png =430x) 1.3 æŸ¥çœ‹å¸®åŠ©æŒ‡ä»¤ä½¿ç”¨ .help æŸ¥çœ‹ å¸®åŠ©ä¿¡æ¯ã€‚ 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364sqlite&gt; .help.archive ... Manage SQL archives.auth ON|OFF Show authorizer callbacks.backup ?DB? FILE Backup DB (default &quot;main&quot;) to FILE.bail on|off Stop after hitting an error. Default OFF.cd DIRECTORY Change the working directory to DIRECTORY.changes on|off Show number of rows changed by SQL.check GLOB Fail if output since .testcase does not match.clone NEWDB Clone data into NEWDB from the existing database.connection [close] [#] Open or close an auxiliary database connection.databases List names and files of attached databases.dbconfig ?op? ?val? List or change sqlite3_db_config() options.dbinfo ?DB? Show status information about the database.dump ?OBJECTS? Render database content as SQL.echo on|off Turn command echo on or off.eqp on|off|full|... Enable or disable automatic EXPLAIN QUERY PLAN.excel Display the output of next command in spreadsheet.exit ?CODE? Exit this program with return-code CODE.expert EXPERIMENTAL. Suggest indexes for queries.explain ?on|off|auto? Change the EXPLAIN formatting mode. Default: auto.filectrl CMD ... Run various sqlite3_file_control() operations.fullschema ?--indent? Show schema and the content of sqlite_stat tables.headers on|off Turn display of headers on or off.help ?-all? ?PATTERN? Show help text for PATTERN.import FILE TABLE Import data from FILE into TABLE.indexes ?TABLE? Show names of indexes.intck ?STEPS_PER_UNLOCK? Run an incremental integrity check on the db.limit ?LIMIT? ?VAL? Display or change the value of an SQLITE_LIMIT.lint OPTIONS Report potential schema issues..load FILE ?ENTRY? Load an extension library.log FILE|on|off Turn logging on or off. FILE can be stderr/stdout.mode MODE ?OPTIONS? Set output mode.nonce STRING Suspend safe mode for one command if nonce matches.nullvalue STRING Use STRING in place of NULL values.once ?OPTIONS? ?FILE? Output for the next SQL command only to FILE.open ?OPTIONS? ?FILE? Close existing database and reopen FILE.output ?FILE? Send output to FILE or stdout if FILE is omitted.parameter CMD ... Manage SQL parameter bindings.print STRING... Print literal STRING.progress N Invoke progress handler after every N opcodes.prompt MAIN CONTINUE Replace the standard prompts.quit Stop interpreting input stream, exit if primary..read FILE Read input from FILE or command output.recover Recover as much data as possible from corrupt db..restore ?DB? FILE Restore content of DB (default &quot;main&quot;) from FILE.save ?OPTIONS? FILE Write database to FILE (an alias for .backup ...).scanstats on|off|est Turn sqlite3_stmt_scanstatus() metrics on or off.schema ?PATTERN? Show the CREATE statements matching PATTERN.separator COL ?ROW? Change the column and row separators.session ?NAME? CMD ... Create or control sessions.sha3sum ... Compute a SHA3 hash of database content.shell CMD ARGS... Run CMD ARGS... in a system shell.show Show the current values for various settings.stats ?ARG? Show stats or turn stats on or off.system CMD ARGS... Run CMD ARGS... in a system shell.tables ?TABLE? List names of tables matching LIKE pattern TABLE.timeout MS Try opening locked tables for MS milliseconds.timer on|off Turn SQL timer on or off.trace ?OPTIONS? Output each SQL statement as it is run.version Show source, library and compiler versions.vfsinfo ?AUX? Information about the top-level VFS.vfslist List all available VFSes.vfsname ?AUX? Print the name of the VFS stack.width NUM1 NUM2 ... Set minimum column widths for columnar output äºŒã€è¡¨æ“ä½œ2.1 åˆ›å»ºè¡¨SQLite çš„ CREATE TABLE è¯­å¥ç”¨äºåœ¨ä»»ä½•ç»™å®šçš„æ•°æ®åº“åˆ›å»ºä¸€ä¸ªæ–°è¡¨ã€‚åˆ›å»ºåŸºæœ¬è¡¨ï¼Œæ¶‰åŠåˆ°å‘½åè¡¨ã€å®šä¹‰åˆ—åŠæ¯ä¸€åˆ—çš„æ•°æ®ç±»å‹ã€‚ CREATE TABLE è¯­å¥çš„åŸºæœ¬è¯­æ³•å¦‚ä¸‹ï¼š 1234567CREATE TABLE database_name.table_name( column1 datatype PRIMARY KEY(one or more columns), column2 datatype, column3 datatype, ..... columnN datatype,); CREATE TABLE æ˜¯å‘Šè¯‰æ•°æ®åº“ç³»ç»Ÿåˆ›å»ºä¸€ä¸ªæ–°è¡¨çš„å…³é”®å­—ã€‚CREATE TABLE è¯­å¥åè·Ÿç€è¡¨çš„å”¯ä¸€çš„åç§°æˆ–æ ‡è¯†ã€‚ä½ ä¹Ÿå¯ä»¥é€‰æ‹©æŒ‡å®šå¸¦æœ‰ table_name çš„ database_nameã€‚ ä¾‹å¦‚ï¼šåˆ›å»ºä¸€ä¸ª COMPANY è¡¨ï¼ŒID ä½œä¸ºä¸»é”®ï¼ŒNOT NULL çš„çº¦æŸè¡¨ç¤ºåœ¨è¡¨ä¸­åˆ›å»ºçºªå½•æ—¶è¿™äº›å­—æ®µä¸èƒ½ä¸º NULLï¼š 1234567sqlite&gt; CREATE TABLE COMPANY( ID INT PRIMARY KEY NOT NULL, NAME TEXT NOT NULL, AGE INT NOT NULL, ADDRESS CHAR(50), SALARY REAL); æˆ‘ä»¬æ¥è§£è¯»ä¸€ä¸‹è¿™ç§è¯­æ³•ç»“æ„ï¼š CREATE TABLE è¯­å¥ CREATE TABLE æ˜¯ç”¨æ¥ åˆ›å»ºæ•°æ®åº“è¡¨ çš„ SQL è¯­å¥ã€‚ æ‹†è§£ å«ä¹‰ è¯´æ˜ COMPANY æ–°è¡¨çš„ è¡¨å ä½ å¯ä»¥é€šè¿‡è¿™ä¸ªåå­—æ¥å¼•ç”¨è¯¥è¡¨ åœ†æ‹¬å· () æ‹¬å·ä¸­çš„å†…å®¹å®šä¹‰äº† è¡¨çš„ç»“æ„ å³æ¯ä¸€åˆ—ï¼ˆå­—æ®µï¼‰çš„åç§°ã€æ•°æ®ç±»å‹åŠçº¦æŸæ¡ä»¶ è¡¨çš„åˆ—å®šä¹‰ åœ¨è¿™æ®µè¯­æ³•ä¸­ï¼Œæ¯ä¸€è¡Œå®šä¹‰äº†ä¸€åˆ—ï¼ˆå­—æ®µï¼‰ï¼ŒåŒ…æ‹¬å­—æ®µåã€æ•°æ®ç±»å‹ï¼Œä»¥åŠä¸€äº›å¯é€‰çš„çº¦æŸæ¡ä»¶ã€‚ åˆ—ï¼ˆå­—æ®µåï¼‰ æ•°æ®ç±»å‹ æ˜¯å¦å…è®¸ä¸ºç©º æ˜¯å¦ä¸ºä¸»é”® è¯´æ˜ ID INT ä¸å…è®¸ æ˜¯ å‘˜å·¥çš„å”¯ä¸€æ ‡è¯†ï¼ˆä¸»é”®ï¼‰ NAME TEXT ä¸å…è®¸ å¦ å‘˜å·¥çš„å§“å AGE INT ä¸å…è®¸ å¦ å‘˜å·¥çš„å¹´é¾„ ADDRESS CHAR(50) å…è®¸ å¦ å‘˜å·¥çš„åœ°å€ï¼Œæœ€å¤š 50 ä¸ªå­—ç¬¦ SALARY REAL å…è®¸ å¦ å‘˜å·¥çš„è–ªèµ„ï¼ˆæµ®ç‚¹æ•°ï¼‰ æˆ‘ä»¬è¯´è¿‡ï¼šSQLite æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæ‰€ä»¥å¦‚æœä½ åƒä¸‹é¢è¿™æ ·å®šä¹‰ä¹Ÿæ˜¯å¯ä»¥çš„ï¼š 1234567create table company ( id int primary key not null, name text not null, age int not null, address char(50), salary real); å¸¸è§çš„ç¼–ç ä¹ æƒ¯ å¤§å†™å…³é”®å­—é£æ ¼ï¼ˆä¾‹å¦‚ï¼šCREATE TABLEã€SELECTã€INSERT ç­‰å…³é”®å­—å¤§å†™ï¼‰è¿™ç§é£æ ¼æ¯”è¾ƒå¸¸è§äºå®˜æ–¹æ–‡æ¡£å’Œä¼ä¸šçº§å¼€å‘ï¼Œç›®çš„æ˜¯è®© SQL å…³é”®å­—åœ¨ä»£ç ä¸­æ›´é†’ç›®ï¼Œæ˜“äºè¯†åˆ«ã€‚ä¾‹å¦‚ï¼šCREATE TABLE COMPANY (ID INT PRIMARY KEY)ã€‚ å°å†™å…³é”®å­—é£æ ¼ï¼ˆä¾‹å¦‚ï¼šcreate tableã€selectï¼‰æœ‰äº›å¼€å‘è€…æˆ–ç¤¾åŒºæ›´å€¾å‘äºå…¨å°å†™ï¼Œè®¤ä¸ºè¿™æ ·é£æ ¼ä¸€è‡´ï¼Œçœ‹èµ·æ¥æ›´åŠ ç®€æ´ã€‚åœ¨æŸäº›è¯­è¨€ä¸­ï¼Œå¦‚ Python ç­‰ï¼Œæƒ¯ç”¨å…¨å°å†™é£æ ¼ï¼Œå¼€å‘è€…ä¼šæŠŠè¿™ä¸ªä¹ æƒ¯å¸¦åˆ° SQL ä¸­ã€‚ è¿™ç§å·®å¼‚ä¸»è¦æ˜¯ä¸ªäººåå¥½æˆ–å›¢é˜Ÿé£æ ¼çš„é€‰æ‹©ï¼ŒåŠŸèƒ½ä¸Šæ²¡æœ‰ä»»ä½•å½±å“ã€‚ ç¼–å†™é£æ ¼å»ºè®® æ— è®ºä½ ä½¿ç”¨å¤§å†™è¿˜æ˜¯å°å†™ï¼Œä¿æŒä¸€è‡´æ€§ éƒ½æ˜¯è‰¯å¥½çš„ç¼–ç ä¹ æƒ¯ï¼Œå°¤å…¶æ˜¯åœ¨å¤šäººåä½œå¼€å‘ä¸­ã€‚é€šå¸¸ï¼Œå›¢é˜Ÿä¼šç»Ÿä¸€ç¼–ç è§„èŒƒï¼Œæ¯”å¦‚ï¼š æ‰€æœ‰ ã€ŒSQL å…³é”®å­—ã€ ç”¨å¤§å†™ï¼Œä¾‹å¦‚ï¼šSELECTã€FROMã€‚ ã€Œè¡¨åã€ å’Œ ã€Œåˆ—åã€ ç”¨å°å†™ï¼ˆæˆ–è›‡å½¢å‘½åï¼‰ï¼Œä¾‹å¦‚ï¼šuser_nameã€order_dateã€‚ æ¯”å¦‚åƒä¸‹é¢è¿™æ ·ï¼š 12345CREATE TABLE company ( id INT PRIMARY KEY, name TEXT NOT NULL, age INT NOT NULL); å†æ¯”å¦‚ï¼Œæˆ‘ä»¬åˆ›å»ºåä¸º userã€student çš„è¡¨ï¼š 12345maxin@maxindeMacBook-Pro db % sqlite3 test.dbSQLite version 3.46.1 2024-08-13 09:16:08Enter &quot;.help&quot; for usage hints.sqlite&gt; CREATE TABLE user(name text, age int);sqlite&gt; CREATE TABLE student(id int, name text, age int, primary key(id)); 2.2 è¡¨ä¿¡æ¯è¡¨åˆ›å»ºå®Œæˆåï¼Œä½ å¯ä»¥ä½¿ç”¨ .tables æˆ–è€… .table tableName å‘½ä»¤æŸ¥çœ‹æ‰€æœ‰ç°æœ‰è¡¨æ ¼æˆ–è€…å•ä¸ªè¡¨æ ¼çš„ä¿¡æ¯ï¼š 12345678sqlite&gt; .tablesCOMPANY student usersqlite&gt; .table COMPANYCOMPANYsqlite&gt; .table studentstudentsqlite&gt; .table useruser 2.3 è¡¨ç´¢å¼•ä¿¡æ¯åœ¨ SQLite ä¸­ï¼Œ.indices æ˜¯ SQLite å‘½ä»¤è¡Œå·¥å…·ä¸­ç”¨äº åˆ—å‡ºä¸€ä¸ªè¡¨æ‰€æœ‰ç´¢å¼• çš„å‘½ä»¤ã€‚è¿™ä¸ªå‘½ä»¤çš„ä½œç”¨æ˜¯ã€Œå±•ç¤ºæŸä¸ªè¡¨å·²ç»å®šä¹‰çš„æ‰€æœ‰ç´¢å¼•ã€ã€‚ åŸºæœ¬è¯­æ³•ï¼š 1.indices è¡¨å ä¾‹å¦‚ï¼š 1234567sqlite&gt; .indices COMPANYsqlite_autoindex_COMPANY_1------------------------------------------sqlite&gt; .indices studentsqlite_autoindex_student_1------------------------------------------sqlite&gt; .indices user # user è¡¨æ²¡æœ‰å»ºç´¢å¼• sqlite_autoindex_company_1 / sqlite_autoindex_student_1 è¿™æ˜¯ SQLite è‡ªåŠ¨åˆ›å»ºçš„ç´¢å¼•ï¼Œå› ä¸º COMPANY / student è¡¨ä¸­çš„ ID åˆ—å®šä¹‰ä¸º ä¸»é”®ï¼ˆPRIMARY KEYï¼‰ã€‚SQLite ä¼šè‡ªåŠ¨ä¸ºä¸»é”®åˆ—åˆ›å»ºç´¢å¼•ï¼Œå¸®åŠ©å¿«é€ŸæŸ¥è¯¢ã€‚ 2.4 è¡¨ç»“æ„ä¿¡æ¯åœ¨ SQLite ä¸­ï¼Œ.schema æ˜¯ SQLite å‘½ä»¤è¡Œå·¥å…·ä¸­çš„ä¸€ä¸ªå¸¸ç”¨å‘½ä»¤ï¼Œç”¨æ¥ã€ŒæŸ¥çœ‹æ•°æ®åº“ä¸­è¡¨ã€è§†å›¾ã€ç´¢å¼•ç­‰å¯¹è±¡çš„ åˆ›å»ºè¯­å¥ï¼ˆDDLï¼‰ã€ã€‚ æŸ¥çœ‹æ‰€æœ‰å¯¹è±¡çš„åˆ›å»ºè¯­å¥ï¼š 12345678910sqlite&gt; .schemaCREATE TABLE user(name text,age int);CREATE TABLE student(id int,name text,age int,primary key(id));CREATE TABLE COMPANY( ID INT PRIMARY KEY NOT NULL, NAME TEXT NOT NULL, AGE INT NOT NULL, ADDRESS CHAR(50), SALARY REAL); æŸ¥çœ‹æŒ‡å®šè¡¨çš„åˆ›å»ºè¯­å¥ï¼š 1234567891011121314sqlite&gt; .schema userCREATE TABLE user(name text,age int);------------------------------------------sqlite&gt; .schema studentCREATE TABLE student(id int,name text,age int,primary key(id));------------------------------------------sqlite&gt; .schema COMPANYCREATE TABLE COMPANY( ID INT PRIMARY KEY NOT NULL, NAME TEXT NOT NULL, AGE INT NOT NULL, ADDRESS CHAR(50), SALARY REAL); 2.5 åˆ é™¤è¡¨SQLite çš„ DROP TABLE è¯­å¥ç”¨æ¥åˆ é™¤è¡¨å®šä¹‰åŠå…¶æ‰€æœ‰ç›¸å…³æ•°æ®ã€ç´¢å¼•ã€è§¦å‘å™¨ã€çº¦æŸå’Œè¯¥è¡¨çš„æƒé™è§„èŒƒã€‚ ä½¿ç”¨æ­¤å‘½ä»¤æ—¶è¦ç‰¹åˆ«æ³¨æ„ï¼Œå› ä¸ºä¸€æ—¦ä¸€ä¸ªè¡¨è¢«åˆ é™¤ï¼Œè¡¨ä¸­æ‰€æœ‰ä¿¡æ¯ä¹Ÿå°†æ°¸è¿œä¸¢å¤±ï¼ï¼ï¼ åŸºæœ¬è¯­æ³•ï¼š 1DROP TABLE database_name.table_name; ä¾‹å¦‚ï¼šæˆ‘ä»¬åˆ é™¤ user è¡¨ è®©æˆ‘ä»¬å…ˆç¡®è®¤ user è¡¨å·²ç»å­˜åœ¨ï¼Œç„¶åæˆ‘ä»¬å°†å…¶ä»æ•°æ®åº“ä¸­åˆ é™¤ã€‚ 12sqlite&gt; .tablesCOMPANY student user è¿™æ„å‘³ç€ user è¡¨å·²å­˜åœ¨æ•°æ®åº“ä¸­ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬æŠŠå®ƒä»æ•°æ®åº“ä¸­åˆ é™¤ï¼Œå¦‚ä¸‹ï¼š 12sqlite&gt; drop table user;sqlite&gt; ç°åœ¨ï¼Œå¦‚æœå°è¯• .tables å‘½ä»¤ï¼Œé‚£ä¹ˆå°†æ— æ³•æ‰¾åˆ° user è¡¨äº†ï¼š 123sqlite&gt; .tablesCOMPANY studentsqlite&gt; ä¸‰ã€æ•°æ®è®°å½•æ“ä½œ3.1 æ–°å¢è®°å½•SQLite çš„ INSERT INTO è¯­å¥ç”¨äºå‘æ•°æ®åº“çš„æŸä¸ªè¡¨ä¸­æ·»åŠ æ–°çš„æ•°æ®è¡Œã€‚ INSERT INTO è¯­å¥æœ‰ä¸¤ç§åŸºæœ¬è¯­æ³•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 12INSERT INTO TABLE_NAME [(column1, column2, column3, ...columnN)] VALUES (value1, value2, value3, ...valueN); åœ¨è¿™é‡Œï¼Œcolumn1, column2,â€¦columnN æ˜¯è¦æ’å…¥æ•°æ®çš„è¡¨ä¸­çš„åˆ—çš„åç§°ã€‚å¦‚æœè¦ä¸ºè¡¨ä¸­çš„æ‰€æœ‰åˆ—æ·»åŠ å€¼ï¼Œä½ ä¹Ÿå¯ä»¥ä¸éœ€è¦åœ¨ SQLite æŸ¥è¯¢ä¸­æŒ‡å®šåˆ—åç§°ã€‚ä½†è¦ç¡®ä¿å€¼çš„é¡ºåºä¸åˆ—åœ¨è¡¨ä¸­çš„é¡ºåºä¸€è‡´ã€‚ SQLite çš„ INSERT INTO è¯­æ³•å¦‚ä¸‹ï¼š 1INSERT INTO TABLE_NAME VALUES (value1,value2,value3,...valueN); ä¾‹å¦‚ï¼Œæˆ‘ä»¬å¾€ COMPANY é‡Œé¢æ·»åŠ æ•°æ®ï¼š 1234567891011121314151617INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)VALUES (1, 'Paul', 32, 'California', 20000.00 );INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)VALUES (2, 'Allen', 25, 'Texas', 15000.00 );INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)VALUES (3, 'Teddy', 23, 'Norway', 20000.00 );INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)VALUES (4, 'Mark', 25, 'Rich-Mond ', 65000.00 );INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)VALUES (5, 'David', 27, 'Texas', 85000.00 );INSERT INTO COMPANY (ID,NAME,AGE,ADDRESS,SALARY)VALUES (6, 'Kim', 22, 'South-Hall', 45000.00 ); ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç¬¬äºŒç§è¯­æ³•åœ¨ COMPANY è¡¨ä¸­åˆ›å»ºä¸€ä¸ªè®°å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š 123456INSERT INTO COMPANY VALUES (1, 'Paul', 32, 'California', 20000.00 );INSERT INTO COMPANY VALUES (2, 'Allen', 25, 'Texas', 15000.00 );INSERT INTO COMPANY VALUES (3, 'Teddy', 23, 'Norway', 20000.00 );INSERT INTO COMPANY VALUES (4, 'Mark', 25, 'Rich-Mond ', 65000.00 );INSERT INTO COMPANY VALUES (5, 'David', 27, 'Texas', 85000.00 );INSERT INTO COMPANY VALUES (6, 'Kim', 22, 'South-Hall', 45000.00 ); 3.2 æŸ¥çœ‹è®°å½•SQLite çš„ SELECT è¯­å¥ç”¨äºä» SQLite æ•°æ®åº“è¡¨ä¸­è·å–æ•°æ®ï¼Œä»¥ç»“æœè¡¨çš„å½¢å¼è¿”å›æ•°æ®ã€‚è¿™äº›ç»“æœè¡¨ä¹Ÿè¢«ç§°ä¸ºç»“æœé›†ã€‚ åŸºæœ¬è¯­æ³•ï¼š 1SELECT column1, column2, columnN FROM table_name; åœ¨è¿™é‡Œï¼Œcolumn1, column2â€¦ æ˜¯è¡¨çš„å­—æ®µï¼Œå®ƒä»¬çš„å€¼å³æ˜¯ä½ è¦è·å–çš„ã€‚å¦‚æœä½ æƒ³è·å–æ‰€æœ‰å¯ç”¨çš„å­—æ®µï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„è¯­æ³•ï¼š 1SELECT * FROM table_name; ä¾‹å¦‚ï¼Œæˆ‘ä»¬åˆšåˆšç»™ COMPANY è¡¨æ·»åŠ äº†æ•°æ®ï¼Œç°åœ¨æŸ¥çœ‹ä¸‹ï¼š 1234567sqlite&gt; select * from company;1|Paul|32|California|20000.02|Allen|25|Texas|15000.03|Teddy|23|Norway|20000.04|Mark|25|Rich-Mond |65000.05|David|27|Texas|85000.06|Kim|22|South-Hall|45000.0 å¦‚æœåªæƒ³è·å– COMPANY è¡¨ä¸­æŒ‡å®šçš„å­—æ®µï¼Œåˆ™ä½¿ç”¨ä¸‹é¢çš„æŸ¥è¯¢ï¼š 12345678910sqlite&gt; .mode columnsqlite&gt; SELECT ID, NAME, SALARY FROM COMPANY;ID NAME SALARY-- ----- -------1 Paul 20000.02 Allen 15000.03 Teddy 20000.04 Mark 65000.05 David 85000.06 Kim 45000.0 3.3 ä¸åŒæ ¼å¼è¾“å‡ºåœ¨ SQLite å‘½ä»¤è¡Œå·¥å…·ä¸­ï¼Œ.mode ç”¨äºæ§åˆ¶ã€ŒæŸ¥è¯¢ç»“æœçš„è¾“å‡ºæ ¼å¼ã€ã€‚æ ¹æ®éœ€æ±‚ï¼Œä½ å¯ä»¥é€‰æ‹©ä¸åŒçš„æ¨¡å¼ï¼Œæ¯”å¦‚å°†æ•°æ®æ ¼å¼åŒ–ä¸ºè¡¨æ ¼ã€CSVã€HTML æˆ–å…¶ä»–æ ·å¼ã€‚è¿™å¯ä»¥å¸®åŠ©ä½ æ›´æ–¹ä¾¿åœ°æŸ¥çœ‹ã€è°ƒè¯•å’Œå¯¼å‡ºæ•°æ®ã€‚ å¸¸è§çš„ .mode é€‰é¡¹åŠå…¶ä½œç”¨ï¼š 1. columnï¼ˆåˆ—æ¨¡å¼ï¼‰ æ•°æ®ä»¥ è¡¨æ ¼å½¢å¼ æ˜¾ç¤ºï¼Œåˆ—åå’Œæ•°æ®å¯¹é½ï¼Œé€‚åˆäººç±»é˜…è¯»ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode columnsqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š12345678ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.02 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 2. listï¼ˆåˆ—è¡¨æ¨¡å¼ï¼‰ æ•°æ®ä»¥ ç«–çº¿ï¼ˆ|ï¼‰åˆ†éš”ï¼Œé€‚åˆå¿«é€ŸæŸ¥çœ‹æˆ–å¤åˆ¶ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode listsqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š1234567ID|NAME|AGE|ADDRESS|SALARY1|Paul|32|California|20000.02|Allen|25|Texas|15000.03|Teddy|23|Norway|20000.04|Mark|25|Rich-Mond |65000.05|David|27|Texas|85000.06|Kim|22|South-Hall|45000.0 3. csvï¼ˆCSV æ¨¡å¼ï¼‰ æ•°æ®ä»¥ é€—å·åˆ†éš”å€¼ æ ¼å¼è¾“å‡ºï¼Œé€‚åˆå¯¼å‡ºåˆ°æ–‡ä»¶æˆ–ç”µå­è¡¨æ ¼ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode csvsqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š1234567ID,NAME,AGE,ADDRESS,SALARY1,Paul,32,California,20000.02,Allen,25,Texas,15000.03,Teddy,23,Norway,20000.04,Mark,25,&quot;Rich-Mond &quot;,65000.05,David,27,Texas,85000.06,Kim,22,South-Hall,45000.0 4. htmlï¼ˆHTML æ¨¡å¼ï¼‰ æ•°æ®ä»¥ HTML è¡¨æ ¼ æ ¼å¼è¾“å‡ºï¼Œé€‚åˆå¯¼å‡ºåˆ°ç½‘é¡µæˆ–æŠ¥å‘Šä¸­ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode htmlsqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š123456789101112131415161718192021222324252627282930313233343536373839404142&lt;TR&gt;&lt;TH&gt;ID&lt;/TH&gt;&lt;TH&gt;NAME&lt;/TH&gt;&lt;TH&gt;AGE&lt;/TH&gt;&lt;TH&gt;ADDRESS&lt;/TH&gt;&lt;TH&gt;SALARY&lt;/TH&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;1&lt;/TD&gt;&lt;TD&gt;Paul&lt;/TD&gt;&lt;TD&gt;32&lt;/TD&gt;&lt;TD&gt;California&lt;/TD&gt;&lt;TD&gt;20000.0&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;2&lt;/TD&gt;&lt;TD&gt;Allen&lt;/TD&gt;&lt;TD&gt;25&lt;/TD&gt;&lt;TD&gt;Texas&lt;/TD&gt;&lt;TD&gt;15000.0&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;3&lt;/TD&gt;&lt;TD&gt;Teddy&lt;/TD&gt;&lt;TD&gt;23&lt;/TD&gt;&lt;TD&gt;Norway&lt;/TD&gt;&lt;TD&gt;20000.0&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;4&lt;/TD&gt;&lt;TD&gt;Mark&lt;/TD&gt;&lt;TD&gt;25&lt;/TD&gt;&lt;TD&gt;Rich-Mond &lt;/TD&gt;&lt;TD&gt;65000.0&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;5&lt;/TD&gt;&lt;TD&gt;David&lt;/TD&gt;&lt;TD&gt;27&lt;/TD&gt;&lt;TD&gt;Texas&lt;/TD&gt;&lt;TD&gt;85000.0&lt;/TD&gt;&lt;/TR&gt;&lt;TR&gt;&lt;TD&gt;6&lt;/TD&gt;&lt;TD&gt;Kim&lt;/TD&gt;&lt;TD&gt;22&lt;/TD&gt;&lt;TD&gt;South-Hall&lt;/TD&gt;&lt;TD&gt;45000.0&lt;/TD&gt;&lt;/TR&gt; 5. tabsï¼ˆåˆ¶è¡¨ç¬¦åˆ†éš”æ¨¡å¼ï¼‰ æ•°æ®ä»¥ åˆ¶è¡¨ç¬¦ åˆ†éš”ï¼Œé€‚åˆå¯¼å‡ºåˆ°æ–‡ä»¶å¹¶åœ¨ä»£ç æˆ–ç¼–è¾‘å™¨ä¸­å¤„ç†ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode tabssqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š1234567ID NAME AGE ADDRESS SALARY1 Paul 32 California 20000.02 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 6. insertï¼ˆINSERT æ¨¡å¼ï¼‰ æ•°æ®ä»¥ INSERT INTO è¯­å¥ çš„å½¢å¼è¾“å‡ºï¼Œæ–¹ä¾¿å°†æ•°æ®é‡æ–°å¯¼å…¥æ•°æ®åº“ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode insertsqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š123456INSERT INTO &quot;table&quot;(ID,NAME,AGE,ADDRESS,SALARY) VALUES(1,'Paul',32,'California',20000.0);INSERT INTO &quot;table&quot;(ID,NAME,AGE,ADDRESS,SALARY) VALUES(2,'Allen',25,'Texas',15000.0);INSERT INTO &quot;table&quot;(ID,NAME,AGE,ADDRESS,SALARY) VALUES(3,'Teddy',23,'Norway',20000.0);INSERT INTO &quot;table&quot;(ID,NAME,AGE,ADDRESS,SALARY) VALUES(4,'Mark',25,'Rich-Mond ',65000.0);INSERT INTO &quot;table&quot;(ID,NAME,AGE,ADDRESS,SALARY) VALUES(5,'David',27,'Texas',85000.0);INSERT INTO &quot;table&quot;(ID,NAME,AGE,ADDRESS,SALARY) VALUES(6,'Kim',22,'South-Hall',45000.0); 7. jsonï¼ˆJSON æ¨¡å¼ï¼‰ æ•°æ®ä»¥ JSON æ ¼å¼ è¾“å‡ºï¼Œé€‚åˆåœ¨å¼€å‘è¿‡ç¨‹ä¸­ä½¿ç”¨ï¼Œä¹Ÿéå¸¸é€‚åˆä¸å‰ç«¯ã€API äº¤äº’ï¼Œæˆ–è€…å¯¼å‡º JSON æ•°æ®ã€‚ å‘½ä»¤ï¼š12sqlite&gt; .mode jsonsqlite&gt; select * from company; è¾“å‡ºç¤ºä¾‹ï¼š123456[{&quot;ID&quot;:1,&quot;NAME&quot;:&quot;Paul&quot;,&quot;AGE&quot;:32,&quot;ADDRESS&quot;:&quot;California&quot;,&quot;SALARY&quot;:20000.0},{&quot;ID&quot;:2,&quot;NAME&quot;:&quot;Allen&quot;,&quot;AGE&quot;:25,&quot;ADDRESS&quot;:&quot;Texas&quot;,&quot;SALARY&quot;:15000.0},{&quot;ID&quot;:3,&quot;NAME&quot;:&quot;Teddy&quot;,&quot;AGE&quot;:23,&quot;ADDRESS&quot;:&quot;Norway&quot;,&quot;SALARY&quot;:20000.0},{&quot;ID&quot;:4,&quot;NAME&quot;:&quot;Mark&quot;,&quot;AGE&quot;:25,&quot;ADDRESS&quot;:&quot;Rich-Mond &quot;,&quot;SALARY&quot;:65000.0},{&quot;ID&quot;:5,&quot;NAME&quot;:&quot;David&quot;,&quot;AGE&quot;:27,&quot;ADDRESS&quot;:&quot;Texas&quot;,&quot;SALARY&quot;:85000.0},{&quot;ID&quot;:6,&quot;NAME&quot;:&quot;Kim&quot;,&quot;AGE&quot;:22,&quot;ADDRESS&quot;:&quot;South-Hall&quot;,&quot;SALARY&quot;:45000.0}] å››ã€è¿ç®—ç¬¦SQLite æä¾›äº†å¤šç§è¿ç®—ç¬¦ï¼Œç”¨äºæ•°æ®æ“ä½œã€ç­›é€‰å’Œè®¡ç®—ã€‚ä¸»è¦è¿ç®—ç¬¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š ç®—æœ¯è¿ç®—ç¬¦ æ¯”è¾ƒè¿ç®—ç¬¦ é€»è¾‘è¿ç®—ç¬¦ ä½è¿ç®—ç¬¦ 4.1 ç®—æœ¯è¿ç®—ç¬¦SQLite æ”¯æŒå¸¸è§çš„ã€Œç®—æœ¯è¿ç®—ç¬¦ã€ï¼Œç”¨äºåœ¨æŸ¥è¯¢è¯­å¥ä¸­è¿›è¡Œæ•°å­¦è¿ç®—ã€‚è¿™äº›è¿ç®—ç¬¦å¯ä»¥åœ¨ SELECT è¯­å¥ä¸­è®¡ç®—åˆ—å€¼ï¼Œä¹Ÿå¯ä»¥ç”¨äºæ›´æ–°æ“ä½œã€‚å¸¸è§çš„ç®—æœ¯è¿ç®—ç¬¦åŒ…æ‹¬ åŠ ã€å‡ã€ä¹˜ã€é™¤ å’Œ å–æ¨¡ã€‚ ç®—æ•°è¿ç®—ç¬¦ æè¿° ç¤ºä¾‹ å®ä¾‹ + åŠ æ³• 10 + 5 15 - å‡æ³• 10 - 5 5 * ä¹˜æ³• 10 * 5 50 / é™¤æ³• 10 / 5 2.0 % å–æ¨¡ï¼ˆæ±‚ä½™æ•°ï¼‰ 10 % 3 1 ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯¹å‰é¢çš„ COMPANY è¡¨è¿›è¡Œã€Œç®—æ•°è¿ç®—ç¬¦ã€çš„æ“ä½œï¼š 12345678910sqlite&gt; .mode columnsqlite&gt; select * from company;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.02 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 åŠ æ³•ï¼ˆ+ï¼‰ 12345678910# ç»™æ¯ä¸ªå‘˜å·¥çš„è–ªèµ„å¢åŠ  5000sqlite&gt; SELECT name, salary, salary + 5000 AS new_salary FROM company;NAME SALARY new_salary----- ------- ----------Paul 20000.0 25000.0Allen 15000.0 20000.0Teddy 20000.0 25000.0Mark 65000.0 70000.0David 85000.0 90000.0Kim 45000.0 50000.0 å‡æ³•ï¼ˆ-ï¼‰ 12345678910# ç»™æ¯ä¸ªå‘˜å·¥çš„è–ªèµ„å‡å°‘ 2000sqlite&gt; SELECT name, salary, salary - 2000 AS reduced_salary FROM company;NAME SALARY reduced_salary----- ------- --------------Paul 20000.0 18000.0Allen 15000.0 13000.0Teddy 20000.0 18000.0Mark 65000.0 63000.0David 85000.0 83000.0Kim 45000.0 43000.0 ä¹˜æ³•ï¼ˆ*ï¼‰ 12345678910# ç»™æ¯ä¸ªå‘˜å·¥çš„è–ªèµ„ç¿»å€sqlite&gt; SELECT name, salary, salary * 2 AS doubled_salary FROM company;NAME SALARY doubled_salary----- ------- --------------Paul 20000.0 40000.0Allen 15000.0 30000.0Teddy 20000.0 40000.0Mark 65000.0 130000.0David 85000.0 170000.0Kim 45000.0 90000.0 é™¤æ³•ï¼ˆ/ï¼‰ 12345678910# å°†å‘˜å·¥çš„å¹´è–ªé™¤ä»¥ 12ï¼Œè®¡ç®—æœˆè–ªsqlite&gt; SELECT name, salary / 12 AS monthly_salary FROM company;NAME monthly_salary----- ----------------Paul 1666.66666666667Allen 1250.0Teddy 1666.66666666667Mark 5416.66666666667David 7083.33333333333Kim 3750.0 å–æ¨¡ï¼ˆ%ï¼‰ 12345678910# è®¡ç®—æ¯ä¸ªå‘˜å·¥å¹´é¾„é™¤ä»¥ 2 çš„ä½™æ•°ï¼Œåˆ¤æ–­æ˜¯å¦ä¸ºå¶æ•°å¹´é¾„ï¼ˆä½™æ•°ä¸º 0ï¼‰sqlite&gt; SELECT id, name, age % 2 AS age_mod FROM company;ID NAME age_mod-- ----- -------1 Paul 02 Allen 13 Teddy 14 Mark 15 David 16 Kim 0 ç»“åˆ WHERE æ¡ä»¶ä½¿ç”¨ 123456# æŸ¥è¯¢æœˆè–ªå¤§äº 5000 çš„å‘˜å·¥sqlite&gt; SELECT * FROM company WHERE salary / 12 &gt; 5000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------4 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.0 4.2 æ¯”è¾ƒè¿ç®—ç¬¦ç”¨äºæ¯”è¾ƒä¸¤ä¸ªå€¼ï¼Œè¿”å› TRUE æˆ– FALSEã€‚ æ¯”è¾ƒè¿ç®—ç¬¦ æè¿° ç¤ºä¾‹ å®ä¾‹ = ç­‰äº age = 25 TRUE/FALSE != ä¸ç­‰äºï¼ˆSQLite ä¹Ÿæ”¯æŒ &lt;&gt;ï¼‰ age != 30 TRUE/FALSE &lt; å°äº age &lt; 25 TRUE/FALSE &gt; å¤§äº age &gt; 20 TRUE/FALSE &lt;= å°äºç­‰äº age &lt;= 25 TRUE/FALSE &gt;= å¤§äºç­‰äº age &gt;= 20 TRUE/FALSE ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯¹å‰é¢çš„ COMPANY è¡¨è¿›è¡Œã€Œæ¯”è¾ƒè¿ç®—ç¬¦ã€çš„æ“ä½œï¼š 12345678910sqlite&gt; .mode columnsqlite&gt; select * from company;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.02 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 åˆ—å‡º SALARY å¤§äº 50,000.00 çš„æ‰€æœ‰è®°å½• 12345sqlite&gt; SELECT * FROM COMPANY WHERE SALARY &gt; 50000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------4 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.0 åˆ—å‡º SALARY ç­‰äº 20,000.00 çš„æ‰€æœ‰è®°å½• 12345sqlite&gt; SELECT * FROM COMPANY WHERE SALARY = 20000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.03 Teddy 23 Norway 20000.0 åˆ—å‡º SALARY ä¸ç­‰äº 20,000.00 çš„æ‰€æœ‰è®°å½• 123456789101112131415sqlite&gt; SELECT * FROM COMPANY WHERE SALARY != 20000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------2 Allen 25 Texas 15000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0sqlite&gt; SELECT * FROM COMPANY WHERE SALARY &lt;&gt; 20000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------2 Allen 25 Texas 15000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 åˆ—å‡º SALARY å¤§äºç­‰äº 65,000.00 çš„æ‰€æœ‰è®°å½• 12345sqlite&gt; SELECT * FROM COMPANY WHERE SALARY &gt;= 65000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------4 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.0 4.3 é€»è¾‘è¿ç®—ç¬¦ç”¨äºè¿æ¥å¤šä¸ªæ¡ä»¶è¡¨è¾¾å¼ï¼Œè¿”å›å¸ƒå°”å€¼ã€‚ é€»è¾‘è¿ç®—ç¬¦ æè¿° ç¤ºä¾‹ å®ä¾‹ AND é€»è¾‘ä¸ age &gt; 20 AND salary &lt; 50000 TRUE/FALSE OR é€»è¾‘æˆ– age &lt; 25 OR salary &gt; 60000 TRUE/FALSE NOT é€»è¾‘é NOT age = 25 TRUE/FALSE IS NULL åˆ¤æ–­æ˜¯å¦ä¸º NULL address IS NULL TRUE/FALSE IS NOT NULL åˆ¤æ–­æ˜¯å¦ä¸ä¸º NULL address IS NOT NULL TRUE/FALSE LIKE æ¨¡ç³ŠåŒ¹é… name LIKE â€˜J%â€™ TRUE/FALSE GLOB å…¨å±€åŒ¹é…ï¼ˆåŒºåˆ†å¤§å°å†™ï¼‰ name GLOB â€˜J*â€™ TRUE/FALSE IN åˆ¤æ–­æ˜¯å¦åœ¨åˆ—è¡¨å†… age IN (22, 30) TRUE/FALSE BETWEEN åˆ¤æ–­æ˜¯å¦åœ¨èŒƒå›´å†… age BETWEEN 20 AND 30 TRUE/FALSE ä¾‹å¦‚ï¼šæˆ‘ä»¬å¯¹å‰é¢çš„ COMPANY è¡¨è¿›è¡Œã€Œé€»è¾‘è¿ç®—ç¬¦ã€çš„æ“ä½œï¼š 12345678910sqlite&gt; .mode columnsqlite&gt; select * from company;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.02 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 åˆ—å‡º AGE å¤§äºç­‰äº 25 ä¸”å·¥èµ„å¤§äºç­‰äº 65000.00 çš„æ‰€æœ‰è®°å½• 12345sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 AND SALARY &gt;= 65000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------4 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.0 åˆ—å‡º AGE å¤§äºç­‰äº 25 æˆ–å·¥èµ„å¤§äºç­‰äº 65000.00 çš„æ‰€æœ‰è®°å½• 1234567sqlite&gt; SELECT * FROM COMPANY WHERE AGE &gt;= 25 OR SALARY &gt;= 65000;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.02 Allen 25 Texas 15000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.0 åˆ—å‡º AGE ä¸ä¸º NULL çš„æ‰€æœ‰è®°å½•ï¼Œç»“æœæ˜¾ç¤ºæ‰€æœ‰çš„è®°å½•ï¼Œæ„å‘³ç€æ²¡æœ‰ä¸€ä¸ªè®°å½•çš„ AGE ç­‰äº NULL 123456789sqlite&gt; SELECT * FROM COMPANY WHERE AGE IS NOT NULL;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------1 Paul 32 California 20000.02 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.06 Kim 22 South-Hall 45000.0 åˆ—å‡º NAME ä»¥ â€˜Kiâ€™ å¼€å§‹çš„æ‰€æœ‰è®°å½•ï¼Œâ€™Kiâ€™ ä¹‹åçš„å­—ç¬¦ä¸åšé™åˆ¶ 123456789sqlite&gt; SELECT * FROM COMPANY WHERE NAME LIKE 'Ki%';ID NAME AGE ADDRESS SALARY-- ---- --- ---------- -------6 Kim 22 South-Hall 45000.0sqlite&gt; SELECT * FROM COMPANY WHERE NAME GLOB 'Ki*';ID NAME AGE ADDRESS SALARY-- ---- --- ---------- -------6 Kim 22 South-Hall 45000.0 åˆ—å‡º AGE çš„å€¼ä¸º 23 æˆ– 27 çš„æ‰€æœ‰è®°å½• 12345sqlite&gt; SELECT * FROM COMPANY WHERE AGE IN ( 23, 27 );ID NAME AGE ADDRESS SALARY-- ----- --- ------- -------3 Teddy 23 Norway 20000.05 David 27 Texas 85000.0 åˆ—å‡º AGE çš„å€¼åœ¨ 23 ä¸ 27 ä¹‹é—´çš„æ‰€æœ‰è®°å½• 1234567sqlite&gt; SELECT * FROM COMPANY WHERE AGE BETWEEN 23 AND 27;ID NAME AGE ADDRESS SALARY-- ----- --- ---------- -------2 Allen 25 Texas 15000.03 Teddy 23 Norway 20000.04 Mark 25 Rich-Mond 65000.05 David 27 Texas 85000.0 4.4 ä½è¿ç®—ç¬¦ç”¨äºå¯¹æ•´æ•°æ‰§è¡Œä½æ“ä½œã€‚ ä½è¿ç®—ç¬¦ æè¿° ç¤ºä¾‹ å®ä¾‹ &amp; æŒ‰ä½ä¸å¦‚æœåŒæ—¶å­˜åœ¨äºä¸¤ä¸ªæ“ä½œæ•°ä¸­ï¼ŒäºŒè¿›åˆ¶ AND è¿ç®—ç¬¦å¤åˆ¶ä¸€ä½åˆ°ç»“æœä¸­ 60 &amp; 13 12 | æŒ‰ä½æˆ–å¦‚æœå­˜åœ¨äºä»»ä¸€æ“ä½œæ•°ä¸­ï¼ŒäºŒè¿›åˆ¶ OR è¿ç®—ç¬¦å¤åˆ¶ä¸€ä½åˆ°ç»“æœä¸­ 60 | 13 61 ~ æŒ‰ä½å–åäºŒè¿›åˆ¶è¡¥ç è¿ç®—ç¬¦æ˜¯ä¸€å…ƒè¿ç®—ç¬¦ï¼Œå…·æœ‰â€ç¿»è½¬â€ä½æ•ˆåº”ï¼Œå³ 0 å˜æˆ 1ï¼Œ1 å˜æˆ 0 ~60 -61 &lt;&lt; äºŒè¿›åˆ¶å·¦ç§»è¿ç®—ç¬¦å·¦æ“ä½œæ•°çš„å€¼å‘å·¦ç§»åŠ¨å³æ“ä½œæ•°æŒ‡å®šçš„ä½æ•° 60 &lt;&lt; 2 240 &lt;&lt; äºŒè¿›åˆ¶å³ç§»è¿ç®—ç¬¦å·¦æ“ä½œæ•°çš„å€¼å‘å³ç§»åŠ¨å³æ“ä½œæ•°æŒ‡å®šçš„ä½æ•° 60 &gt;&gt; 2 15 å‡è®¾å¦‚æœ A = 60ï¼Œä¸” B = 13ï¼Œç°åœ¨ä»¥äºŒè¿›åˆ¶æ ¼å¼ï¼Œå®ƒä»¬å¦‚ä¸‹æ‰€ç¤ºï¼š 123456789101112A = 0011 1100B = 0000 1101-----------------A &amp; B = 0000 1100A | B = 0011 1101~ A = 1100 0011-----------------A &lt;&lt; 20011 1100 --&gt; å·¦ç§»ä¸¤ä½ --&gt; 1111 0000 -&gt; 240-----------------A &gt;&gt; 20011 1100 --&gt; å³ç§»ä¸¤ä½ --&gt; 0000 1111 -&gt; 15","link":"/2024/04/01/%E6%95%B0%E6%8D%AE%E5%BA%93%20--%20SQLite%20--%20%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E7%B2%BE%E9%80%9A/"},{"title":"è§£æ mutableStateOf æºç ","text":"å…¶å®åŸç†æ€§åˆ†æçš„æ–‡ç« ï¼ŒçœŸçš„å¾ˆéš¾è®²çš„é€šä¿—æ˜“æ‡‚ï¼Œè®²çš„ç®€å•æµ…æ˜¾æ²¡å¿…è¦å†™ï¼Œè®²çš„ç¹çéš¾æ‡‚å¾€å¾€å¤§å®¶ä¹Ÿä¸ä¹æ„çœ‹ï¼Œæ‰€ä»¥æ€ä¹ˆæ‰¾ä¸ªå¥½çš„è§’åº¦æ…¢æ…¢é’»è¿›å»å°¤ä¸ºé‡è¦ï¼Œæ¯”å¦‚ï¼šBegin simple codeï¼Œå¦‚æœç¡®å®èƒ½å¸®åŠ©åˆ°å¤§å®¶å®Œå…¨ç†è§£äº†æ–‡ç« æ‰€è®²è¿°åˆ°çš„æºç ç†è®ºï¼Œé‚£å°±ç‚¹ä¸ªèµå§ï¼ å¼•å…¥è¯é¢˜ æ­£å¦‚æˆ‘ä¸Šé¢è¯´çš„ï¼Œç›´æ¥è®²åŸç†å¤ªæ¯ç‡¥ï¼ˆä½ ä¹Ÿä¼šå¾ˆæ‡µï¼‰ï¼Œæˆ‘å–œæ¬¢ä»ç®€å•ä»£ç å…¥æ‰‹ï¼Œå¸¦ä½ ä¸€ç‚¹ç‚¹è¿›å…¥ï¼Œç°åœ¨å¼€å§‹ã€‚å…ˆçœ‹ä¸€ä¸ªæœ€ç®€å•çš„ä»£ç ç¤ºä¾‹ï¼š 1234567891011121314class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) // è¿™ç§å®šä¹‰å˜é‡çš„æ–¹å¼éšå¤„å¯è§äº† val name = mutableStateOf(&quot;Compose&quot;) setContent { ComposeBlogTheme { Text(name.value) } } }} æˆ‘å…ˆæ¥ç®€å•è§£è¯»ä¸€ä¸‹è¿™æ®µä»£ç çš„åŸç†ï¼š å½“æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå˜é‡ï¼Œç”¨ mutableStateOf åŒ…èµ·æ¥åï¼Œå®ƒå°±å˜æˆäº†ä¸€ä¸ª MutableState ç±»å‹çš„å¯¹è±¡ã€‚ åŒæ—¶ï¼Œæˆ‘ä»¬å–å€¼çš„è¯å°±å¿…é¡»è¦å†™ name.valueï¼Œè¿™æ ·èƒ½æ‰èƒ½å–åˆ° â€œComposeâ€ï¼Œå› ä¸ºname ä¸å†æ˜¯ä¸€ä¸ª Stringï¼Œè€Œæ˜¯ MutableState å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥å«â€œçŠ¶æ€â€ ã€‚ æ­¤æ—¶ï¼Œname æ˜¯ä¸€ä¸ªè¢«è®¢é˜…çš„çŠ¶æ€ï¼Œname.value å°±æ˜¯ä¸€ä¸ªè¢«è®¢é˜…çš„å€¼ï¼Œå¦‚æœå®ƒå‘ç”Ÿå˜åŒ–ï¼ŒText() å‡½æ•°å°±ä¼šé‡æ–°æ‰§è¡Œä¸€éï¼Œæ›´æ–°åˆ°æœ€æ–°çš„å€¼ã€‚ ç°åœ¨æˆ‘ä»¬ä¿®æ”¹ä¸‹ä»£ç ï¼Œ3s åæ”¹å˜ name.value çš„å€¼ï¼š 123456789101112131415161718class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) val name = mutableStateOf(&quot;Compose&quot;) setContent { ComposeBlogTheme { Text(name.value) } LaunchedEffect(true) { delay(3000) // 3s å»¶è¿Ÿ name.value = &quot;Kotlin&quot; // ä¿®æ”¹ name.value } } }} è¿è¡Œä¸‹ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/141782121dd4b200a5d4e86a30eb3edf.gif =400x) ç°åœ¨å…³äº mutableStateOf çš„ç”¨æ³•ä½ å·²ç»æŒæ¡äº†ï¼Œä½†åŒæ—¶å°±ä¼šäº§ç”Ÿäº†ä¸€ä¸ªç–‘é—®ï¼Œname è¢«è‡ªåŠ¨è®¢é˜…äº†ï¼Œå®ƒçš„å€¼æ”¹å˜äº†å°±ä¼šè®©ç•Œé¢é‡æ–°åˆ·æ–°ï¼Œè¿™èƒŒåçš„â€œçŠ¶æ€è®¢é˜…&amp;åˆ·æ–°æœºåˆ¶â€çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿ å¦‚æœä½ æƒ³æ·±å…¥äº†è§£ï¼Œé‚£ä¹ˆæ¥ç€å¾€ä¸‹çœ‹ã€‚ çŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–° åŸºäº androidx.compose.runtime:runtime:1.4.0 ç‰ˆæœ¬ ç¡¬æ ¸éƒ¨åˆ†èµ°èµ·ï¼ŒæŸ¥çœ‹ mutableStateOf() æºç ï¼š 1234fun &lt;T&gt; mutableStateOf( value: T, policy: SnapshotMutationPolicy&lt;T&gt; = structuralEqualityPolicy()): MutableState&lt;T&gt; = createSnapshotMutableState(value, policy) mutableStateOf() è¿”å›çš„æ˜¯ä¸€ä¸ª MutableState å¯¹è±¡ï¼Œè¿™ä¸ªæˆ‘ä»¬å‰é¢è¯´è¿‡ã€‚ mutableStateOf() åˆè°ƒç”¨äº†å¦ä¸€ä¸ªå‡½æ•°ï¼š**createSnapshotMutableState()**ã€‚ è¿›å…¥ **createSnapshotMutableState()**ï¼š 1234internal actual fun &lt;T&gt; createSnapshotMutableState( value: T, policy: SnapshotMutationPolicy&lt;T&gt;): SnapshotMutableState&lt;T&gt; = ParcelableSnapshotMutableState(value, policy) åˆè°ƒç”¨äº† ParcelableSnapshotMutableState() å‡½æ•°ï¼š 1234567internal class ParcelableSnapshotMutableState&lt;T&gt;( value: T, policy: SnapshotMutationPolicy&lt;T&gt;) : SnapshotMutableStateImpl&lt;T&gt;(value, policy), Parcelable { // è¿™é‡Œå†…éƒ¨çš„ä»£ç å…¨éƒ¨éƒ½æ˜¯å¯¹ Parcelable æ¥å£çš„å®ç°ï¼Œæˆ‘ä»¬ä¸ç”¨å…³å¿ƒï¼Œä¸æ˜¯æ ¸å¿ƒå†…å®¹ ... ...} å…³é”®åœ¨ SnapshotMutableStateImplï¼Œå®ƒé‡Œé¢æ‰æ˜¯æœ€æ ¸å¿ƒçš„é€»è¾‘ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788internal open class SnapshotMutableStateImpl&lt;T&gt;( value: T, override val policy: SnapshotMutationPolicy&lt;T&gt;) : StateObject, SnapshotMutableState&lt;T&gt; { @Suppress(&quot;UNCHECKED_CAST&quot;) override var value: T get() = next.readable(this).value set(value) = next.withCurrent { if (!policy.equivalent(it.value, value)) { next.overwritable(this, it) { this.value = value } } } private var next: StateStateRecord&lt;T&gt; = StateStateRecord(value) override val firstStateRecord: StateRecord get() = next override fun prependStateRecord(value: StateRecord) { @Suppress(&quot;UNCHECKED_CAST&quot;) next = value as StateStateRecord&lt;T&gt; } @Suppress(&quot;UNCHECKED_CAST&quot;) override fun mergeRecords( previous: StateRecord, current: StateRecord, applied: StateRecord ): StateRecord? { val previousRecord = previous as StateStateRecord&lt;T&gt; val currentRecord = current as StateStateRecord&lt;T&gt; val appliedRecord = applied as StateStateRecord&lt;T&gt; return if (policy.equivalent(currentRecord.value, appliedRecord.value)) current else { val merged = policy.merge( previousRecord.value, currentRecord.value, appliedRecord.value ) if (merged != null) { appliedRecord.create().also { (it as StateStateRecord&lt;T&gt;).value = merged } } else { null } } } override fun toString(): String = next.withCurrent { &quot;MutableState(value=${it.value})@${hashCode()}&quot; } private class StateStateRecord&lt;T&gt;(myValue: T) : StateRecord() { override fun assign(value: StateRecord) { @Suppress(&quot;UNCHECKED_CAST&quot;) this.value = (value as StateStateRecord&lt;T&gt;).value } override fun create(): StateRecord = StateStateRecord(value) var value: T = myValue } /** * The componentN() operators allow state objects to be used with the property destructuring * syntax * * ``` * var (foo, setFoo) = remember { mutableStateOf(0) } * setFoo(123) // set * foo == 123 // get * ``` */ override operator fun component1(): T = value override operator fun component2(): (T) -&gt; Unit = { value = it } /** * A function used by the debugger to display the value of the current value of the mutable * state object without triggering read observers. */ @Suppress(&quot;unused&quot;) val debuggerDisplayValue: T @JvmName(&quot;getDebuggerDisplayValue&quot;) get() = next.withCurrent { it }.value} å¥½é•¿å•Šï½ç®—äº†ï¼Œä¸çœ‹äº†ğŸ™ˆâ€¦ æ¥ä¸‹æ¥æˆ‘å¸¦ä½ ä¸€æ­¥æ­¥æ¢ç´¢å…¶ä¸­çš„å¥¥ç§˜ï¼ å…ˆçœ‹å¼€å¤´éƒ¨åˆ†ï¼š 12345678910111213141516171819internal open class SnapshotMutableStateImpl&lt;T&gt;( value: T, override val policy: SnapshotMutationPolicy&lt;T&gt;) : StateObject, SnapshotMutableState&lt;T&gt; { @Suppress(&quot;UNCHECKED_CAST&quot;) override var value: T get() = next.readable(this).value set(value) = next.withCurrent { if (!policy.equivalent(it.value, value)) { next.overwritable(this, it) { this.value = value } } } private var next: StateStateRecord&lt;T&gt; = StateStateRecord(value) override val firstStateRecord: StateRecord get() = next ... ...} ä¸€ä¸ª value å±æ€§å°å…¥çœ¼å¸˜ï¼Œè¿™å°±æ˜¯æ–‡ç« å¼€å¤´ä»£ç é‡Œé¢ç”¨åˆ°çš„ name.valueã€‚ value æœ‰ get() å’Œ set() å‡½æ•°ï¼Œå¹¶ä¸”éƒ½æœ‰å…·ä½“çš„å®ç°ã€‚ ğŸ““ next æ˜¯ä¸ªå•¥ï¼Ÿ æ— è®ºæ˜¯ get() è¿˜æ˜¯ set() éƒ½æœ‰ä¸€ä¸ª nextã€‚ 12get() = next.readable(this).valueset(value) = next.withCurrent {...} å®ƒæ˜¯ä¸ªå•¥ï¼Ÿæˆ‘ä»¬å¾—å…ˆææ˜ç™½è¿™ä¸ªã€‚ 1private var next: StateStateRecord&lt;T&gt; = StateStateRecord(value) å®ƒçš„ç±»å‹æ˜¯ StateStateRecordï¼Œé‚£ StateStateRecord æœ‰æ˜¯ä¸ªå•¥ï¼Ÿ 12345678910private class StateStateRecord&lt;T&gt;(myValue: T) : StateRecord() { override fun assign(value: StateRecord) { @Suppress(&quot;UNCHECKED_CAST&quot;) this.value = (value as StateStateRecord&lt;T&gt;).value } override fun create(): StateRecord = StateStateRecord(value) var value: T = myValue} StateStateRecord ç»§æ‰¿äº† StateRecordï¼Œé‚£ StateRecord åˆæ˜¯ä¸ªå•¥å‘¢ï¼Ÿ 123456abstract class StateRecord { internal var snapshotId: Int = currentSnapshot().id // è®°å½•å¿«ç…§ id internal var next: StateRecord? = null // ä¸‹ä¸€ä¸ªçŠ¶æ€è®°å½•çš„å¼•ç”¨ï¼ŒçŠ¶æ€è®°å½•å­˜å‚¨åœ¨ä¸€ä¸ªé“¾è¡¨ä¸­ abstract fun assign(value: StateRecord) // å¤åˆ¶ StateRecord abstract fun create(): StateRecord // åˆ›å»ºä¸€ä¸ªæ–°çš„è®°å½•ç›¸åŒçš„ StateRecord} ä½ åªè¦çŸ¥é“ StateRecord æ˜¯ä¸€ä¸ªé“¾è¡¨çš„æ•°æ®ç»“æ„å³å¯ï¼Œè€Œ StateStateRecord å®ç°äº†å®ƒï¼Œå¹¶ä¸”å°† value è¿›è¡Œäº†å°è£…ã€‚ ä¸‹é¢æˆ‘ä»¬è¦è®²åˆ«çš„äº†ï¼Œå…ˆè®°ä½ï¼šStateRecord æ˜¯ä¸€ä¸ªé“¾è¡¨çš„æ•°æ®ç»“æ„ï¼ æ¥ç€è¯´ï¼Œå¦‚æœä½ ä»”ç»†çœ‹ä»£ç çš„è¯ï¼Œä¼šå‘ç° SnapshotMutableStateImpl å…¶å®ç»§æ‰¿äº†ä¸¤ä¸ªæ¥å£ï¼š 123456internal open class SnapshotMutableStateImpl&lt;T&gt;( value: T, override val policy: SnapshotMutationPolicy&lt;T&gt;) : StateObject, SnapshotMutableState&lt;T&gt; { ... ...} ä¸€ä¸ª StateObjetã€ä¸€ä¸ª SnapshotMutableStateã€‚ æˆ‘ä»¬å…ˆæ¥çœ‹ä¸‹ SnapshotMutableStateï¼š 123456interface SnapshotMutableState&lt;T&gt; : MutableState&lt;T&gt; { /** * A policy to control how changes are handled in a mutable snapshot. */ val policy: SnapshotMutationPolicy&lt;T&gt;} SnapshotMutableState ç»§æ‰¿äº† MutableStateï¼Œæ­£å¥½å¯¹åº”ç€æˆ‘ä»¬æ–‡ç« å¼€å¤´è¯´çš„ï¼ŒmutableStateOf() è¿”å›çš„å°±æ˜¯ä¸€ä¸ª MutableStateï¼Œæˆ‘ä»¬è¯´æ˜¯å› ä¸ºå®ƒå®ç°äº†è®¢é˜…ä»è€Œå¯ä»¥åˆ·æ–°ï¼Œä½†ï¼ï¼ï¼çœŸæ­£çš„åŸå› å¹¶ä¸æ˜¯å› ä¸ºå®ƒï¼ çœŸæ­£å®ç°çŠ¶æ€è®¢é˜…æœºåˆ¶çš„æ˜¯å¦å¤–ä¸€ä¸ªæ¥å£ï¼šStateObjetï¼ æˆ‘ä»¬ç°åœ¨æ¥çœ‹ä¸‹ StateObject è¿™ä¸ªå¤§ä½¬å¹²äº†ä»€ä¹ˆäº‹ï¼š 1234567891011121314interface StateObject { /** * The first state record in a linked list of state records. */ val firstStateRecord: StateRecord fun prependStateRecord(value: StateRecord) fun mergeRecords( previous: StateRecord, current: StateRecord, applied: StateRecord ): StateRecord? = null} ä»£ç éå¸¸ç®€å•ï¼Œä½†é‡Œé¢æœ‰ä¸€ä¸ªæ ¸å¿ƒï¼š 1val firstStateRecord: StateRecord å®ƒæ˜¯å¹²å˜›ç”¨çš„ï¼Ÿæˆ‘ä»¬å»ç…ç…å“ªé‡Œç”¨äº†å®ƒï¼š 1234private var next: StateStateRecord&lt;T&gt; = StateStateRecord(value) override val firstStateRecord: StateRecord get() = next å“¦ï¼ŒåŸæ¥ firstStateRecord æ˜¯ç”¨æ¥è®°å½• StateRecord è¿™ä¸ªé“¾è¡¨çš„ å¤´èŠ‚ç‚¹ ç”¨çš„ã€‚ ğŸ““ get() ä¸Šé¢åº”è¯¥ç®—æ˜¯æŠŠ next æ˜¯ä»€ä¹ˆè®²æ¸…æ¥šäº†å§ï¼Ÿâ€“ å®ƒå°±æ˜¯ StateRecordï¼Œæ›´å‡†ç¡®çš„è¯´å°±æ˜¯ StateRecord é“¾è¡¨çš„å¤´èŠ‚ç‚¹ã€‚ ä¸‹é¢æˆ‘ä»¬å¼€å§‹æ‰’æ‰’ get() å…·ä½“çš„é€»è¾‘äº†ã€‚ 1get() = next.readable(this).value è¿›å…¥ readable() ï¼š 1234567891011fun &lt;T : StateRecord&gt; T.readable(state: StateObject): T { val snapshot = Snapshot.current // ç¬¬ä¸€ä»¶äº‹ snapshot.readObserver?.invoke(state) // ç¬¬äºŒä»¶äº‹ return readable(this, snapshot.id, snapshot.invalid) ?: sync { val syncSnapshot = Snapshot.current @Suppress(&quot;UNCHECKED_CAST&quot;) readable(state.firstStateRecord as T, syncSnapshot.id, syncSnapshot.invalid) ?: readError() }} å¹²äº†ä¸¤ä»¶äº‹ï¼Œç¬¬ä¸€ä»¶äº‹ï¼š 1snapshot.readObserver?.invoke(state) // ç¬¬ä¸€ä»¶äº‹ readObserver æ˜¯ä¸€ä¸ªè¯»æ“ä½œçš„è§‚å¯Ÿè€…ï¼Œè¿™ä¸ªæ“ä½œæ˜¯è®°å½• StateObject ä¸­çš„å€¼è¢«å“ªé‡Œè°ƒç”¨äº†ï¼Œæ¯”å¦‚å¼€å¤´çš„ä»£ç ç¤ºä¾‹ï¼š 1234567891011121314151617181920class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) val name = mutableStateOf(&quot;Compose&quot;) setContent { ComposeBlogTheme { // è¿™é‡Œè°ƒç”¨äº† name.valueï¼Œå°±ä¼šæ‰§è¡Œåˆ°ï¼š // get() --&gt; readServer() --&gt; è®°å½•è¿™é‡Œè°ƒç”¨äº† value å€¼ Text(name.value) } LaunchedEffect(true) { delay(3000) name.value = &quot;Kotlin&quot; } } }} æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠè¿™ä¸ªæ“ä½œç†è§£ä¸ºå®ƒæ˜¯ä¸€ä¸ªè®¢é˜…æ“ä½œï¼šè®¢é˜…çŠ¶æ€ï¼Œè®°å½• name.value åœ¨å“ªé‡Œè°ƒç”¨äº†ã€‚ ç¬¬äºŒä»¶äº‹ï¼š 12345return readable(this, snapshot.id, snapshot.invalid) ?: sync { val syncSnapshot = Snapshot.current @Suppress(&quot;UNCHECKED_CAST&quot;) readable(state.firstStateRecord as T, syncSnapshot.id, syncSnapshot.invalid) ?: readError()} è°ƒç”¨äº†ä¸‰å‚æ•°çš„ readable()ï¼š 1234567891011121314151617private fun &lt;T : StateRecord&gt; readable(r: T, id: Int, invalid: SnapshotIdSet): T? { // The readable record is the valid record with the highest snapshotId var current: StateRecord? = r var candidate: StateRecord? = null while (current != null) { if (valid(current, id, invalid)) { candidate = if (candidate == null) current else if (candidate.snapshotId &lt; current.snapshotId) current else candidate } current = current.next } if (candidate != null) { @Suppress(&quot;UNCHECKED_CAST&quot;) return candidate as T } return null} å‰è¾¹æˆ‘ä»¬è¯´é”™ï¼šStateRecord æ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œä¸‰å‚æ•°é‡Œé¢çš„å·¥ä½œå°±æ˜¯é€šè¿‡è¡¨å¤´å¯¹è±¡éå†åˆ—è¡¨æ¥è·å– æœ€æ–°çš„ã€æœ‰æ•ˆçš„ StateRecordã€‚ æœ€ç»ˆè¿”å›ä¸€ä¸ª æœ€æ–°çš„ã€æœ‰æ•ˆçš„ StateRecordã€‚ï¼ˆä»€ä¹ˆæ˜¯æœ€æ–°çš„ã€æœ‰æ•ˆçš„ï¼Œè¿™ä¸ªå¯ä»¥ä¸ç”¨å…³å¿ƒï¼Œè¿™è·Ÿè¦ç»“åˆ Snapshot å¿«ç…§ç³»ç»Ÿè¯´ï¼Œä½ ç›´æ¥è¿‡æ»¤å³å¯ï¼Œä¸å½±å“æˆ‘ä»¬åŸç†çš„ç†è§£ï¼‰ æ‰€ä»¥ï¼Œæ•´ä¸ª readable() æ–¹æ³•å°±å¹²äº†ä¸¤ä»¶äº‹ï¼š è¿”å›æœ€æ–°çš„ã€æœ‰æ•ˆçš„ StateRecord è®°å½•åœ¨å“ªé‡Œè°ƒç”¨äº† value 1get() = next.readable(this).value æœ€åè¿˜å‰©ä¸€ä¸ª valueï¼Œè¿™å°±å¾ˆç®€å•äº†ï¼Œå‰é¢æˆ‘ä»¬è¯´è¿‡ StateStateRecord (StateRecord çš„å®ç°ç±») ä¼šå¯¹ value è¿›è¡Œå°è£…ï¼Œè€Œ StateRecord å®ƒä»¬åªæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œæˆ‘ä»¬è¦è·å–åˆ°å€¼ï¼Œå°±è¦å†è°ƒç”¨ value è·å–å†…éƒ¨è¢«åŒ…ç€çš„å€¼ã€‚ åˆ°è¿™é‡Œ get() å°±è®²å®Œäº†ï¼ ğŸ““ set() ç°åœ¨æ¥çœ‹ set() çš„å…·ä½“ä»£ç ï¼šï¼ˆç»†èŠ‚ç‚¹æ³¨æ„ï¼šè¿™è¾¹æˆ‘æŠŠä»£ç æˆªå›¾äº†ï¼Œè€Œä¸æ˜¯çº¯ä»£ç æ®µï¼Œä½ ç•™æ„ä¸€ä¸‹ï¼Œä¸‹é¢ä¼šå›å½’åˆ°è¿™é‡Œï¼‰ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/548aff88360d4dffda83386ed2ee80e3.png =500x) next æ˜¯å•¥ä¸ç”¨è¯´äº†å§ï¼Œé‚£ withCurrent æ˜¯ä»€ä¹ˆï¼Ÿ 12inline fun &lt;T : StateRecord, R&gt; T.withCurrent(block: (r: T) -&gt; R): R = block(current(this, Snapshot.current)) å®ƒåªæœ‰ä¸€ä¸ªå‚æ•° blockï¼Œè€Œ block æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œå®ƒçš„å·¥ä½œå¾ˆç›´æ¥ï¼Œç›´æ¥è°ƒç”¨è¿™ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ withCurrent åé¢è·Ÿç€çš„ Lambda è¡¨è¾¾å¼ã€‚ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/63c3c244bd0959768487d28c00ed08ca.png =500x) block é‡Œé¢ä¼ å…¥äº†ä¸€ä¸ª current å‡½æ•°ï¼Œå®ƒåšäº†ä»€ä¹ˆï¼š 12internal fun &lt;T : StateRecord&gt; current(r: T, snapshot: Snapshot) = readable(r, snapshot.id, snapshot.invalid) ?: readError() å‘ç°äº†ä»€ä¹ˆï¼Ÿå®ƒè°ƒç”¨äº†ä¸€ä¸ªä¸‰å‚æ•°çš„ readable()ï¼Œä½ è¿˜è®°å¾—ä¸‰å‚æ•°çš„ readable() æ˜¯åšä»€ä¹ˆçš„å—ï¼Ÿ â‡’ è·å– æœ€æ–°çš„ã€æœ‰æ•ˆçš„ StateRecordã€‚ è¿™ä¸ªæ—¶å€™ä½ åœ¨çœ‹ä¸‹æˆ‘å¼€å¤´ä¸ºå•¥å¯¹ä»£ç åšäº†æˆªå›¾ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/df81d16a784a74cbb297037fdce6eda0.png =500x) æ‡‚å•¥æ„æ€æ²¡ï¼ŸwithCurrent ä¼ å…¥çš„ current å‡½æ•°çš„è¿”å›å€¼å°±å¯¹åº”ç€ä»£ç æç¤ºå™¨æç¤ºçš„ it å¯¹è±¡ï¼ˆä¸€ä¸ª StateStateRecordï¼‰ã€‚ æ¥ç€çœ‹ä»£ç ï¼š 123456set(value) = next.withCurrent { // åˆ¤æ–­æ–°æ—§å€¼ if (!policy.equivalent(it.value, value)) { next.overwritable(this, it) { this.value = value } }} if åˆ¤æ–­é‡Œé¢ä¼šåˆ¤æ–­å–åˆ°çš„ StateRecord çš„å€¼å’Œæ–°è®¾ç½®çš„å€¼æ˜¯å¦ç›¸åŒï¼Œæ²¡å˜ç›´æ¥ç»“æŸï¼Œå˜äº†å°±è¿›å…¥ä¸‹ä¸€æ­¥ overwritable()ã€‚ æˆ‘ä»¬çœ‹çœ‹å®ƒåšäº†ä»€ä¹ˆï¼š 123456789101112131415internal inline fun &lt;T : StateRecord, R&gt; T.overwritable( state: StateObject, candidate: T, block: T.() -&gt; R): R { var snapshot: Snapshot = snapshotInitializer return sync { // ç¬¬ä¸€ä»¶äº‹ snapshot = Snapshot.current // ç¬¬äºŒä»¶äº‹ this.overwritableRecord(state, snapshot, candidate).block() }.also { notifyWrite(snapshot, state) }} ä¹Ÿå¹²äº†ä¸¤ä»¶äº‹ï¼š è·å–å¿«ç…§ï¼›2. è°ƒç”¨äº†overwritableRecord() å‡½æ•°ï¼› Snapshot å¿«ç…§çš„çŸ¥è¯†æˆ‘ä»¬å¯ä»¥å…ˆå¿½ç•¥ï¼Œæ¥çœ‹ overwritableRecord() åšäº†ä»€ä¹ˆï¼š 12345678910111213141516171819internal fun &lt;T : StateRecord&gt; T.overwritableRecord( state: StateObject, snapshot: Snapshot, candidate: T): T { if (snapshot.readOnly) { snapshot.recordModified(state) } val id = snapshot.id if (candidate.snapshotId == id) return candidate val newData = newOverwritableRecord(state) newData.snapshotId = id snapshot.recordModified(state) return newData} è¿™æ®µä»£ç åˆæ¶‰åŠåˆ°äº†å¦å¤–ä¸€ä¸ªçŸ¥è¯†ç‚¹ï¼šSnapshotï¼ˆå¿«ç…§ï¼‰ã€‚ æˆ‘ä»¬å°†ä»£ç åˆ†ä¸ºä¸¤ç«¯æ¥çœ‹ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/9b9068d1ad9357f3b556a0a502884f0c.png =700x) æ ¸å¿ƒä»£ç å— 1ï¼šå¦‚æœä¼ è¿›æ¥çš„ StateRecord çš„å¿«ç…§ id æ­£å¥½å¯¹åº”å½“å‰ snapshot çš„ idï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ã€‚ æ ¸å¿ƒä»£ç å— 2ï¼šå¦åˆ™ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æˆ–è€…è¿”å›ä¸€ä¸ªå¼ƒç”¨çš„ StateRecordï¼Œç„¶åå°†å¿«ç…§ id èµ‹äºˆæ–°çš„ StateRecordã€‚ è¯´ç™½äº†æœ€ç»ˆå°±æ˜¯è¦å–åˆ°ä¸€ä¸ªå¯¹åº”å½“å‰ snapshot çš„ StateRecordï¼ ğŸ¤” æ­¤æ—¶å°±å­˜åœ¨ä¸€ä¸ªå¾ˆå¤§çš„ç–‘é—®äº†ï¼Ÿä»€ä¹ˆæ˜¯ Snapshotï¼ˆå¿«ç…§ï¼‰ï¼ŸSnapshot æ€ä¹ˆå’Œ StateRecord ç»‘åœ¨ä¸€èµ·äº†ï¼Ÿ å…³äº Compose çš„ Snapshot æœºåˆ¶ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç«  æ­ç§˜ Jetpack Composeå¿«ç…§ç³»ç»Ÿ ï¼Œè®²çš„å¾ˆå¥½ã€‚ ä½†ç”±äº Snapshot çœŸçš„ä¸æ˜¯ä¸€ä¸¤å¥å°±èƒ½è¯´æ¸…æ¥šçš„ï¼Œä½†æˆ‘ä»ç„¶å‘Šè¯‰ä½ å®ƒä¸å½±å“ä½ å¯¹è¿™ç¯‡æ–‡ç« åŸç†çš„ç†è§£ã€‚ ç»§ç»­å›åˆ°ä»£ç ï¼š 1234567891011121314internal inline fun &lt;T : StateRecord, R&gt; T.overwritable( state: StateObject, candidate: T, block: T.() -&gt; R): R { var snapshot: Snapshot = snapshotInitializer return sync { snapshot = Snapshot.current // å–åˆ°ä¸€ä¸ªå¯¹åº”å½“å‰ snapshot çš„ StateRecord this.overwritableRecord(state, snapshot, candidate).block() }.also { notifyWrite(snapshot, state) }} å–åˆ°å¯¹åº”å½“å‰ snapshot çš„ StateRecord åï¼Œç´§æ¥ç€è°ƒç”¨äº† block()ï¼Œå®ƒæ˜¯ä¼ è¿›æ¥çš„å‚æ•°ï¼Œæ˜¯å¤–é¢ä¼ è¿›æ¥çš„ï¼Œä¹Ÿå°±æ˜¯ {this.value = value}ã€‚ 123456set(value) = next.withCurrent { // åˆ¤æ–­æ–°æ—§å€¼ if (!policy.equivalent(it.value, value)) { next.overwritable(this, it) { this.value = value } }} åˆæ‹å›æ¥äº†ï¼ŒæŠŠä¼ å…¥çš„æ–°å€¼èµ‹å€¼ç»™æ‹¿åˆ°çš„ StateRecord å†…éƒ¨çš„ valueï¼Œè¿™ä¸å°±æ˜¯å†™æ–°å€¼çš„æ“ä½œä¹ˆï¼Ÿ åˆ°è¿™é‡Œæ˜¯ä¸æ˜¯ set() æµç¨‹æ˜¯ä¸æ˜¯æˆ‘ä»¬å°±è®²å®Œäº†ï¼Ÿ Noï½ï¼Œæˆ‘ä»¬å†çœ‹ä¸€ä¸‹ overwritable() æ–¹æ³•å†…éƒ¨ï¼š 1234567891011121314internal inline fun &lt;T : StateRecord, R&gt; T.overwritable( state: StateObject, candidate: T, block: T.() -&gt; R): R { var snapshot: Snapshot = snapshotInitializer return sync { snapshot = Snapshot.current // è¿™é‡Œè®²å®Œäº† this.overwritableRecord(state, snapshot, candidate).block() }.also { notifyWrite(snapshot, state) // ä½†è¿™é‡Œè¿˜æœ‰ä¸ª notifyWrite }} è¿˜æœ‰ä¸€è¡Œæˆ‘ä»¬é—æ¼äº†ï¼ŒnotifyWrite() åˆåšäº†ä»€ä¹ˆï¼Ÿ 123internal fun notifyWrite(snapshot: Snapshot, state: StateObject) { snapshot.writeObserver?.invoke(state)} æœ‰ç§ä¼¼æ›¾ç›¸è¯†çš„æ„Ÿè§‰ï¼Œåœ¨å‰é¢åˆ†æ get() å‡½æ•°çš„æ—¶å€™ï¼Œæˆ‘ä»¬çœ‹åˆ°è¿‡å•å‚æ•°çš„ readable() é‡Œé¢æœ‰ä¸€è¡Œï¼š 1snapshot.readObserver?.invoke(state) é‚£è¿™é‡Œçš„ä½œç”¨å‘¢ï¼Ÿ â‡’ å¯»æ‰¾å˜é‡åœ¨å“ªé‡Œè¢«è¯»äº†ï¼Œç„¶åå°†è¿™éƒ¨åˆ†å†…å®¹çš„ç»„åˆæ ‡è®°ä¸ºå¤±æ•ˆï¼Œç­‰åˆ°ä¸‹ä¸€å¸§çš„æ—¶å€™ä¼šé‡ç»„åˆ·æ–°ã€‚ æ‰€ä»¥ï¼Œæ•´ä¸ª set() æ–¹æ³•å°±å¹²äº†ä¸¤ä»¶äº‹ï¼š å°†ä¼ å…¥çš„å€¼èµ‹å€¼ç»™ StateRecord å†…éƒ¨çš„ value å†™å…¥é€šçŸ¥åˆ·æ–° åˆ°è¿™é‡Œæˆ‘ä»¬å°±åŸºæœ¬ä¸Šèƒ½å¤Ÿå¾ˆæ¸…æ™°çš„æ˜ç™½äº†çŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°æœºåˆ¶çš„åŸç†äº†ï¼š å½“ get() è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¸ä»…è¿”å›å€¼ï¼Œè¿˜ä¼šè®°å½•è¯»å€¼çš„åœ°æ–¹ï¼Œä¹Ÿå°±æ˜¯å“ªé‡Œè°ƒç”¨äº†ï¼ˆç›¸å½“äºè®¢é˜…ï¼‰ã€‚ å½“ set() è¢«è°ƒç”¨çš„æ—¶å€™ï¼Œä¸ä»…ä¿®æ”¹å€¼ï¼Œè¿˜ä¼šæŸ¥æ‰¾è¯»å€¼çš„åœ°æ–¹ï¼Œç„¶åè¿›è¡Œåˆ·æ–°æ“ä½œï¼ˆç›¸å½“äºé€šçŸ¥ï¼‰ã€‚ ğŸ““ by åœ¨å®é™…å¼€å‘ä¸­ï¼Œå¦‚æœæ¯æ¬¡è·å–å€¼éƒ½è¦åŠ ä¸Š value ä¼šæ˜¾å¾—å¾ˆå†—ä½™ï¼Œæ‰€ä»¥ Compose ç»™æˆ‘ä»¬æä¾›äº†ä¸€ç§æ›´æ–¹ä¾¿çš„å†™æ³•ï¼šbyã€‚å®ƒæ˜¯ Kotlin çš„ä¸€ä¸ªå…³é”®å­—ï¼Œè¡¨ç¤ºå·¦è¾¹çš„å˜é‡ç”¨å³è¾¹çš„å¯¹è±¡ä½œä¸ºä»£ç†ï¼ˆå§”æ‰˜ï¼‰ã€‚ 12345678910111213class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) val name by mutableStateOf(&quot;Compose&quot;) setContent { ComposeBlogTheme { Text(name) // å¯ä»¥ç›´æ¥ nameï¼Œè€Œä¸éœ€è¦ name.value } } }} å¦‚æœä½ è¿™ä¹ˆå†™ï¼ŒIDLE ä¼šæç¤ºæŠ¥é”™ï¼Œå› ä¸º name å§”æ‰˜ç»™äº† mutableStateOfï¼Œå¦‚æœæˆ‘ä»¬è¦è·å– name çš„å€¼ï¼Œé‚£å§”æ‰˜å¯¹è±¡éœ€è¦è°ƒç”¨ getValue() å’Œ setValue() ä¸¤ä¸ªå‡½æ•°ï¼Œè¿™ä¸¤ä¸ªå‡½æ•°éœ€è¦è‡ªå·±å®ç°ã€‚ ä½†å®é™…ä¸Šå¹¶ä¸éœ€è¦æˆ‘ä»¬å®ç°ï¼Œä½ é€šè¿‡æç¤ºä¹Ÿå¯ä»¥çœ‹å‡ºæ¥ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å¯¼å…¥ï¼Œå› ä¸º Compose å†…éƒ¨å·²ç»å¸®æˆ‘ä»¬å®ç°å¥½äº†è¿™ä¸ªæ–¹æ³•ã€‚ 12import androidx.compose.runtime.getValueimport androidx.compose.runtime.setValue è‡ªæ­¤ï¼Œå…³äº Compose çš„çŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°æœºåˆ¶çš„åŸç†ç®—æ˜¯è®²æ˜ç™½äº†å§â€¦","link":"/2024/07/05/Compose%20--%20%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85%20&%20%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%20--%20%E8%A7%A3%E6%9E%90%20mutableStateOf%20%E6%BA%90%E7%A0%81/"},{"title":"æœ‰çŠ¶æ€ã€æ— çŠ¶æ€ã€çŠ¶æ€æå‡","text":"Jekpack Compose â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ ç³»åˆ—ï¼š &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - MutableState/mutableStateOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - remember å’Œé‡ç»„ä½œç”¨åŸŸ ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - æœ‰çŠ¶æ€ã€æ— çŠ¶æ€ã€çŠ¶æ€æå‡ï¼Ÿã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - mutableStateListOf ã€‘ &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ã€ èŠèŠ Jetpack Compose çš„ â€œçŠ¶æ€è®¢é˜…&amp;è‡ªåŠ¨åˆ·æ–°â€ - - ä½ çœŸçš„äº†è§£é‡ç»„å—ï¼Ÿã€‘ å…ˆæ¥çœ‹ä¸¤æ®µ Compose çš„å®˜æ–¹æè¿°ï¼š åˆ©ç”¨ Composeï¼Œæ‚¨å¯ä»¥æ„å»ºä¸ä¸ç‰¹å®š activity æˆ– fragment ç›¸å…³è”çš„å°å‹ æ— çŠ¶æ€ç»„ä»¶ã€‚è¿™è®©æ‚¨å¯ä»¥è½»æ¾é‡ç”¨å’Œæµ‹è¯•è¿™äº›ç»„ä»¶ï¼šâ€œæˆ‘ä»¬ç»™è‡ªå·±è®¾å®šçš„ç›®æ ‡æ˜¯ï¼Œäº¤ä»˜ä¸€ç»„æ–°çš„æ— çŠ¶æ€ç•Œé¢ç»„ä»¶ï¼Œç¡®ä¿å®ƒä»¬æ˜“äºä½¿ç”¨å’Œç»´æŠ¤ï¼Œä¸”å¯ç›´è§‚å®ç°/æ‰©å±•/è‡ªå®šä¹‰ã€‚å°±è¿™ä¸€ç‚¹è€Œè¨€ï¼ŒCompose ç¡®å®ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ªå¯é çš„ç­”æ¡ˆã€‚â€(Twitter) ä½¿ç”¨ remember å­˜å‚¨å¯¹è±¡çš„å¯ç»„åˆé¡¹åŒ…å« å†…éƒ¨çŠ¶æ€ï¼Œè¿™ä¼šä½¿è¯¥å¯ç»„åˆé¡¹ æœ‰çŠ¶æ€ã€‚åœ¨è°ƒç”¨æ–¹ä¸éœ€è¦æ§åˆ¶çŠ¶æ€ï¼Œå¹¶ä¸”ä¸å¿…è‡ªè¡Œç®¡ç†çŠ¶æ€ä¾¿å¯ä½¿ç”¨çŠ¶æ€çš„æƒ…å†µä¸‹ï¼Œâ€œæœ‰çŠ¶æ€â€ä¼šéå¸¸æœ‰ç”¨ã€‚ä½†æ˜¯ï¼Œå…·æœ‰å†…éƒ¨çŠ¶æ€çš„å¯ç»„åˆé¡¹å¾€å¾€ä¸æ˜“é‡å¤ä½¿ç”¨ï¼Œä¹Ÿæ›´éš¾æµ‹è¯•ã€‚ æ‰€ä»¥æˆ‘ä»¬å¯ä»¥æŠ›å‡ºä¸‰ä¸ªé—®é¢˜ï¼š ä»€ä¹ˆæ˜¯æ— çŠ¶æ€ï¼Ÿ ä»€ä¹ˆæ˜¯ä¼˜çŠ¶æ€ï¼Ÿ ä»€ä¹ˆåˆæ˜¯å†…éƒ¨çŠ¶æ€ï¼Ÿ å¸¦ç€è¿™ä¸‰ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¼€å§‹æ¢è®¨ Compose ä¸­çš„çŠ¶æ€ã€‚ æ— çŠ¶æ€çŠ¶æ€æ˜¯ä»€ä¹ˆï¼Ÿåœ¨ä¼ ç»Ÿ Android ä¸­ï¼Œæ¯”å¦‚ TextViewï¼Œå®ƒçš„çŠ¶æ€å°±æ˜¯å†…éƒ¨çš„å±æ€§ï¼Œæ¯”å¦‚æˆ‘ä»¬å¯ä»¥é€šè¿‡ getText() è·å– TextView çš„æ–‡å­—ï¼ŒsetText() è®¾ç½® TextView çš„æ–‡å­—ã€‚ é‚£ä¹ˆçœ‹ä¸‹é¢çš„ä»£ç ç¤ºä¾‹ï¼š 12345678910class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val name = &quot;Hi, Compose&quot; Text(name) } }} é‚£ä¹ˆ Text() ç»„ä»¶åœ¨è¿™é‡Œèƒ½åƒ TextView() ä¸€æ ·æ—¢èƒ½ getText() ä¹Ÿèƒ½ setText() å—ï¼Ÿå¾ˆæ˜æ˜¾ä¸èƒ½ï¼ŒText(name) åªæ˜¯ç”¨äº† nameï¼Œå¹¶æ²¡æœ‰ä¿å­˜ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸€ä¸ª æ— çŠ¶æ€ç»„ä»¶ï¼ æœ‰çŠ¶æ€ç°åœ¨æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ª Compose å‡½æ•°ï¼ˆç»„åˆé¡¹ï¼‰ï¼š 12345@Composablefun HiCompose() { val name = &quot;Hi, Compose&quot; Text(name)} Text() æœ‰çŠ¶æ€å—ï¼Ÿâ€“ æ²¡æœ‰ï¼Œé‚£ HiCompose() å‘¢ï¼Ÿâ€“ æœ‰ï¼å®ƒçš„å†…éƒ¨æœ‰ä¸€ä¸ªå®ƒè‡ªå·±çš„å˜é‡ï¼šHi, Composeï¼Œå‡†ç¡®çš„æ¥è¯´ï¼Œå®ƒæ˜¯æœ‰ å†…éƒ¨çŠ¶æ€ çš„ã€‚ æ‰€ä»¥ï¼ŒCompose ç»„ä»¶æ˜¯å¯ä»¥æœ‰çŠ¶æ€ï¼Œä¹Ÿå¯ä»¥æ— çŠ¶æ€ï¼Œè€Œæ‰€è°“çš„çŠ¶æ€æ˜¯æŒ‡ï¼šå†…éƒ¨çŠ¶æ€ï¼ çŠ¶æ€æå‡æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼Œæ—¢ç„¶ HiCompose() å‡½æ•°æ˜¯æœ‰å†…éƒ¨çŠ¶æ€çš„ï¼Œé‚£æˆ‘å¦‚æœæƒ³ä»å¤–éƒ¨è·å–å®ƒçš„å†…éƒ¨çŠ¶æ€ï¼Œè¯¥å¦‚ä½•åšï¼Ÿæ¯”å¦‚ï¼š 123456789101112131415class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { HiCompose().name ??? // è¿™é‡Œå¦‚ä½•è·å–åˆ° HiCompose å†…éƒ¨çš„ name? } }}@Composablefun HiCompose() { val name = &quot;Hi, Compose&quot; Text(name)} è¿™å°±ç›¸å½“äºä½ è¦ä»å¤–éƒ¨è·å–ä¸€ä¸ªå‡½æ•°å†…éƒ¨çš„å˜é‡ï¼Œæ˜¯è·å–ä¸åˆ°çš„ï¼Œé‚£å¦‚ä½•åšå‘¢ï¼Ÿ 123456789101112131415class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { val name = &quot;Hi, Compose&quot; HiCompose(name) } }}@Composablefun HiCompose(name: String) { Text(name)} ä½ å¯ä»¥å¾ˆæ¸…æ¥šçš„å‘ç°ï¼Œæˆ‘ä»¬æŠŠ HiCompose() å†…éƒ¨çŠ¶æ€ç»™æåˆ°å‚æ•°é‡Œé¢ï¼Œç„¶åå¤–éƒ¨å°±å¯ä»¥ä¼ å…¥çŠ¶æ€ï¼Œä¸¤è€…å°±è”ç³»èµ·æ¥äº†ã€‚ åœ¨ Compose ä¸­è¿™ç§åšæ³•å°±å«åšï¼šçŠ¶æ€æç¤ºï¼ˆState Hoistingï¼‰ã€‚ æ­¤æ—¶ HiCompose è¿˜æœ‰çŠ¶æ€å—ï¼Ÿ- - æ— çŠ¶æ€ï¼å› ä¸ºå®ƒå·²ç»æ²¡æœ‰å†…éƒ¨çŠ¶æ€äº†ï¼ŒçŠ¶æ€ä¸Šæåˆ°å¤–é¢å»äº†ã€‚ è¾“å…¥æ¡†ï¼šTextFieldCompose æœ‰ä¸€ä¸ªå…¸å‹çš„çŠ¶æ€æå‡çš„ç»„ä»¶ç¤ºä¾‹ï¼šTextFieldï¼Œå®ƒæ˜¯ä¸€ä¸ªæ–‡æœ¬è¾“å…¥æ¡†ï¼Œç±»ä¼¼äº EditTextã€‚ 123456789class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { TextField(value = , onValueChange = ) } }} å…¶ä¸­ value å°±æ˜¯ä» TextField å†…éƒ¨æå‡ä¸Šæ¥çš„ï¼Œæ¥ç»™å®ƒä¼ ä¸ªå€¼ï¼š 12345678910class MainActivity : ComponentActivity() { override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var name = &quot;&quot; TextField(name, onValueChange = ) } }} onValueChange æ˜¯ä¸€ä¸ªå‡½æ•°ç±»å‹çš„å‚æ•°ï¼Œå¯ä»¥å†™å‡º Lambda è¡¨è¾¾å¼ã€‚ 12345678910111213class MainActivity : ComponentActivity() { @OptIn(ExperimentalMaterial3Api::class) override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var name = &quot;&quot; TextField(name, { }) } }} æ­¤æ—¶ä»€ä¹ˆä¹Ÿæ²¡å¡«ï¼Œè¿è¡Œçœ‹ä¸‹æ•ˆæœï¼š é”®ç›˜è¾“å…¥äº†ï¼Œä½†æ˜¯è¾“å…¥æ¡†æ²¡æœ‰ä»»ä½•å†…å®¹ï¼Œé—®é¢˜è‚¯å®šå‡ºåœ¨ onValueChangeï¼Œå› ä¸ºæˆ‘ä»¬ä»€ä¹ˆä¹Ÿæ²¡å¡«ï¼Œé‚£å¡«ä»€ä¹ˆï¼Ÿ 12345678910111213class MainActivity : ComponentActivity() { @OptIn(ExperimentalMaterial3Api::class) override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var name = &quot;&quot; TextField(name, { newValue -&gt; name = newValue }) } }} è¿™å°±è¿™ä¹ˆç®€å•ï¼ŒnewValue å°±æ˜¯è¾“å…¥çš„å†…å®¹ï¼ŒæŠŠ newValue èµ‹å€¼ç»™ nameï¼Œname æ‰æ˜¯è¾“å…¥æ¡†æ˜¾ç¤ºçš„å†…å®¹å®é™…å€¼ã€‚ è¿è¡Œçœ‹ä¸‹æ•ˆæœï¼š ï¼Ÿï¼Ÿï¼Ÿæ€ä¹ˆè¿˜ä¸è¡Œï¼Ÿå¦‚æœä½ çœ‹äº†ä¹‹å‰çš„æ–‡ç« ï¼Œåº”è¯¥èƒ½æ‰¾åˆ°é—®é¢˜ç‚¹åœ¨å“ªï¼ ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://i-blog.csdnimg.cn/blog_migrate/d4bcd805bdb40c9231a7442e1c80d288.png =500x) æ‡‚çš„éƒ½æ‡‚ï¼Œæˆ‘ä»¬ä¿®æ”¹ä¸‹ä»£ç ï¼š 12345678910111213class MainActivity : ComponentActivity() { @OptIn(ExperimentalMaterial3Api::class) override fun onCreate(savedInstanceState: Bundle?) { super.onCreate(savedInstanceState) setContent { var name by remember { mutableStateOf(&quot;&quot;) } TextField(name, { newValue -&gt; name = newValue }) } }} è¿è¡Œï¼š","link":"/2024/07/13/Compose%20--%20%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85%20&%20%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%20--%20%E6%9C%89%E7%8A%B6%E6%80%81%E3%80%81%E6%97%A0%E7%8A%B6%E6%80%81%E3%80%81%E7%8A%B6%E6%80%81%E6%8F%90%E5%8D%87/"}],"tags":[{"name":"Compose","slug":"Compose","link":"/tags/Compose/"},{"name":"çŠ¶æ€è®¢é˜… &amp; è‡ªåŠ¨æ›´æ–°","slug":"çŠ¶æ€è®¢é˜…-è‡ªåŠ¨æ›´æ–°","link":"/tags/%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85-%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/"},{"name":"mutableStateOf","slug":"mutableStateOf","link":"/tags/mutableStateOf/"},{"name":"mutableStateListOf","slug":"mutableStateListOf","link":"/tags/mutableStateListOf/"},{"name":"remember","slug":"remember","link":"/tags/remember/"},{"name":"é‡ç»„ä½œç”¨åŸŸ","slug":"é‡ç»„ä½œç”¨åŸŸ","link":"/tags/%E9%87%8D%E7%BB%84%E4%BD%9C%E7%94%A8%E5%9F%9F/"},{"name":"Compose åŠ¨ç”»","slug":"Compose-åŠ¨ç”»","link":"/tags/Compose-%E5%8A%A8%E7%94%BB/"},{"name":"animate*AsState()","slug":"animate-AsState","link":"/tags/animate-AsState/"},{"name":"Animatable()","slug":"Animatable","link":"/tags/Animatable/"},{"name":"é‡ç»„","slug":"é‡ç»„","link":"/tags/%E9%87%8D%E7%BB%84/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","link":"/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"SQLite","slug":"SQLite","link":"/tags/SQLite/"},{"name":"Compose çŠ¶æ€","slug":"Compose-çŠ¶æ€","link":"/tags/Compose-%E7%8A%B6%E6%80%81/"}],"categories":[{"name":"Compose","slug":"Compose","link":"/categories/Compose/"},{"name":"çŠ¶æ€è®¢é˜… &amp; è‡ªåŠ¨æ›´æ–°","slug":"Compose/çŠ¶æ€è®¢é˜…-è‡ªåŠ¨æ›´æ–°","link":"/categories/Compose/%E7%8A%B6%E6%80%81%E8%AE%A2%E9%98%85-%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0/"},{"name":"åŠ¨ç”»","slug":"Compose/åŠ¨ç”»","link":"/categories/Compose/%E5%8A%A8%E7%94%BB/"},{"name":"æ•°æ®åº“","slug":"æ•°æ®åº“","link":"/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/"},{"name":"SQLite","slug":"æ•°æ®åº“/SQLite","link":"/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/SQLite/"}],"pages":[]}