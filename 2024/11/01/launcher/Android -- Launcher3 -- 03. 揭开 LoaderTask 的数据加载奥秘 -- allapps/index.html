<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- AllApps - wikiHow</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="wikiHow"><meta name="msapplication-TileImage" content="/img/wiki.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="wikiHow"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="xxx"><meta property="og:type" content="blog"><meta property="og:title" content="æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- AllApps"><meta property="og:url" content="http://example.com/2024/11/01/launcher/Android%20--%20Launcher3%20--%2003.%20%E6%8F%AD%E5%BC%80%20LoaderTask%20%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%A5%A5%E7%A7%98%20--%20allapps/"><meta property="og:site_name" content="wikiHow"><meta property="og:description" content="xxx"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://example.com/gallery/covers/android/launcher-2.jpg"><meta property="article:published_time" content="2024-10-31T16:00:00.000Z"><meta property="article:modified_time" content="2025-07-20T08:04:23.523Z"><meta property="article:author" content="Marco"><meta property="article:tag" content="Launcher3"><meta property="article:tag" content="Android 14.0"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/gallery/covers/android/launcher-2.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2024/11/01/launcher/Android%20--%20Launcher3%20--%2003.%20%E6%8F%AD%E5%BC%80%20LoaderTask%20%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%A5%A5%E7%A7%98%20--%20allapps/"},"headline":"æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- AllApps","image":["http://example.com/gallery/covers/android/launcher-2.jpg"],"datePublished":"2024-10-31T16:00:00.000Z","dateModified":"2025-07-20T08:04:23.523Z","author":{"@type":"Person","name":"Marco"},"publisher":{"@type":"Organization","name":"wikiHow","logo":{"@type":"ImageObject","url":"http://example.com/img/wikihow.svg"}},"description":"xxx"}</script><link rel="canonical" href="http://example.com/2024/11/01/launcher/Android%20--%20Launcher3%20--%2003.%20%E6%8F%AD%E5%BC%80%20LoaderTask%20%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%A5%A5%E7%A7%98%20--%20allapps/"><link rel="icon" href="/img/wiki.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link data-pjax rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.7.0/styles/atom-one-dark.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link data-pjax rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const id = '#' + CSS.escape(location.hash.substring(1));
          const $tabMenu = document.querySelector(`.tabs a[href="${id}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(id);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/wikihow.svg" alt="wikiHow" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/pepsimaxin"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/gallery/covers/android/launcher-2.jpg" alt="æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- AllApps"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2024-10-31T16:00:00.000Z" title="2024/11/1 00:00:00">2024-11-01</time>å‘è¡¨</span><span class="level-item"><time dateTime="2025-07-20T08:04:23.523Z" title="2025/7/20 16:04:23">2025-07-20</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/Launcher3/">Launcher3</a><span>Â /Â </span><a class="link-muted" href="/categories/Launcher3/Android-14-0/">Android 14.0</a></span></div></div><h1 class="title is-3 is-size-4-mobile">æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- AllApps</h1><div class="content"><hr>
<article class="message is-success"><div class="message-header">
<p>Step 2: AllApps</p>
</div><div class="message-body">
<p>Workspace çš„å·¥ä½œä¸»è¦åˆ†ä¸ºï¼š<font color="#085DFF">ã€ŒåŠ è½½å…¨éƒ¨åº”ç”¨ã€</font>å’Œ<font color="#FF8C00">ã€Œç»‘å®šå…¨éƒ¨åº”ç”¨ã€</font>ï¼Œæˆ‘ä»¬ä¸€ä¸ªä¸ªæ¥åˆ†æã€‚</p>
</div></article>

<h1 id="åŠ è½½-AllApps-æµç¨‹è§£æ"><a href="#åŠ è½½-AllApps-æµç¨‹è§£æ" class="headerlink" title="åŠ è½½ AllApps æµç¨‹è§£æ"></a>åŠ è½½ AllApps æµç¨‹è§£æ</h1><p>æ ¸å¿ƒæ–¹æ³•ï¼š<font color="#085DFF">loadAllApps()</font> è´Ÿè´£åŠ è½½å…¨éƒ¨åº”ç”¨ï¼š</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/model/LoaderTask.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoaderTask</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åŠ è½½æ‰€æœ‰ç”¨æˆ·çš„åº”ç”¨ç¨‹åºä¿¡æ¯ï¼ŒåŒ…æ‹¬å›¾æ ‡å’Œå…¶ä»–å…ƒæ•°æ®ï¼Œä¸»è¦ç”¨äº Launcher åŠ è½½æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * è¿”å›å€¼ï¼šList&lt;LauncherActivityInfo&gt;ï¼ŒåŒ…å«æ‰€æœ‰ç”¨æˆ·çš„åº”ç”¨åˆ—è¡¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;LauncherActivityInfo&gt; <span class="title function_">loadAllApps</span><span class="params">()</span> &#123;</span><br><span class="line">        testLogD(WORK_TAB_MISSING, <span class="string">&quot;loadingAllApps&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä» mUserCache è·å–æ‰€æœ‰ç”¨æˆ·é…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªç”¨æˆ·å¯èƒ½æœ‰ä¸åŒçš„åº”ç”¨é›†åˆ</span></span><br><span class="line">        <span class="keyword">final</span> List&lt;UserHandle&gt; profiles = mUserCache.getUserProfiles();</span><br><span class="line">        <span class="comment">// åˆå§‹åŒ–ä¸€ä¸ªç©ºçš„åº”ç”¨åˆ—è¡¨ï¼Œç”¨äºå­˜å‚¨æœ€ç»ˆçš„ç»“æœ</span></span><br><span class="line">        List&lt;LauncherActivityInfo&gt; allActivityList = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// æ¸…ç©ºå½“å‰æ‰€æœ‰çš„åº”ç”¨åˆ—è¡¨</span></span><br><span class="line">        mBgAllAppsList.clear();</span><br><span class="line"></span><br><span class="line">        List&lt;IconRequestInfo&lt;AppInfo&gt;&gt; iconRequestInfos = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// éå†æ¯ä¸ªç”¨æˆ·</span></span><br><span class="line">        <span class="keyword">for</span> (UserHandle user : profiles) &#123;</span><br><span class="line">            <span class="comment">// æŸ¥è¯¢åº”ç”¨åˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">final</span> List&lt;LauncherActivityInfo&gt; apps = mLauncherApps.getActivityList(<span class="literal">null</span>, user);</span><br><span class="line">            <span class="comment">// å¦‚æœæŸä¸ªç”¨æˆ·æ²¡æœ‰åº”ç”¨åˆ™è¿”å›ç©ºåˆ—è¡¨</span></span><br><span class="line">            <span class="keyword">if</span> (apps == <span class="literal">null</span> || apps.isEmpty()) &#123;</span><br><span class="line">                <span class="keyword">return</span> allActivityList;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// å¤„ç†é™é»˜æ¨¡å¼</span></span><br><span class="line">            <span class="type">boolean</span> <span class="variable">quietMode</span> <span class="operator">=</span> mUserManagerState.isUserQuiet(user);</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ›å»ºåº”ç”¨ä¿¡æ¯</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; apps.size(); i++) &#123;</span><br><span class="line">                <span class="comment">// å¯¹æ¯ä¸ªåº”ç”¨åˆ›å»º AppInfo å®ä¾‹</span></span><br><span class="line">                <span class="type">LauncherActivityInfo</span> <span class="variable">app</span> <span class="operator">=</span> apps.get(i);</span><br><span class="line">                <span class="type">AppInfo</span> <span class="variable">appInfo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">AppInfo</span>(app, user, quietMode);</span><br><span class="line"></span><br><span class="line">                <span class="comment">// åˆ›å»º IconRequestInfo ç”¨äºå›¾æ ‡è¯·æ±‚</span></span><br><span class="line">                iconRequestInfos.add(<span class="keyword">new</span> <span class="title class_">IconRequestInfo</span>&lt;&gt;(</span><br><span class="line">                        appInfo, app, <span class="comment">/* useLowResIcon= */</span> <span class="literal">false</span>));</span><br><span class="line">                mBgAllAppsList.add(</span><br><span class="line">                        appInfo, app, <span class="literal">false</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            allActivityList.addAll(apps);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (FeatureFlags.PROMISE_APPS_IN_ALL_APPS.get()) &#123;</span><br><span class="line">            <span class="comment">// get all active sessions and add them to the all apps list</span></span><br><span class="line">            <span class="keyword">for</span> (PackageInstaller.SessionInfo info :</span><br><span class="line">                    mSessionHelper.getAllVerifiedSessions()) &#123;</span><br><span class="line">                <span class="type">AppInfo</span> <span class="variable">promiseAppInfo</span> <span class="operator">=</span> mBgAllAppsList.addPromiseApp(</span><br><span class="line">                        mApp.getContext(),</span><br><span class="line">                        PackageInstallInfo.fromInstallingState(info),</span><br><span class="line">                        <span class="literal">false</span>);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (promiseAppInfo != <span class="literal">null</span>) &#123;</span><br><span class="line">                    iconRequestInfos.add(<span class="keyword">new</span> <span class="title class_">IconRequestInfo</span>&lt;&gt;(</span><br><span class="line">                            promiseAppInfo,</span><br><span class="line">                            <span class="comment">/* launcherActivityInfo= */</span> <span class="literal">null</span>,</span><br><span class="line">                            promiseAppInfo.usingLowResIcon()));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Trace.beginSection(<span class="string">&quot;LoadAllAppsIconsInBulk&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            mIconCache.getTitlesAndIconsInBulk(iconRequestInfos);</span><br><span class="line">            iconRequestInfos.forEach(iconRequestInfo -&gt;</span><br><span class="line">                    mBgAllAppsList.updateSectionName(iconRequestInfo.itemInfo));</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            Trace.endSection();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        mBgAllAppsList.setFlags(FLAG_QUIET_MODE_ENABLED,</span><br><span class="line">                mUserManagerState.isAnyProfileQuietModeEnabled());</span><br><span class="line">        mBgAllAppsList.setFlags(FLAG_HAS_SHORTCUT_PERMISSION,</span><br><span class="line">                hasShortcutsPermission(mApp.getContext()));</span><br><span class="line">        mBgAllAppsList.setFlags(FLAG_QUIET_MODE_CHANGE_PERMISSION,</span><br><span class="line">                mApp.getContext().checkSelfPermission(<span class="string">&quot;android.permission.MODIFY_QUIET_MODE&quot;</span>)</span><br><span class="line">                        == PackageManager.PERMISSION_GRANTED);</span><br><span class="line"></span><br><span class="line">        mBgAllAppsList.getAndResetChangeFlag();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è¿”å› allActivityListï¼ŒåŒ…å«æ‰€æœ‰åŠ è½½çš„ LauncherActivityInfo å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">return</span> allActivityList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="ç»‘å®š-AllApps-æµç¨‹è§£æ"><a href="#ç»‘å®š-AllApps-æµç¨‹è§£æ" class="headerlink" title="ç»‘å®š AllApps æµç¨‹è§£æ"></a>ç»‘å®š AllApps æµç¨‹è§£æ</h1><p>ç»‘å®š AllApps æ˜¯é€šè¿‡ <code>LauncherBinder</code> çš„ <font color="#FF8C00">bindAllApps()</font> å‡½æ•°ï¼Œåœ¨å…¶çˆ¶ç±» <code>BaseLauncherBinder</code> ä¸­å®šä¹‰ã€‚</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/model/BaseLauncherBinder.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">class</span> <span class="title class_">BaseLauncherBinder</span> &#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Binds the all apps results from LoaderTask to the callbacks UX.</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * è´Ÿè´£å°†åº”ç”¨åˆ—è¡¨æ•°æ®ç»‘å®šåˆ° UI ä¸­</span></span><br><span class="line"><span class="comment">     * </span></span><br><span class="line"><span class="comment">     * å®ƒä»åå°çš„åº”ç”¨åˆ—è¡¨ä¸­è·å–æ•°æ®ï¼Œæ„å»ºä¸€ä¸ªæ˜ å°„å…³ç³»ï¼Œç„¶åé€šè¿‡å›è°ƒå°†åº”ç”¨ä¿¡æ¯ä¼ é€’ç»™å‰å°çš„ UI çº¿ç¨‹æ¥æ›´æ–°æ˜¾ç¤º</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">bindAllApps</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// ä»åå°åº”ç”¨åˆ—è¡¨ï¼šmBgAllAppsList ä¸­æµ…æ‹·è´å‡ºæ‰€æœ‰ AppInfo å®ä¾‹ï¼Œapps æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ŒåŒ…å«äº†æ‰€æœ‰çš„åº”ç”¨ä¿¡æ¯</span></span><br><span class="line">        AppInfo[] apps = mBgAllAppsList.copyData();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">// è·å–åº”ç”¨åˆ—è¡¨çš„æ ‡å¿—ä½</span></span><br><span class="line">        <span class="type">int</span> <span class="variable">flags</span> <span class="operator">=</span> mBgAllAppsList.getFlags();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä½¿ç”¨ Java Stream APIï¼Œéå† apps æ•°ç»„ï¼Œåˆ›å»ºä¸€ä¸ª Map æ˜ å°„</span></span><br><span class="line">        Map&lt;PackageUserKey, Integer&gt; packageUserKeytoUidMap = Arrays.stream(apps).collect(</span><br><span class="line">                Collectors.toMap(</span><br><span class="line">                        appInfo -&gt; <span class="keyword">new</span> <span class="title class_">PackageUserKey</span>(appInfo.componentName.getPackageName(),</span><br><span class="line">                                appInfo.user), appInfo -&gt; appInfo.uid, (a, b) -&gt; a));</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æ‰§è¡Œå›è°ƒä»»åŠ¡</span></span><br><span class="line">        executeCallbacksTask(c -&gt; c.bindAllApplications(apps, flags, packageUserKeytoUidMap),</span><br><span class="line">                mUiExecutor);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Launcher-åŠ è½½å…¨éƒ¨åº”ç”¨"><a href="#Launcher-åŠ è½½å…¨éƒ¨åº”ç”¨" class="headerlink" title="Launcher åŠ è½½å…¨éƒ¨åº”ç”¨"></a>Launcher åŠ è½½å…¨éƒ¨åº”ç”¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/Launcher.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Launcher</span> <span class="keyword">extends</span> <span class="title class_">StatefulActivity</span>&lt;LauncherState&gt;</span><br><span class="line">        <span class="keyword">implements</span> <span class="title class_">LauncherExterns</span>, Callbacks, InvariantDeviceProfile.OnIDPChangeListener,</span><br><span class="line">        PluginListener&lt;LauncherOverlayPlugin&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">bindAllApplications</span><span class="params">(AppInfo[] apps, <span class="type">int</span> flags,</span></span><br><span class="line"><span class="params">                                    Map&lt;PackageUserKey, Integer&gt; packageUserKeytoUidMap)</span> &#123;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥å½“å‰æ–¹æ³•æ˜¯å¦åœ¨ UI çº¿ç¨‹ä¸­æ‰§è¡Œ</span></span><br><span class="line">        Preconditions.assertUIThread();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ä» mAppsViewï¼šé€šå¸¸ä»£è¡¨åº”ç”¨æŠ½å±‰è§†å›¾ä¸­è·å– AllAppsStore å¯¹è±¡</span></span><br><span class="line">        <span class="type">AllAppsStore</span> <span class="variable">appsStore</span> <span class="operator">=</span> mAppsView.getAppsStore();</span><br><span class="line">        <span class="comment">// å°†åº”ç”¨æ•°æ®æ›´æ–°åˆ°å­˜å‚¨åº“ä¸­</span></span><br><span class="line">        appsStore.setApps(apps, flags, packageUserKeytoUidMap);</span><br><span class="line">        <span class="comment">// å…³é—­å¯èƒ½å·²å¤±æ•ˆçš„å¼¹å‡ºçª—å£</span></span><br><span class="line">        PopupContainerWithArrow.dismissInvalidPopup(<span class="built_in">this</span>);</span><br><span class="line">        <span class="keyword">if</span> (Utilities.ATLEAST_S) &#123;</span><br><span class="line">            Trace.endAsyncSection(DISPLAY_ALL_APPS_TRACE_METHOD_NAME,</span><br><span class="line">                    DISPLAY_ALL_APPS_TRACE_COOKIE);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="appsStore-setApps"><a href="#appsStore-setApps" class="headerlink" title="appsStore.setApps()"></a>appsStore.setApps()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/allapps/AllAppsStore.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AllAppsStore</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * Sets the current set of apps and sets mapping for &#123;<span class="doctag">@link</span> PackageUserKey&#125; to Uid for</span></span><br><span class="line"><span class="comment">     * the current set of apps.</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setApps</span><span class="params">(AppInfo[] apps, <span class="type">int</span> flags, Map&lt;PackageUserKey, Integer&gt; map)</span> &#123;</span><br><span class="line">        mApps = apps;</span><br><span class="line">        mModelFlags = flags;</span><br><span class="line">        notifyUpdate();</span><br><span class="line">        mPackageUserKeytoUidMap = map;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="notifyUpdate"><a href="#notifyUpdate" class="headerlink" title="notifyUpdate()"></a>notifyUpdate()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/allapps/AllAppsStore.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AllAppsStore</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">notifyUpdate</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (mDeferUpdatesFlags != <span class="number">0</span>) &#123;</span><br><span class="line">            mUpdatePending = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (OnUpdateListener listener : mUpdateListeners) &#123;</span><br><span class="line">            <span class="keyword">if</span> (TestProtocol.sDebugTracing) &#123;</span><br><span class="line">                Log.d(WORK_TAB_MISSING, <span class="string">&quot;AllAppsStore#notifyUpdate listener: &quot;</span> + listener);</span><br><span class="line">            &#125;</span><br><span class="line">            listener.onAppsUpdated();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="onAppsUpdated"><a href="#onAppsUpdated" class="headerlink" title="onAppsUpdated()"></a>onAppsUpdated()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/allapps/ActivityAllAppsContainerView.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivityAllAppsContainerView</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Context</span> &amp; ActivityContext&gt;</span><br><span class="line">        <span class="keyword">extends</span> <span class="title class_">SpringRelativeLayout</span> <span class="keyword">implements</span> <span class="title class_">DragSource</span>, Insettable,</span><br><span class="line">        OnDeviceProfileChangeListener, PersonalWorkSlidingTabStrip.OnActivePageChangedListener,</span><br><span class="line">        ScrimView.ScrimDrawingController &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">onAppsUpdated</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥æ˜¯å¦æœ‰ Work ç±»å‹çš„åº”ç”¨</span></span><br><span class="line">        mHasWorkApps = Stream.of(mAllAppsStore.getApps()).anyMatch(mWorkManager.getMatcher());</span><br><span class="line">        <span class="keyword">if</span> (TestProtocol.sDebugTracing) &#123;</span><br><span class="line">            Log.d(WORK_TAB_MISSING, <span class="string">&quot;ActivityAllAppsContainerView#onAppsUpdated hasWorkApps: &quot;</span> +</span><br><span class="line">                    mHasWorkApps + <span class="string">&quot; allApps: &quot;</span> + mAllAppsStore.getApps().length);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ£€æŸ¥å½“å‰æ˜¯å¦å¤„äº Search æ¨¡å¼</span></span><br><span class="line">        <span class="keyword">if</span> (!isSearching()) &#123;</span><br><span class="line">            rebindAdapters();    <span class="comment">// é‡æ–°ç»‘å®šé€‚é…å™¨ï¼Œç”¨äºåˆ·æ–° UIï¼Œä½¿åº”ç”¨åˆ—è¡¨æ›´æ–°</span></span><br><span class="line">            <span class="keyword">if</span> (mHasWorkApps) &#123;</span><br><span class="line">                mWorkManager.reset();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// è®°å½•åº”ç”¨æ•°é‡çš„ç»Ÿè®¡æ•°æ®</span></span><br><span class="line">        mActivityContext.getStatsLogManager().logger()</span><br><span class="line">                .withCardinality(mAllAppsStore.getApps().length)</span><br><span class="line">                .log(LAUNCHER_ALLAPPS_COUNT);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="rebindAdapters"><a href="#rebindAdapters" class="headerlink" title="rebindAdapters()"></a>rebindAdapters()</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">ğŸ“„ æºç è·¯å¾„ï¼š<span class="keyword">package</span>/app/Launcher3/src/com/android/launcher3/allapps/ActivityAllAppsContainerView.java</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ActivityAllAppsContainerView</span>&lt;T <span class="keyword">extends</span> <span class="title class_">Context</span> &amp; ActivityContext&gt;</span><br><span class="line">        <span class="keyword">extends</span> <span class="title class_">SpringRelativeLayout</span> <span class="keyword">implements</span> <span class="title class_">DragSource</span>, Insettable,</span><br><span class="line">        OnDeviceProfileChangeListener, PersonalWorkSlidingTabStrip.OnActivePageChangedListener,</span><br><span class="line">        ScrimView.ScrimDrawingController &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">rebindAdapters</span><span class="params">()</span> &#123;</span><br><span class="line">        rebindAdapters(<span class="literal">false</span> <span class="comment">/* force */</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="keyword">void</span> <span class="title function_">rebindAdapters</span><span class="params">(<span class="type">boolean</span> force)</span> &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæœç´¢åŠ¨ç”»æ­£åœ¨è¿›è¡Œä¸­ï¼Œåˆ™è®¾ç½® mRebindAdaptersAfterSearchAnimation ä¸º trueï¼Œ</span></span><br><span class="line">        <span class="comment">// åœ¨åŠ¨ç”»ç»“æŸåé‡æ–°ç»‘å®šé€‚é…å™¨</span></span><br><span class="line">        <span class="keyword">if</span> (mSearchTransitionController.isRunning()) &#123;</span><br><span class="line">            mRebindAdaptersAfterSearchAnimation = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// æ›´æ–°æœç´¢ç»“æœçš„å¯è§æ€§ï¼Œç¡®ä¿æœç´¢ç»“æœçš„æ˜¾ç¤ºçŠ¶æ€ä¸å½“å‰å¸ƒå±€ä¸€è‡´</span></span><br><span class="line">        updateSearchResultsVisibility();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å†³å®šæ˜¯å¦æ˜¾ç¤ºæ ‡ç­¾ï¼šTabsï¼Œç”¨äºåŒºåˆ†ä¸ªäººå’Œå·¥ä½œåº”ç”¨</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">showTabs</span> <span class="operator">=</span> shouldShowTabs();</span><br><span class="line">        <span class="keyword">if</span> (showTabs == mUsingTabs &amp;&amp; !force) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœæ²¡æœ‰å¯ç”¨æœç´¢ç»“æœèƒŒæ™¯è£…é¥°ï¼Œåˆ™ä» RecyclerView ä¸­ç§»é™¤å¹¶é‡æ–°æ·»åŠ  ItemDecorationï¼Œä»¥ç¡®ä¿è§†è§‰æ•ˆæœçš„ä¸€è‡´æ€§</span></span><br><span class="line">        <span class="keyword">if</span> (!FeatureFlags.ENABLE_SEARCH_RESULT_BACKGROUND_DRAWABLES.get()) &#123;</span><br><span class="line">            RecyclerView.<span class="type">ItemDecoration</span> <span class="variable">decoration</span> <span class="operator">=</span> getMainAdapterProvider().getDecorator();</span><br><span class="line">            getSearchRecyclerView().removeItemDecoration(decoration);</span><br><span class="line">            getSearchRecyclerView().addItemDecoration(decoration);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// replaceAppsRVcontainer() needs to use both mUsingTabs value to remove the old view AND</span></span><br><span class="line">        <span class="comment">// showTabs value to create new view. Hence the mUsingTabs new value assignment MUST happen</span></span><br><span class="line">        <span class="comment">// after this call.</span></span><br><span class="line">        <span class="comment">// æ ¹æ® showTabs çš„å€¼æ›¿æ¢åº”ç”¨åˆ—è¡¨çš„ RecyclerView å®¹å™¨ï¼Œä»¥ä¾¿åˆ‡æ¢åˆ°æ–°çš„å¸ƒå±€</span></span><br><span class="line">        replaceAppsRVContainer(showTabs);</span><br><span class="line">        mUsingTabs = showTabs;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åœ¨æ›´æ–°è§†å›¾ä¹‹å‰ï¼Œå…ˆæ³¨é”€æ‰€æœ‰æ—§çš„å›¾æ ‡å®¹å™¨ï¼Œä»¥ç¡®ä¿æ–°å¸ƒå±€ä¸­çš„å›¾æ ‡èƒ½å¤Ÿæ­£ç¡®ç»‘å®š</span></span><br><span class="line">        mAllAppsStore.unregisterIconContainer(mAH.get(AdapterHolder.MAIN).mRecyclerView);</span><br><span class="line">        mAllAppsStore.unregisterIconContainer(mAH.get(AdapterHolder.WORK).mRecyclerView);</span><br><span class="line">        mAllAppsStore.unregisterIconContainer(mAH.get(AdapterHolder.SEARCH).mRecyclerView);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœå¯ç”¨äº†æ ‡ç­¾æ¨¡å¼</span></span><br><span class="line">        <span class="keyword">if</span> (mUsingTabs) &#123;</span><br><span class="line">            mAH.get(AdapterHolder.MAIN).setup(mViewPager.getChildAt(<span class="number">0</span>), mPersonalMatcher);</span><br><span class="line">            mAH.get(AdapterHolder.WORK).setup(mViewPager.getChildAt(<span class="number">1</span>), mWorkManager.getMatcher());</span><br><span class="line">            mAH.get(AdapterHolder.WORK).mRecyclerView.setId(R.id.apps_list_view_work);</span><br><span class="line">            <span class="keyword">if</span> (FeatureFlags.ENABLE_EXPANDING_PAUSE_WORK_BUTTON.get()) &#123;</span><br><span class="line">                mAH.get(AdapterHolder.WORK).mRecyclerView.addOnScrollListener(</span><br><span class="line">                        mWorkManager.newScrollListener());</span><br><span class="line">            &#125;</span><br><span class="line">            mViewPager.getPageIndicator().setActiveMarker(AdapterHolder.MAIN);</span><br><span class="line">            findViewById(R.id.tab_personal)</span><br><span class="line">                    .setOnClickListener((View view) -&gt; &#123;</span><br><span class="line">                        <span class="keyword">if</span> (mViewPager.snapToPage(AdapterHolder.MAIN)) &#123;</span><br><span class="line">                            mActivityContext.getStatsLogManager().logger()</span><br><span class="line">                                    .log(LAUNCHER_ALLAPPS_TAP_ON_PERSONAL_TAB);</span><br><span class="line">                        &#125;</span><br><span class="line">                        mActivityContext.hideKeyboard();</span><br><span class="line">                    &#125;);</span><br><span class="line">            findViewById(R.id.tab_work)</span><br><span class="line">                    .setOnClickListener((View view) -&gt; &#123;</span><br><span class="line">                        <span class="keyword">if</span> (mViewPager.snapToPage(AdapterHolder.WORK)) &#123;</span><br><span class="line">                            mActivityContext.getStatsLogManager().logger()</span><br><span class="line">                                    .log(LAUNCHER_ALLAPPS_TAP_ON_WORK_TAB);</span><br><span class="line">                        &#125;</span><br><span class="line">                        mActivityContext.hideKeyboard();</span><br><span class="line">                    &#125;);</span><br><span class="line">            setDeviceManagementResources();</span><br><span class="line">            onActivePageChanged(mViewPager.getNextPage());</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// å¦‚æœæœªå¯ç”¨æ ‡ç­¾æ¨¡å¼ï¼Œåˆ™åªè®¾ç½®ä¸»é¡µé¢ (MAIN)ï¼Œå¹¶å°† WORK çš„ RecyclerView è®¾ä¸º null</span></span><br><span class="line">            mAH.get(AdapterHolder.MAIN).setup(findViewById(R.id.apps_list_view), <span class="literal">null</span>);</span><br><span class="line">            mAH.get(AdapterHolder.WORK).mRecyclerView = <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½®åº”ç”¨æŠ½å±‰é¡¶éƒ¨çš„æ ‡é¢˜æ å†…å®¹ï¼Œä¾‹å¦‚æ·»åŠ æœç´¢æ æˆ–å…¶ä»–å·¥å…·æ å…ƒç´ </span></span><br><span class="line">        setupHeader();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é…ç½®æ»šåŠ¨æ¡ä½ç½®</span></span><br><span class="line">        <span class="keyword">if</span> (isSearchBarOnBottom()) &#123;</span><br><span class="line">            <span class="comment">// Keep the scroller above the search bar.</span></span><br><span class="line">            RelativeLayout.<span class="type">LayoutParams</span> <span class="variable">scrollerLayoutParams</span> <span class="operator">=</span></span><br><span class="line">                    (LayoutParams) mFastScroller.getLayoutParams();</span><br><span class="line">            scrollerLayoutParams.addRule(RelativeLayout.ABOVE, R.id.search_container_all_apps);</span><br><span class="line">            scrollerLayoutParams.removeRule(RelativeLayout.ALIGN_PARENT_BOTTOM);</span><br><span class="line">            scrollerLayoutParams.bottomMargin = getResources().getDimensionPixelSize(</span><br><span class="line">                    R.dimen.fastscroll_bottom_margin_floating_search);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// é‡æ–°æ³¨å†Œæ–°çš„å›¾æ ‡å®¹å™¨</span></span><br><span class="line">        mAllAppsStore.registerIconContainer(mAH.get(AdapterHolder.MAIN).mRecyclerView);</span><br><span class="line">        mAllAppsStore.registerIconContainer(mAH.get(AdapterHolder.WORK).mRecyclerView);</span><br><span class="line">        mAllAppsStore.registerIconContainer(mAH.get(AdapterHolder.SEARCH).mRecyclerView);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- AllApps</p><p><a href="http://example.com/2024/11/01/launcher/Android -- Launcher3 -- 03. æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- allapps/">http://example.com/2024/11/01/launcher/Android -- Launcher3 -- 03. æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- allapps/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>Marco</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2024-11-01</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2025-07-20</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Launcher3/">Launcher3</a><a class="link-muted mr-2" rel="tag" href="/tags/Android-14-0/">Android 14.0</a></div><!--!--></article></div><!--!--><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2024/11/23/launcher/Android%20--%20Launcher3%20--%2006.%20%E6%8F%AD%E5%BC%80%20LoaderTask%20%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%A5%A5%E7%A7%98%20--%20folder/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- Folder</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2024/10/25/launcher/Android%20--%20Launcher3%20--%2002.%20%E6%8F%AD%E5%BC%80%20LoaderTask%20%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8A%A0%E8%BD%BD%E5%A5%A5%E7%A7%98%20--%20workspace/"><span class="level-item">æ­å¼€ LoaderTask çš„æ•°æ®åŠ è½½å¥¥ç§˜ -- Workspace</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><!--!--></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">æœ€æ–°æ–‡ç« </h3><article class="media"><figure class="media-left"><a class="image" href="/2025/07/25/kotlin/Kotlin%20--%20%E5%8D%8F%E7%A8%8B%20--%2002.%20Channel_Flow/"><img src="/gallery/covers/kotlin/channel_flow.png" alt="Channel &amp; Flow"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-07-24T16:00:00.000Z">2025-07-25</time></p><p class="title"><a href="/2025/07/25/kotlin/Kotlin%20--%20%E5%8D%8F%E7%A8%8B%20--%2002.%20Channel_Flow/">Channel &amp; Flow</a></p><p class="categories"><a href="/categories/Kotlin/">Kotlin</a> / <a href="/categories/Kotlin/Channel/">Channel</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/07/20/kotlin/Kotlin%20--%20%E5%8D%8F%E7%A8%8B%20--%2001.%20%E5%8D%8F%E7%A8%8B%E5%85%A5%E9%97%A8%20copy/"><img src="/gallery/covers/kotlin/coroutines.jpg" alt="è¿™æ˜¯ä¸€ç¯‡é€šä¿—æ˜“æ‡‚çš„ã€Œåç¨‹ã€å…¥é—¨æŒ‡å—"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-07-19T16:00:00.000Z">2025-07-20</time></p><p class="title"><a href="/2025/07/20/kotlin/Kotlin%20--%20%E5%8D%8F%E7%A8%8B%20--%2001.%20%E5%8D%8F%E7%A8%8B%E5%85%A5%E9%97%A8%20copy/">è¿™æ˜¯ä¸€ç¯‡é€šä¿—æ˜“æ‡‚çš„ã€Œåç¨‹ã€å…¥é—¨æŒ‡å—</a></p><p class="categories"><a href="/categories/Kotlin/">Kotlin</a> / <a href="/categories/Kotlin/%E5%8D%8F%E7%A8%8B/">åç¨‹</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/06/26/settings/Settings%20--%20%E5%8F%8C%E6%A0%8F%E8%A7%A3%E6%9E%90/"><img src="/gallery/covers/android/settings.jpg" alt="Settingsã€Œæºç è§£æç³»åˆ—ã€-- å•/åŒæ åŸç†"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-06-25T16:00:00.000Z">2025-06-26</time></p><p class="title"><a href="/2025/06/26/settings/Settings%20--%20%E5%8F%8C%E6%A0%8F%E8%A7%A3%E6%9E%90/">Settingsã€Œæºç è§£æç³»åˆ—ã€-- å•/åŒæ åŸç†</a></p><p class="categories"><a href="/categories/Android/">Android</a> / <a href="/categories/Android/Settings/">Settings</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2025/05/20/jetpack/Jetpack%20%E4%BF%9D%E5%A7%86%E6%95%99%E7%A8%8B%20--%20ROOM/"><img src="/gallery/covers/jetpack/room.jpg" alt="Jetpackã€Œä¿å§†æ•™ç¨‹ã€-- ROOM"></a></figure><div class="media-content"><p class="date"><time dateTime="2025-05-19T16:00:00.000Z">2025-05-20</time></p><p class="title"><a href="/2025/05/20/jetpack/Jetpack%20%E4%BF%9D%E5%A7%86%E6%95%99%E7%A8%8B%20--%20ROOM/">Jetpackã€Œä¿å§†æ•™ç¨‹ã€-- ROOM</a></p><p class="categories"><a href="/categories/Kotlin/">Kotlin</a> / <a href="/categories/Kotlin/%E5%8D%8F%E7%A8%8B/">åç¨‹</a></p></div></article><article class="media"><figure class="media-left"><a class="image" href="/2024/12/05/launcher/Android%20--%20Launcher3%20--%2011.%20Folder%20%E4%B9%9D%E5%AE%AB%E6%A0%BC%E5%AE%9A%E5%88%B6/"><img src="/gallery/covers/android/launcher.png" alt="Android 14.0 Launcher -- Folder å®šåˆ¶"></a></figure><div class="media-content"><p class="date"><time dateTime="2024-12-04T16:00:00.000Z">2024-12-05</time></p><p class="title"><a href="/2024/12/05/launcher/Android%20--%20Launcher3%20--%2011.%20Folder%20%E4%B9%9D%E5%AE%AB%E6%A0%BC%E5%AE%9A%E5%88%B6/">Android 14.0 Launcher -- Folder å®šåˆ¶</a></p><p class="categories"><a href="/categories/Launcher3/">Launcher3</a> / <a href="/categories/Launcher3/Android-14-0/">Android 14.0</a></p></div></article></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#åŠ è½½-AllApps-æµç¨‹è§£æ"><span class="level-left"><span class="level-item">1</span><span class="level-item">åŠ è½½ AllApps æµç¨‹è§£æ</span></span></a></li><li><a class="level is-mobile" href="#ç»‘å®š-AllApps-æµç¨‹è§£æ"><span class="level-left"><span class="level-item">2</span><span class="level-item">ç»‘å®š AllApps æµç¨‹è§£æ</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#Launcher-åŠ è½½å…¨éƒ¨åº”ç”¨"><span class="level-left"><span class="level-item">2.1</span><span class="level-item">Launcher åŠ è½½å…¨éƒ¨åº”ç”¨</span></span></a></li><li><a class="level is-mobile" href="#appsStore-setApps"><span class="level-left"><span class="level-item">2.2</span><span class="level-item">appsStore.setApps()</span></span></a></li><li><a class="level is-mobile" href="#notifyUpdate"><span class="level-left"><span class="level-item">2.3</span><span class="level-item">notifyUpdate()</span></span></a></li><li><a class="level is-mobile" href="#onAppsUpdated"><span class="level-left"><span class="level-item">2.4</span><span class="level-item">onAppsUpdated()</span></span></a></li><li><a class="level is-mobile" href="#rebindAdapters"><span class="level-left"><span class="level-item">2.5</span><span class="level-item">rebindAdapters()</span></span></a></li></ul></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/wikihow.svg" alt="wikiHow" height="28"></a><p class="is-size-7"><span>&copy; 2025 Marco</span>Â Â Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p><p class="is-size-7">Â© Honey Badger Team</p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/pepsimaxin"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script data-pjax src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script data-pjax src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "æ­¤ç½‘ç«™ä½¿ç”¨Cookieæ¥æ”¹å–„æ‚¨çš„ä½“éªŒã€‚",
          dismiss: "çŸ¥é“äº†ï¼",
          allow: "å…è®¸ä½¿ç”¨Cookie",
          deny: "æ‹’ç»",
          link: "äº†è§£æ›´å¤š",
          policy: "Cookieæ”¿ç­–",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pjax@0.2.8/pjax.min.js"></script><script src="/js/pjax.js"></script><!--!--><!--!--><!--!--><script data-pjax src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>